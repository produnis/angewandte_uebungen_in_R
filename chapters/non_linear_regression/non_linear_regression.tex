% Author: Alfredo Sánchez Alberca (asalber@ceu.es)

\chapter{Non-linear regression}\label{cha:non-linear-regression}

\section{Solved exercises}
\begin{enumerate}[leftmargin=*]
\item The number of bacteria in a culture evolves with time according to the table below.

\begin{center}
\begin{tabular}{lrrrrrrrrr}
\hline
Time(hours) & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8  \\
Bacteria & 25 & 28 & 47 & 65 & 86 & 121 & 190 & 290 & 362\\
\hline
\end{tabular}
\end{center}

Do the following operations:
\begin{enumerate}
\item Create a data set with the variables \variable{time} and \variable{bacteria} and enter the data of the sample.

\item Plot the scatter plot. 
According to the point cloud, what type of model explains better the bacteria evolution?
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Charts > Scatter plot}.
\item In the dialog displayed insert the variable \variable{bacteria} in the field \field{Y variable}
and the variable \variable{time} in the field \field{X variable}, and click the button \button{Submit}.
\end{enumerate}
\end{indication}

\item Compute the quadratic and exponential models of bacteria on time.

\begin{indication}
To compute the quadratic model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Non-linear regression}.
\item In the dialog displayed insert the variable \variable{bacteria} in the field \field{Dependent variable} and the
variable \variable{time} in the field \field{Independent variable}.
\item In the \option{Regression models} tab check the box \option{Quadratic}.
\item Check the box \option{Save model}, enter the name \variable{quadratic.model.bacteria.on.time} and click the
button \button{Submit}.
\end{enumerate}
To compute the exponential model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Non-linear regression}.
\item In the dialog displayed insert the variable \variable{bacteria} in the field \field{Dependent variable} and the
variable \variable{time} in the field \field{Independent variable}.
\item In the \option{Regression models} tab check the box \option{Exponential}.
\item Check the box \option{Save model}, enter the name \variable{exponential.model.bacteria.on.time} and click the
button \button{Submit}.
\end{enumerate}
The best model is the one with a highest coefficient of determination.
\end{indication}

\item Plot the graph of the best model of the previous part.
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Charts > Scatter plot}.
\item In the dialog displayed insert the variable \variable{bacteria} in the field \field{Y variable}
and the variable \variable{time} in the field \field{X variable}.
\item In the \mtab{Fitted line} tab check the box \option{Exponencial} and click the button \button{Submit}.
\end{enumerate}
\end{indication}

\item According to the best model, how many bacteria there will be after 3 hours of the beginning of the culture?
And after 10 hours?
Are these predictions reliable?
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Predictions}.
\item In the dialog displayed insert the model \variable{exponential.model.bacteria.on.time} in the field
\field{Regression model}.
\item Enter the values $3.5, 10$ in the field \field{Predictions for} and click the button \button{Submit}.
\item As it is an exponential model, the predictions are for the logarithm of bacteria. 
To get the prediction of bacteria you must apply the exponential function to the values obtained.
\end{enumerate}
\end{indication}

\item Give a prediction as reliable as possible of the time required to have 100 bacteria in the culture.
\begin{indication}
To compute the logarithmic model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Non-linear regression}.
\item In the dialog displayed insert the variable \variable{time} in the field \field{Dependent variable} and the
variable \variable{bacteria} in the field \field{Independent variable}.
\item In the \option{Regression models} tab check the box \option{Logarithmic}.
\item Check the box \option{Save model}, enter the name \variable{logarithmic.model.time.on.bacteria} and click
the button \button{Submit}.
\end{enumerate}
To make the prediction:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Predictions}.
\item In the dialog displayed insert the model \variable{logarithmic.model.time.on.bacteria} in the field
\field{Regression model}.
\item Enter the value $100$ in the field \field{Predictions for} and click the button \button{Submit}.
\end{enumerate}
\end{indication}
\end{enumerate}


\item The data set \variable{diet} of the package \variable{rk.Teaching} contains data of a study about a diet.
For every individual it has been measured the number of days of diet, the weight loss and whether he or she does
physical exercise regularly.

Do the following operations:
\begin{enumerate}
\item Load the data set \variable{diet} from the package \variable{rk.Teaching}.

\item Plot the scatter plot.
According to the point cloud, what type of model explains better the weight loss on the days of diet?
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Charts > Scatter plot}.
\item In the dialog displayed, select the variable \variable{weight.loss} in the field \field{Variable Y}, la
variable \variable{days} in the field \field{Variable X}, and click the button \button{Submit}.
\end{enumerate}
\end{indication}

\item Compute the regression model that explains better the relation between the weight loss and the days of diet. 
Is it a good model for making predictions?
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Model comparison}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Dependent variable} and the
variable \variable{days} in the field \field{Independent variable}.
\item In the \mtab{Regression models} tab check the boxes of the models to compare and click the button \button{Submit}.
\item The best model is the one with the greatest coefficient of determination.
\end{enumerate}
\end{indication}

\item Plot the graph of the previous model. 
\begin{indication}
\begin{enumerate}
\item Select the menu \menu{Teaching > Charts > Scatter plot}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Y variable}
and the variable \variable{days} in the field \field{X variable}.
\item In the tab \mtab{Fitted line} check the box of the corresponding model and click the button \button{Submit}.
\end{enumerate}
\end{indication}

\item Compute the regression model that best explains the relation between the weight loss and the days of diet for the
group of people who don't do physical exercise regularly.
\begin{indication}
To see what is the best regression model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Model comparison}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Dependent variable} and the
variable \variable{days} in the field \field{Independent variable}.
\item Check the box \option{Filter} and enter the condition \lstinline{exercise=="no"} in the field \field{Selection
condition}.
\item In the \mtab{Regression models} tab check all the boxes and click the button \button{Submit}.
\item The best model is the one with the greatest coefficient of determination.
\end{enumerate}
To compute the regression model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Non-linear regression}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Dependent variable} and the
variable \variable{days} in the field \field{Independent variable}.
\item Check the box \option{Filter} and enter the condition \lstinline{exercise=="no"} in the field
\field{Selection condition}.
\item Check the box \option{Save model}, enter the name \variable{regression.weight.loss.on.days.no.exercise} and click
the button \button{Submit}.
\end{enumerate}
\end{indication}

\item Compute the regression model that best explains the relation between the weight loss and the days of diet for the
group of people who do physical exercise regularly.
\begin{indication}
To see what is the best regression mode:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Model comparison}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Dependent variable} and the
variable \variable{days} in the field \field{Independent variable}.
\item Check the box \option{Filter} and enter the condition \lstinline{exercise=="yes"} in the field \field{Selection
condition}.
\item In the \mtab{Regression models} tab check all the boxes and click the button \button{Submit}.
\item The best model is the one with the greatest coefficient of determination.
\end{enumerate}
To compute the regression model:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Non-linear regression}.
\item In the dialog displayed insert the variable \variable{weight.loss} in the field \field{Dependent variable} and the
variable \variable{days} in the field \field{Independent variable}.
\item Check the box \option{Filter} and enter the condition \lstinline{exercise=="yes"} in the field
\field{Selection condition}.
\item Check the box \option{Save model}, enter the name \variable{regression.weight.loss.on.days.exercise} and click
the button \button{Submit}.
\end{enumerate}
\end{indication}

\item Use the previous regression models to predict the weight loss after 40 and 300 days of diet for people who
do physical exercise regularly and for people who don't.
Are the predictions reliable?
\begin{indication}
Predictions for people who do exercise:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Predictions}.
\item In the dialog displayed insert the model \variable{regression.weight.loss.on.days.exercise} in the field
\field{Regression model}.
\item Enter the values $40, 500$ in the field \field{Predictions for} and click the button \button{Submit}.
\end{enumerate}
Predictions for people who don't do exercise:
\begin{enumerate}
\item Select the menu \menu{Teaching > Regression > Predictions}.
\item In the dialog displayed insert the model \variable{regression.weight.loss.on.days.no.exercise} in the field
\field{Regression model}.
\item Enter the values $40, 500$ in the field \field{Predictions for} and click the button \button{Submit}.
\end{enumerate}
\end{indication}
\end{enumerate}

\end{enumerate}


\section{Proposed exercises}
\begin{enumerate}[leftmargin=*]
\item The concentration of a drug in blood, in en mg/dl, depends on time according to the data below. 
\[
\begin{array}{|l|r|r|r|r|r|r|r|}
\hline
\mbox{Time (hours)} & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
\hline
\mbox{Concentration} & 25 & 36 & 48 & 64 & 86 & 114 & 168\\
\hline
\end{array}
\]
Do the following operations: 
\begin{enumerate}
\item According to the exponential modelSegún el modelo exponential, what will be the concentration of the drug in blood
after hours?
Is this prediction reliable?
\item According to the logarithmic model, how much time must pass to have a concentration of 100 mg/dl of drug in blood?
\end{enumerate}

\end{enumerate}