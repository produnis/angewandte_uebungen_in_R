--- 
title: "Angewandte Übungen in R"
subtitle: "Über 300 Aufgaben und Lösungswege für 80 Fragen in 12 Themengebieten der biomedizinischen Statistik."
author:
  - name: Prof. Dr. Jörg große Schlarmann
    url: https://www.produnis.de/R
    affiliation: Hochschule Niederrhein
    affiliation-url: https://www.hs-niederrhein.de
    orcid: 0000-0002-3634-7722
date: 2024-06-22
veranstaltung: "Statistik mit R und RStudio"
bibliography: literatur.bib
csl: _extensions/buechlein/apa-single-spaced.csl
nocite: |
  @grSchlR
language:
  crossref-sec-prefix: "Abschnitt"
number-sections: true
format: buechlein-pdf
    
---

\smallskip\ 

\hrule


```{r}
#| label: setup
#| include: FALSE
library(stats)
library(tidyverse)
```

\newpage 

# Angewandte Übungen in R {-}

In diesem Script wollen wir Übungsaufgaben zu verschiedenen Teilen der Statistik vorstellen und lösen. Die Aufgaben stammen von @gimeno_applied_2022^[siehe <https://github.com/asalber/statistics_practice_rkteaching>]. Dort werden die Lösungswege unter Verwendung der Software RKWard^[siehe <https://rkward.kde.org/>] besprochen. Im vorliegenden Script sollen die Lösungen "zu Fuß" erarbeitet werden. Hierbei kann das freie Nachschlagewerk von @grSchlR hilfreich sein.


## Lizenz {-}

![](_extensions/buechlein/ccbyncsa.png){width=2cm}

Die Aufgaben stammen von @gimeno_applied_2022. Und da dieses Script darauf aufbaut, ist es ebenfalls unter `CC BY-NC-SA 4.0`^[siehe <https://creativecommons.org/licenses/by-nc-sa/4.0/>] lizensiert.

Sie dürfen:

- **Teilen** — das Material in jedwedem Format oder Medium vervielfältigen und weiterverbreiten     
- **Bearbeiten** — das Material remixen, verändern und darauf aufbauen

Unter folgenden Bedingungen:

- **Namensnennung** — Sie müssen angemessene Urheber- und Rechteangaben machen , einen Link zur Lizenz beifügen und angeben, ob Änderungen vorgenommen wurden. Diese Angaben dürfen in jeder angemessenen Art und Weise gemacht werden, allerdings nicht so, dass der Eindruck entsteht, der Lizenzgeber unterstütze gerade Sie oder Ihre Nutzung besonders.
- **Nicht kommerziell** — Sie dürfen das Material nicht für kommerzielle Zwecke nutzen.
    Weitergabe unter gleichen Bedingungen — Wenn Sie das Material remixen, verändern oder anderweitig direkt darauf aufbauen, dürfen Sie Ihre Beiträge nur unter derselben Lizenz wie das Original verbreiten.
- **Keine weiteren Einschränkungen** — Sie dürfen keine zusätzlichen Klauseln oder technische Verfahren einsetzen, die anderen rechtlich irgendetwas untersagen, was die Lizenz erlaubt.

\vfill

::: {.callout-tip}
## **Zitationsvorschlag**
große Schlarmann, J (2024): "Angewandte Übungen in R", Hochschule Niederrhein, <https://www.produnis.de/R/exercise.html>

\scriptsize

```bibtex
@book{grSchl_exeRcise,
	author = {{große Schlarmann}, Jörg},
	title = {Angewandte Übungen in R},
	year = {2024},
	publisher = {Hochschule Niederrhein},
	address = {Krefeld},
	copyright = {CC BY-NC-SA 4.0},
	url = {https://www.produnis.de/R/exercise.html},
	language = {de},
}
```

:::

\normalsize

\newpage

# Aufgabenstellung {#sec-Aufgaben}

Versuchen Sie zunächst selbst eine Lösung zu finden bevor Sie sich die Auflösungen anschauen.

## Häufigkeitsverteilungen {#sec-aufgabeHaeufig}

### Aufgabe [-@sec-A01] Kinder in Familien {#sec-A01}
::: {.callout-note appearance="simple" icon=false}
Für 25 Familien liegt die Anzahl an Kindern vor:

> 1, 2, 4, 2, 2, 2, 3, 2, 1, 1, 0, 2, 2, 0, 2, 2, 1, 2, 2, 3, 1, 2, 2, 1, 2

a) Erstellen Sie ein Datenframe mit der Variable `Kinder` und übertragen Sie die Daten.
b) Erzeugen Sie eine einfache Häufigkeitstabelle
c) Erzeugen Sie ein Balkendiagramm der Häufigkeiten
d) Erzeugen Sie eine vollständige Häufigkeitstabelle, inklusive absoluter, relativer und jeweils kumulativer Häufigkeiten

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L01
:::

\smallskip\ 


### Aufgabe [-@sec-A02] Patienten in der Notaufnahme {#sec-A02}
::: {.callout-note appearance="simple" icon=false}
Den gesamten November über wurde die Anzahl an Patienten in der Notaufnahme erhoben

\begin{center}
15 \quad 23 \quad 12 \quad 10 \quad 28 \quad 50 \quad 12 \quad 17 \quad 20 \quad 21 \quad 18 \quad 13 \quad 11 \quad 12 \quad 26 \\
30 \quad 6 \quad 16 \quad 19 \quad 22 \quad 14 \quad 17 \quad 21 \quad 28 \quad 9 \quad 16 \quad 13 \quad 11 \quad 16 \quad 20
\end{center}

a) Erstellen Sie ein Datenframe mit der Variable `Patienten` und übertragen Sie die Daten.
b) Erzeugen Sie ein Boxplot. Gibt es Ausreißer? Wenn ja, entfernen Sie diese, bevor Sie weitermachen.
c) Erzeugen Sie eine Häufigkeitstabelle, welche die Daten in 5 Klassen gruppiert.
d) Erzeugen Sie ein Histogram der klassierten absoluten Häufigkeiten.
e) Erzeugen Sie ebenso Histogramme der relativen und jeweils kumulativen Häufigkeiten, inklusive Polygonzügen.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L02
:::
\smallskip\ 



### Aufgabe [-@sec-A03] Blutgruppen {#sec-A03}
::: {.callout-note appearance="simple" icon=false}
Von 30 Personen wurden die Blutgruppen wie folgt bestimmt:

\begin{center}
A, B, B, A, AB, 0, 0, A, B, B, A, A, A, A, AB,\\
A, A, A, B, 0, B, B, B, A, A, A, 0, A, AB, 0. 
\end{center}

a) Erstellen Sie ein Datenframe mit der Variable `Blutgruppe` und übertragen Sie die Daten.
b) Erzeugen Sie eine Häufigkeitstabelle
c) Erzeugen Sie ein Kreisdiagramm
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L03
:::
\smallskip\ 





### Aufgabe [-@sec-A04] Familienstand {#sec-A04}
::: {.callout-note appearance="simple" icon=false}
Das Alter und der Familienstand von 28 Personen wurden wie folgt erhoben:


| Familienstand | Alter |   |   |   |   |   |   |   |   |  
|---------------|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| Single        | 31 | 45 |  35 | 65 | 21 | 38 | 62 | 22 | 31 |
| Verheiratet   | 72 | 39 | 62 | 59 | 25 | 44 | 54 |
| Verwitwet     | 80 | 68 | 65 | 40 | 78 | 69 | 75 |
| Geschieden    | 31 | 65 | 59 | 58 | 50 |


a) Erstellen Sie ein Datenframe mit den Variablen `Alter` und `Familienstand` und übertragen Sie die Daten.
b) Erzeugen Sie für jeden `Familienstand` eine Häufigkeitstabelle des `Alters`.
c) Erzeugen Sie für jeden `Familienstand` eine Boxplot des `Alters`. Gibt es Ausreißer? In welcher Gruppe streut das Alter am meisten?
d) Erzeugen Sie für jeden `Familienstand` eine Histogram des `Alters`. Wie unterscheiden sich die Histogramme?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L04
:::
\smallskip\ 





### Aufgabe [-@sec-A05] Handballverletzungen {#sec-A05}
::: {.callout-note appearance="simple" icon=false}
Die Anzahl der Verletzungen von Handballspielern eines Teams wurden wie folgt erhoben:

> 0, 1, 2, 1, 3, 0, 1, 0, 1, 2, 0, 1, 1, 1, 2, 0, 1, 3, 2, 1, 2, 1, 0, 1



a) Erstellen Sie eine Häufigkeitstabelle
b) Erzeugen Sie ein Säulendiagramm der relativen und kumulativen relativen Häufigkeiten.
c) Erzeugen Sie ein Boxplot
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L05
:::
\smallskip\ 




### Aufgabe [-@sec-A06] Körpergröße {#sec-A06}
::: {.callout-note appearance="simple" icon=false}
Von 30 Studierenden wurde die Körpergröße gemessen

> 179, 173, 181, 170, 158, 174, 172, 166, 194, 185,\newline 162, 187, 198, 177, 178, 165, 154, 188, 166, 171,\newline 175, 182, 167, 169, 172, 186, 172, 176, 168, 187



a) Erstellen Sie ein Histogram der Körpergröße mit Klassen von 150cm bis 200cm, die jeweils 10cm breit sind. 
b) Gibt es Ausreißer?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L06
:::
\smallskip\ 

### Aufgabe [-@sec-A07] Neugeborene {#sec-A07}
::: {.callout-note appearance="simple" icon=false}
Der Datensatz `neonates` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/neonates.RData>] enthält Informationen über eine Stichprobe von 320 Neugeborenen, die im Laufe eines Jahres nach normaler Schwangerschaftsdauer geboren wurden.

a) Erstellen Sie die Häufigkeitstabelle des APGAR-Scores nach 1 Minute. Wenn ein Score von 3 oder weniger anzeigt, dass das Neugeborene in einem kritischen Zusatand ist, wie viel Prozent der Neugeborenen in der Stichprobe sind dann in einem kritischen Zustand?

b) Erstellen Sie die Häufigkeitstabelle des Geburtsgewichts der Neugeborenen, indem Sie die Daten in Klassen mit einer Breite von 0,5 kg von 2 bis 4,5 kg einteilen. Welches Intervall enthält die meisten Neugeborenen?

c) Vergleichen Sie die Häufigkeitsverteilung des APGAR-Scores nach 1 Minute für Mütter unter 20 Jahren und für Mütter über 20 Jahren. Welche Gruppe hat mehr Neugeborene in kritischem Zustand?

d) Vergleichen Sie die relative Häufigkeitsverteilung des Geburtsgewichts der Neugeborenen, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Wenn ein Gewicht unter 2,5 kg als niedriges Gewicht gilt, welche Gruppe hat einen höheren Prozentsatz an Neugeborenen mit niedrigem Gewicht?

e) Berechnen Sie die Prävalenz von Neugeborenen mit niedrigem Gewicht für Mütter, die vor der Schwangerschaft geraucht haben, und den Nichtraucherinnen.

f) Berechnen Sie das relative Risiko eines niedrigen Geburtsgewichts des Neugeborenen, wenn die Mutter während der Schwangerschaft raucht, im Vergleich dazu, wenn die Mutter nicht raucht.

g) Erstellen Sie ein Balkendiagramm des APGAR-Scores nach 1 Minute. Welcher Score ist am häufigsten?

h) Erstellen Sie das Balkendiagramm der kumulierten relativen Häufigkeit des APGAR-Scores nach 1 Minute. Unter welchem Wert liegen die Hälfte der Neugeborenen?

i) Vergleichen Sie die Balkendiagramme der relativen Häufigkeitsverteilungen des APGAR-Scores nach 1 Minute, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Welche Schlussfolgerungen können gezogen werden?

j) Erstellen Sie ein Histogramm der Geburtsgewichte der Neugeborenen mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg. Welche Klasse enthält die meisten Neugeborenen?

k) Vergleichen Sie die relativen Häufigkeitshistogramme der Geburtsgewichte der Neugeborenen, mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Welche Gruppe hat Neugeborene mit geringeren Gewichten?

l) Vergleichen Sie die relativen Häufigkeitshistogramme der Geburtsgewichte der Neugeborenen, mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg, je nachdem, ob die Mutter vor der Schwangerschaft geraucht hat oder nicht. Welche Schlussfolgerungen können gezogen werden?

m) Erstellen Sie ein Boxplot der Geburtsgewichte der Neugeborenen. Welcher Gewichtsbereich kann in der Stichprobe als normal angesehen werden? Gibt es Ausreißer in der Stichprobe?

n) Vergleichen Sie die Boxplots der Geburtsgewichte der Neugeborenen je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht und ob die Mutter unter 20 oder über 20 Jahre alt war. Welche Gruppe hat eine größere zentrale Streuung? Welche Gruppe hat Neugeborene mit geringerem Gewicht?

o) Vergleichen Sie die Boxplots der APGAR-Scores nach 1 Minute und nach 5 Minuten. Welche Variable hat eine größere zentrale Streuung?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-L07
:::

\newpage





## Stichprobenstatistik {#sec-aufgabeStichprobe}

Bei diesen Aufgaben geht es vor allem um Lage- und Streuungskenngrößen.


### Aufgabe [-@sec-B01] Kinder in Familien {#sec-B01}
::: {.callout-note appearance="simple" icon=false}
Die Anzahl an Kindern in einer Stichprobe aus 25 Familien sind:

> 1, 2, 4, 2, 2, 2, 3, 2, 1, 1, 0, 2, 2, 0, 2, 2, 1, 2, 2, 3, 1, 2, 2, 1, 2

a) Erstellen Sie ein Datenframe mit der Variable `Kinder` und übertragen Sie die Daten.
b) Berechnen Sie das arithmetische Mittel, die Varianz sowie die Standardabweichung für die Anzahl an Kindern.
c) Berechnen Sie die Quartile, die Spannweite, den Interquartilsabstand, das dritte Dezil sowie das 68te Perzentil.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB01
:::
\smallskip\ 



### Aufgabe [-@sec-B02] Patienten in Notaufnahme {#sec-B02}
::: {.callout-note appearance="simple" icon=false}
Den gesamten November über wurde die Anzahl an Patienten in der Notaufnahme erhoben

\begin{center}
15 \quad 23 \quad 12 \quad 10 \quad 28 \quad 50 \quad 12 \quad 17 \quad 20 \quad 21 \quad 18 \quad 13 \quad 11 \quad 12 \quad 26 \\
30 \quad 6 \quad 16 \quad 19 \quad 22 \quad 14 \quad 17 \quad 21 \quad 28 \quad 9 \quad 16 \quad 13 \quad 11 \quad 16 \quad 20
\end{center}

a) Erstellen Sie ein Datenframe mit der Variable `Patienten` und übertragen Sie die Daten.
b) Berechnen Sie das arithmetische Mittel, die Varianz, die Standardabweichung und den Variationskoeffizienten.
c) Berechnen Sie die Skewness (Schiefe) und Kurtosis ("Spitzigkeit") und interpretieren Sie die Werte.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB02
:::
\smallskip\ 



### Aufgabe [-@sec-B03] Studierendenbewertung {#sec-B03}
::: {.callout-note appearance="simple" icon=false}
Im letzten R-Kurs haben 20 Studierende folgende Abschlussbewertungen erhalten

> SS, AP, SS, AP, AP, NT, NT, AP, SB, SS \newline SB, SS, AP, AP, NT, AP, SS, NT, SS, NT

a) Erstellen Sie ein Datenframe mit der Variable `Bewertung` und übertragen Sie die Daten.
b) Wandeln Sie die `Bewertung` in Punkte um, nach dem Schema 
   "`SS`" = 2,5 | "`AP`" = 6 | "`NT`" = 8 | "`SB`" = 9,5.
c) Bestimmen Sie den Median und den Interquartilsabstand.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB03
:::
\smallskip\ 



### Aufgabe [-@sec-B04] Körpergröße nach Geschlecht {#sec-B04}
::: {.callout-note appearance="simple" icon=false}
Von 30 Studierenden wurde die Körpergröße wie folgt gemessen:


| Geschlecht | Größe |
|---|---------------|
| weiblich   | 173, 158, 174, 166, 162, 177, 165, 154, 166, 182, 169, 172, 170, 168 |
| männlich   | 179, 181, 172, 194, 185, 187, 198, 178, 188, 171, 175, 167, 186, 172, 176, 187 |

a) Erstellen Sie ein Datenframe mit den Variable `Geschlecht` und `Koerpergroesse` und übertragen Sie die Daten.
b) Bestimmen Sie in Abhängigkeit zum `Geschlecht` das arithmetische Mittel, den Median, die Varianz, die Standardabweichung sowie die Quartile.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB04
:::

\smallskip\ 



### Aufgabe [-@sec-B05] Handballverletzungen {#sec-B05}
::: {.callout-note appearance="simple" icon=false}
Die Anzahl der Verletzungen von Handballspielern eines Teams wurden wie folgt erhoben:

> 0, 1, 2, 1, 3, 0, 1, 0, 1, 2, 0, 1, 1, 1, 2, 0, 1, 3, 2, 1, 2, 1, 0, 1

a) Bestimmen Sie das arithmetische Mittel, den Median, die Varianz sowie die Standardabweichung der Verletzungen.
b) Bestimmen Sie die Skewness und Kortosis der Verteilung.
c) Berechnen Sie das vierte und achte Dezil der Verteilung.   
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB05
:::
\smallskip\ 



### Aufgabe [-@sec-B06] Blutdruckmessung {#sec-B06}
::: {.callout-note appearance="simple" icon=false}
Wir möchten die Zuverlässigkeit zweier Blutdruckmonitore bestimmen. Gerät 1 misst den Blutdruck am Handgelenk, Gerät 2 am Unterarm. Es wurden 8 Messungen mit jedem Gerät bei der selben Person durchgeführt, wobei folgende systolischen Werte gemessen wurden:

| Position   | Messdaten |
|------------|-----------|
| Unterarm   | 111, 109, 112, 111, 113, 113, 114, 111 |
| Handgelenk | 115, 113, 117, 116, 112, 112, 117, 112 |

Welcher Monitor funktioniert besser?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB06
:::

\smallskip\ 



### Aufgabe [-@sec-B07] Alter und Familienstand {#sec-B07}
::: {.callout-note appearance="simple" icon=false}
Das Alter und der Familienstand von 28 Personen wurden wie folgt erhoben:


| Familienstand | Alter |   |   |   |   |   |   |   |   |  
|---------------|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| Single        | 31 | 45 |  35 | 65 | 21 | 38 | 62 | 22 | 31 |
| Verheiratet   | 72 | 39 | 62 | 59 | 25 | 44 | 54 |
| Verwitwet     | 80 | 68 | 65 | 40 | 78 | 69 | 75 |
| Geschieden    | 31 | 65 | 59 | 58 | 50 |


a) Bestimmen Sie das arithmetische Mittel, den Median, die Varianz sowie die Standardabweichung des `Alters` für jeden `Familienstand`.
b) Welche Gruppe hat den "besten" Mittelwert?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB07
:::
\smallskip\ 




### Aufgabe [-@sec-B08] Tabak, Alkohol und Blutdruck {#sec-B08}
::: {.callout-note appearance="simple" icon=false}
Eine Studie möchte den möglichen Zusammenhang zwischen dem Blutdruck und dem Alkohol- und Tabakkonsum untersuchen. Hierzu wurden folgende Daten von 25 Personen erhoben.


\begin{center}
\begin{tabular}{lccccccccccccc}
\hline
Rauchen  & ja & nein & ja & ja & ja & nein & nein & ja & nein & ja & nein & ja & nein \\
Alkohol & nein & nein & ja & ja & nein & nein & ja & ja & nein & ja & nein & ja & ja \\
Blutdruck & 80 & 92 & 75 & 56 & 89 & 93 & 101 & 67 & 89 & 63 & 98 & 58 & 91 \\
\hline
\\
\hline
Rauchen  & ja & nein & nein & ja & nein & nein & nein & ja & nein & ja & nein & ja \\
Alkohol & ja & nein & ja & ja & nein & nein & ja & ja & ja & nein & ja & nein \\
Blutdruck & 71 & 52 & 98 & 104 & 57 & 89 & 70 & 93 & 69 & 82 & 70 & 49 \\
\hline
\end{tabular}
\end{center}

a) Vergleichen Sie das arithmetische Mittel, die Standardabweichung, die Skewness und Kurtosis des `Blutdrucks` zwischen Rauchern und Nichtrauchern.
b) Vergleichen Sie die selben Werte zwischen der Alkohol- und Nicht-Alkoholgruppe.
c) Vergleichen Sie die selben Werte zwischen der Raucher- und Alkoholgruppe, zwischen der Raucher- und Nicht-Alkoholgruppe, der Nichtraucher- und Alkoholgruppe sowie der Nichtraucher- und Nicht-Alkoholgruppe.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LB07
:::
\bigskip\ 


## Lineare Regression {#sec-aufgabeLinReg}

### Aufgabe [-@sec-C01] X und Y {#sec-C01}
::: {.callout-note appearance="simple" icon=false}
Bei 10 Personen wurden `x` und `y` erhoben.


| x | 0 |  1 |  2 |  3 |4 | 5 | 6 | 7 | 8 | 9  |  
|---|---|---|---|---|---|---|---|---|---|---|
| y |  2 | 5 |8 |11 | 14 | 17 | 20 | 23 |  26 | 29 |


a) Erstellen Sie ein Datenframe mit den Variablen `x` und `y`.
b) Erzeugen Sie ein Scatterplot von  `x` und `y`. Bestimmen Sie anhand des Plots, welche Regressionsfunktion die Daten am besten erklären würde.
c) Führen Sie die Regression durch.
d) Fügen Sie die Regressionsfunktion `y erklärt durch x`  dem Plot hinzu.
e) Fügen Sie die Regressionsfunktion `x erklärt durch y` ebenfalls dem Plot hinzu, aber in roter Farbe.
f) Wie groß sind die Residuen?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC01
:::
\smallskip\ 



### Aufgabe [-@sec-C02] Lernen und Durchfallen {#sec-C02}
::: {.callout-note appearance="simple" icon=false}
Eine Studie gibt vor, den Zusammenhang zwischen den täglichen Lernstunden und der Anzahl nicht bestandener
Prüfungen im Semester zu untersuchen. Bei 30 Studierenden wurden folgende Werte erhoben:

$$
\begin{array}{cccccccc}
\text{Lernzeit} & \text{durchgefallen} &  & \text{Lernzeit} & \text{durchgefallen} & & \text{Lernzeit} &
\text{durchgefallen}
\\
\cline{1-2}\cline{4-5}\cline{7-8}
3.5 & 1 & & 2.2 & 2 & & 1.3 & 4 \\
0.6 & 5 & & 3.3 & 0 & & 3.1 & 0 \\
2.8 & 1 & & 1.7 & 3 & & 2.3 & 2 \\
2.5 & 3 & & 1.1 & 3 & & 3.2 & 2 \\
2.6 & 1 & & 2.0 & 3 & & 0.9 & 4 \\
3.9 & 0 & & 3.5 & 0 & & 1.7 & 2 \\
1.5 & 3 & & 2.1 & 2 & & 0.2 & 5 \\
0.7 & 3 & & 1.8 & 2 & & 2.9 & 1 \\
3.6 & 1 & & 1.1 & 4 & & 1.0 & 3 \\
3.7 & 1 & & 0.7 & 4 & & 2.3 & 2 \\
\end{array}
$$



a) Erstellen Sie ein Datenframe mit den Variablen `Lernen` und `Durchgefallen`.
b) Erzeugen Sie eine Kreuztabelle der Variablen `Lernen` und `Durchgefallen`.
c) Führen Sie eine lineare Regression `Durchgefallen erklärt durch Lernen` durch und plotten Sie Ihr Ergebnis.
d) Wie lauten die Regressionskoeffizient des Modells, und wie ist er zu interpretieren?
e) Ist das soeben erstellte Modell *besser* als das in @sec-C01 berechnete? Vergleichen Sie zur Beantwortung die Residuen beider Modelle.
f) Berechnen Sie den linearen Bestimmungskoeffizient und den Korrelationskoeffizient. Ist das lineare Modell ein gutes Modell, um die Beziehung zwischen den gescheiterten Prüfungen und den täglichen Studienzeiten zu erklären? Wie viel Prozent der Variabilität der durchgefallenen Prüfungen wird durch das lineare Modell erklärt?
g) Benutzen Sie das lineare Modell, um die Anzahl an durchgefallenen Prüfungen für einen Studierenden zu bestimmen, der 3 Stunden Lernzeit investiert hat. Wie glaubwürdig ist die Vorhersage?
h) Wie viele Stunden Lernzeit wird benötigt, um alle Kurse zu bestehen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC02
:::
\smallskip\ 



### Aufgabe [-@sec-C03] Metabolismus {#sec-C03}
::: {.callout-note appearance="simple" icon=false}
Um herauszufinden, wie der Körper Alkohol verstoffwechselt, hat ein Proband einen Liter Wein zügig getrunken. Anschließend wurde alle 30 Minuten der Blutalkoholspiegel gemessen.

|Minuten| 30 |60| 90| 120|150| 180 |210|
|---|---|---|---|---|---|---|---|
|Alkohol (g/l) | 1.6 | 1.7| 1.5| 1.1| 0.7| 0.2| 2.1|


a) Erstellen Sie ein Datenframe mit den Variablen `Minuten` und `Alkohol`.
b) Bestimmen Sie den passenden Korrelationskoeffizienten. Werden die Daten ausreichend gut durch das Modell beschrieben?
c) Plotten Sie das lineare Regressionsmodell `Alkohol erklärt durch Minuten`. Gibt es Punkte mit großen Residuen? Wenn ja, entfernen Sie diese und führen die Berechnungen erneut durch. Hat sich der Korrelationskoeffizient verbessert?
d) Mit welcher Geschwindigkeit wird der Alkohol pro Minute verstoffwechselt?
e) Wenn es gesetzlich erlaubt wäre, mit einem Blutalkoholwert von $0,3$ g/l Auto zu fahren, wie lange muss die Person warten, nachdem sie $1$ Liter Weingetrunken hat, um wieder fahrtüchtig zu sein? Wie zuverlässig ist diese Vorhersage?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC03
:::
\smallskip\ 



### Aufgabe [-@sec-C04] Alter und Körpergröße {#sec-C04}
::: {.callout-note appearance="simple" icon=false}
Im Datensatz `age.height` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/age.height.RData>] sind Alter und Körpergröße von 30 Probanden enthalten.


a) Laden Sie den Datensatz `age.height` in Ihre R-Session.
b) Berechnen Sie die Regressionsgerade `Größe erklärt durch Alter`. Ist das lineare Modell geeignet, den Zusammenhang zwischen `Alter` und `Körpergröße` zu erklären?
c) Erstellen Sie eine Punktwolke inklusive der Regressionsgeraden. Ab welchem Alter ändert sich die Punktetendenz?
d) Erstellen Sie eine Gruppierungsvariable, welche `Alter` in einen ordinalen Faktor mit den Ausprägungen "`jünger als 20`" und "`20 und älter`" einteilt.
e) Führen Sie die lineare Regressionsanalyse für beide Gruppen erneut durch. In welcher Gruppe wird der Zusammenhang zwischen `Alter` und `Körpergröße` am besten erklärt?
f) Plotten Sie die Modelle.
g) Welche Körpergröße sagt Ihr Modell für eine 14jährige Person vorher, und welche für eine 38jährige Person?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC04
:::
\smallskip\ 


### Aufgabe [-@sec-C05] Wirksamkeitsverlust {#sec-C05}
::: {.callout-note appearance="simple" icon=false}
Eine Studie Untersucht den Wirksamkeitsverlust eines Medikaments, das über Jahre von vielen Probanden eingenommen wurde.
Folgende Aussagen zur Wirksamkeit konnten aus den Daten ermittelt werden.

| Jahr | 1 | 2 | 3 | 4 | 5 |
|---|---|---|---|---|---|
| Wirksamkeit (\%) | 96 | 84 | 70 | 58 | 52 |


a) Führen Sie eine lineare Regression `Wirksamkeit erklärt durch Jahr` durch und plotten Sie Ihr Ergebnis.
b) Wie große ist der jährliche Wirksamkeitsverlust in \%?
c) Nach wie vielen Jahren ist die Wirksamkeit bei 80%, und nach wie vielen bei 0%? Sind beide Werte gleich zuverlässig?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC05
:::
\smallskip\ 


### Aufgabe [-@sec-C06] Dosierung {#sec-C06}
::: {.callout-note appearance="simple" icon=false}
In einer Studie über die Wirkung verschiedener Dosen eines Medikaments erhielten 2 Patienten 2 mg und benötigten 5 Tage zur Heilung, 4 Patienten erhielten 2 mg und benötigten 6 Tage zur Heilung, 2 Patienten erhielten 3 mg und benötigten 3 Tage zur Heilung, 4 Patienten erhielten 3 mg und benötigten 5 Tage zur Heilung, 1 Patient erhielt 3 mg und benötigte 6 Tage zur Heilung, 5 Patienten erhielten 4 mg und benötigten 3 Tage zur Heilung und 2 Patienten erhielten 4 mg und benötigten 5 Tage zur Heilung. 


a) Berechnen Sie die Regressionsgerade der Heilungstage in Abhängigkeit von der Dosis.
b) Berechnen Sie den Regressionskoeffizienten der Heilungstage in Abhängigkeit von der Dosis und interpretieren Sie ihn.
c) Berechnen Sie den Korrelationskoeffizienten und interpretieren Sie ihn.
d) Bestimmen Sie die erwartete Zeit, die für die Heilung mit einer Dosis von 5 mg benötigt wird. Ist diese Vorhersage zuverlässig? Begründen Sie die Antwort.
e) Welche Dosis muss angewendet werden, um in 4 Tagen zu heilen? Ist diese Vorhersage zuverlässig? Begründen Sie die Antwort.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC06
:::
\smallskip\ 



### Aufgabe [-@sec-C07] Gewicht und Körpergröße {#sec-C07}
::: {.callout-note appearance="simple" icon=false}
Im Datensatz `heigths.weights.students` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/heights.weights.students.RData>] sind Gewicht und Körpergröße von 100 Probanden enthalten.


a) Laden Sie den Datensatz `heigths.weights.students` in Ihre R-Session.
b) Führen Sie eine lineare Regression `Gewicht erklärt durch Größe` durch.
c) Erstellen Sie eine Punktwolke inklusive Regressionsgeraden jeweils für Männer und Frauen getrennt.
d) Berechnen Sie die Bestimmtheitskoeffizienten (R^2^) für beide Modelle. Welches Modell erklärt besser die Beziehung zwischen Gewicht und Größe, das der Männer oder das der Frauen? Begründen Sie die Antwort.
e) Was ist das zu erwartende Gewicht für einen Mann mit 170cm Körpergröße? Und für eine Frau der selben Größe?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC07
:::
\smallskip\ 



### Aufgabe [-@sec-C08] Neugeborene {#sec-C08}
::: {.callout-note appearance="simple" icon=false}
Der Datensatz `neonates` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/neonates.RData>] enthält Informationen über eine Stichprobe von 320 Neugeborenen, die im Laufe eines Jahres nach normaler Schwangerschaftsdauer geboren wurden.

a) Erstellen Sie eine Kreuztabelle vom APGAR-Wert nach 1 Minute und dem Rauchverhalten der Mütter während der Schwangerschaft. Welche Schlüsse lassen sich ziehen?
b) Erstellen Sie eine Kreuztabelle vom APGAR-Wert nach 1 Minute und der Alterskategorie der Mütter. Welche Schlüsse lassen sich ziehen?
c) Führen Sie eine lineare Regression für `Geburtsgewicht erklärt durch Anzahl täglich gerauchter Zigaretten` durch. Gibt es einen starken linearen Zusammenhang?
d) Plotten Sie Ihre Regression. Passt die Regressionsgerade gut zur Punktwolke?
e) Wiederholen Sie die Regression, aber nutzen Sie dieses Mal nur Daten von Raucherinnen. Ist dieses Modell besser oder schlechter als das vorherige? Wieviel Gewicht verliert ein Neugeborenes nach diesem Modell pro täglich gerauchter Zigarette?
f) Welches Geburtsgewicht sagt dieses Modell für ein Neugeborenes vorher, dessen Mutter 5 Zigaretten täglich während der Schwangerschaft geraucht hat? Wieviel für eine Mutter, die 30 Zigaretten täglich raucht. Wie zuverlässich sind diese Ergebnisse?
g) Ändert sich der lineare Zusammenhang, wenn die Daten nach Altersgruppen getrennt untersucht werden?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LC08
:::

\newpage


## Nicht-lineare Regression {#sec-aufgabeNonLinReg}


### Aufgabe [-@sec-D01] Bakterien {#sec-D01}
::: {.callout-note appearance="simple" icon=false}

Die Anzahl an Bakterien in einer Kultur vermehrt sich wie folgt:

| Stunden | 1 | 2|3|4|5|6|7|8|9|
|---|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| Bakterien |  25| 28| 47| 65| 86| 121| 190| 290| 362|


a) Erstellen Sie ein Datenframe mit den Variablen `Stunden` und `Bakterien`.
b) Erzeugen Sie ein Scatterplot. Welche Regression würden Sie auf Grundlage des Plots vorschlagen?
c) Berechnen Sie die quadratischen und exponentiellen Modelle für die Bakterienvermehrung über die Zeit.
d) Plotten Sie das bessere Modell in die Punktwolke.
e) Wie viele Bakterien werden nach dem besten Modell 3 Stunden nach Anlegen der Kultur vorhanden sein? Und nach 10 Stunden? Sind diese Vorhersagen zuverlässig?
f) Machen Sie eine möglichst zuverlässige Vorhersage über die Zeit, die benötigt wird, um 100 Bakterien in der Kultur zu haben.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LD01
:::


### Aufgabe [-@sec-D02] Diät {#sec-D02}
::: {.callout-note appearance="simple" icon=false}

Der Datensatz `diet` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/diet.RData>] enthält Informationen über eine Diätenuntersuchung. Für jede Person wurde die Anzahl der Diättage, der Gewichtsverlust und die regelmäßige körperliche Betätigung gemessen.

a) Laden Sie den Datensatz `diet` in Ihre R-Session.
b) Erstellen Sie eine Punktwolke. Welche Art von Modell erklärt auf Grundlage der Punktwolke den Gewichtsverlust pro Diättag besser?
c) Berechnen Sie das Regressionsmodell, welches den Gewichtsverlust mit der Anzahl an Diättagen am besten (im Vergleich zu anderen) erklären kann. Wird das Modell zuverlässige Vorhersagen machen?
d) Plotten Sie Ihr Modell.
e) Berechnen Sie das Regressionsmodell, das den Gewichtsverlust mit den
Tagen der Diät für die Gruppe der Personen, die sich nicht regelmäßig körperlich betätigen, am besten erklären kann.
f) Wiederholen Sie die Analyse für die Gruppe, die sich regelmäßig körperlich betätigt.
g) Benutzen Sie die erstellen Modelle, um den Gewichtsverlust nach 30 und nach 100 Tagen Diät für Personen, die sich körperlich betätigen, und für solche, die dies nicht tun, vorherzusagen. Sind diese Vorhersagen zuverlässig?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LD02
:::
\smallskip\ 

### Aufgabe [-@sec-D03] Blutkonzentration {#sec-D03}
::: {.callout-note appearance="simple" icon=false}

Die Konzentration eines Arzneimittels im Blut in mg/dl hängt von der Zeit ab, wie aus den folgenden Daten hervorgeht.

| Stunden | 2|3|4|5|6|7|8|
|---|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| Konzentration | 25| 36| 48| 64| 86| 114| 168|

a) Benutzen Sie ein exponentielles Modell, um die Konzentration nach 10 Stunden vorherzusagen. Ist die Vorhersage zuverlässig?
b) Benutzen Sie ein logarithmisches Modell um zu bestimmen, nach wie vielen Stunden eine Konzentration von 100 mg/dl erreicht sein wird.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LD03
:::
\smallskip\ 






## Wahrscheinlichkeiten {#sec-aufgabeWahrscheinlich}

### Aufgabe [-@sec-E01] Glücksspiel {#sec-E01}
::: {.callout-note appearance="simple" icon=false}

Lassen Sie in R ...

a) eine beliebige Poker-Spielkarte^[Den Datensatz für ein Pokerkartenspiel erhalten Sie unter <https://www.produnis.de/R/data/cards.RData>] ziehen.
b) 2 Münzen werfen.
c) 2 Würfeln werfen.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE01
:::
\smallskip\ 

### Aufgabe [-@sec-E02] Münzwürfe {#sec-E02}
::: {.callout-note appearance="simple" icon=false}

Wiederholen Sie die Zufallsexperimente und lassen Sie R $10$ mal, $100$ mal $1.000$ mal und $1.000.000$ mal zwei Münzen werfen.

a) Erstellen Sie je eine relative Häufigkeitstabelle der Ergebnisse. Wie sind die Tabellen zu bewerten?
b) Welche theoretischen Wahrscheinlichkeiten haben die möglichen Wurfergebnisse? Stimmen diese mit den beobachteten Ergebnissen überein?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE02
:::
\smallskip\ 



### Aufgabe [-@sec-E03] Medizinschrank {#sec-E03}
::: {.callout-note appearance="simple" icon=false}

In einem Medizinschrank befinden sich drei Boxen mit Medikament A, zwei Boxen mit Medikament B und eine Box mit Medikament C.

a) Ziehen Sie zufällig 3 Boxen, ohne zurücklegen.
b) Ziehen Sie zufällig 3 Boxen, diesmal mit zurücklegen.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE03
:::
\smallskip\ 

### Aufgabe [-@sec-E04] Kinderkrankheiten {#sec-E04}
::: {.callout-note appearance="simple" icon=false}

Eine epidemiologische Untersuchung wurde durchgeführt, um die Lebenszeitprävalenz von drei häufigen Kinderkrankheiten zu ermitteln: Windpocken, Masern und Röteln. Die beobachteten Häufigkeiten sind in der nachstehenden Tabelle aufgeführt.

| Windpocken | Masern | Röteln | Häufigkeit |
|:---:|:---:|:---:|---:|
| No | No| No| 2654|
|No| No| Yes| 1436|
|No| Yes| No| 1682|
|No| Yes| Yes| 668|
|Yes| No| No| 1747|
|Yes| No| Yes| 476|
|Yes| Yes| No| 876|
|Yes| Yes| Yes| 265|

a) Erstellen Sie ein Datenframe mit den Variablen `Windpocken`, `Masern`, `Röteln` und `Häufigkeit` und übertragen Sie die Daten.
b) Erstellen Sie den Wahrscheinlichkeitsraum der Lebenszeitprävalenz.
c) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Windpocken hatte?
d) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Windpocken oder Masern hatte?
e) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Masern und Röteln hatte?
f) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person, die bereits an Masern erkrankte, nun an Windpocken erkrankt?
g) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person, die keine Masern und keine Röteln hatte, an Windpocken erkrankt?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE04
:::
\smallskip\ 





### Aufgabe [-@sec-E05] Schwangerschaftstest {#sec-E05}
::: {.callout-note appearance="simple" icon=false}

Ein Schwangerschaftstest, der von vielen Frauen angewendet wurde, erzielte folgende Ergebnisse.

| Schwanger | Test |  Häufigkeit |
|:---:|:---:|---:|
| Nein | - |  3876|
|Nein| + | 47|
|Ja| - | 12|
|Ja| + |  131|

a) Erstellen Sie ein Datenframe mit den Variablen `Schwanger`, `Testergebnis` und `Häufigkeit`.
b) Erstellen Sie den Wahrscheinlichkeitsraum.
c) Berechnen Sie die Prävalenz der Schwangerschaften.
d) Wie groß ist die Wahrscheinlichkeit, ein positives Testergebnis zu ziehen?
e) Bestimmen Sie die Sensitivität des Tests
f) Bestimmen Sie die Spezifität des Tests
g) Bestimmen Sie den positiv prädiktiven Wert des Tests
h) Bestimmen Sie den negativ prädiktiven Wert des Tests
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE05
:::
\smallskip\ 



### Aufgabe [-@sec-E06] Glückspielwahrscheinlichkeiten {#sec-E06}
::: {.callout-note appearance="simple" icon=false}
Erstelle den Ereignisraum des Zufallsexperiments, das aus dem Werfen einer Münze, dem Werfen eines Würfels und dem Ziehen einer Karte aus einem spanischen Kartenspiel besteht.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE06
:::
\smallskip\ 



### Aufgabe [-@sec-E07] Grippeimpfung {#sec-E07}
::: {.callout-note appearance="simple" icon=false}
Die Wirksamkeit eines Grippeimpfstoffs wurde an 1.000 Probanden erprobt. 

| Impfung | Grippe |  Häufigkeit |
|:---:|:---:|---:|
| Nein | Nein |  418|
|Nein| Ja | 312|
|Ja| Nein | 233|
|Ja| Ja |  37|

a) Erzeugen Sie den Wahrscheinlichkeitsraum 
b) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Person geimpft ist?
c) Wie hoch ist die Prävalenz der Grippe?
d) Wie groß ist die Wahrscheinlichkeit, dass geimpfte Personen an Grippe erkranken? Ist die Impfung effektiv?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE07
:::
\smallskip\ 



### Aufgabe [-@sec-E08] Ebola {#sec-E08}
::: {.callout-note appearance="simple" icon=false}
Um die Wirksamkeit eines Diagnosetests zur Feststellung von Ebola in einem zentralafrikanischen Land zu ermitteln, wurde der Test an vielen Personen durchgeführt. Das Ergebnis des Tests war positiv bei 147 Personen mit Ebola, aber aber auch bei 28 Personen ohne Ebola. Negativ war das Ergebnis des Tests bei 97465 Personen ohne Ebola, aber auch bei 65 Personen mit Ebola.

a) Erzeugen Sie den Wahrscheinlichkeitsraum des Tests.
b) Berechnen Sie die Prävalenz von Ebola in der Bevölkerung.
c) Wie hoch ist die Wahrscheinlichkeit, ein negatives Testergebnis zu erhalten?
d) Berechnen Sie die Sensitivität und Spezifität des Tests.
e) Kann der Test besser Erkrankte erkennen, oder Gesunde?
f) Wenn eine Person einen positiven Test erhält, wie hoch ist dann die Wahrscheinlichkeit, dass er tatsächlich krank ist?
g) Wenn eine Person einen negativen Test erhält, wie hoch ist dann die Wahrscheinlichkeit, dass er tatsächlich gesund ist?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LE08
:::
\smallskip\ 




## Diskrete Wahrscheinlichkeitsverteilungen {#sec-aufgabeDiskretWahrscheinlich}

### Aufgabe [-@sec-F01] Münzwurf {#sec-F01}
::: {.callout-note appearance="simple" icon=false}

Wir haben 10 mal eine Münze geworfen, wobei das Ergebnis der Binomialverteilung B(10;0.5) folgt. Die Variable `X` misst, wie häufig dabei "`Kopf`" geworfen wurde.  

a) Berechnen Sie die Wahrscheinlichkeitsverteilung von `X`
b) Plotten Sie die Wahrscheinlichkeitsfunktion von `X` 
c) Plotten Sie die Verteilungsfunktion.
d) Berechnen Sie die Wahrscheinlichkeit, 7 mal `Kopf` zu werfen.
e) Berchnen Sie die Wahrscheinlichkeit, weniger als als 4 mal `Kopf` zu werfen.
f) Berchnen Sie die Wahrscheinlichkeit, mehr als als 5 mal `Kopf` zu werfen.
g) Berechnen Sie die Wahrscheinlichkeit, 2 bis 8 mal `Kopf` zu werfen.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF01
:::





### Aufgabe [-@sec-F02] Geburten pro Tag{#sec-F02}
::: {.callout-note appearance="simple" icon=false}
Die Anzahl an täglichen Geburten `X` in unserer Stadt folgt einer Poissonverteilung mit durchschnittlich 6 Geburten am Tag.

a) Plotten Sie die Wahrscheinlichkeitsfunktion von `X`
b) Plotten Sie die Verteilungsfunktion von `X`
c) Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag (nur) 1 Geburt stattfindet? 
d) Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag weniger als 6 Geburten stattfinden? 
e)  Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag  4 oder mehr Geburten stattfinden?
f)  Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag  4 bis 8 Geburten stattfinden?
g)  Wie groß ist die Wahrscheinlicheit, dass in einer Woche zwischen 30 und 40 Geburten stattfinden?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF02
:::
\smallskip\ 





### Aufgabe [-@sec-F03] Gesetz der seltenen Ereignisse {#sec-F03}
::: {.callout-note appearance="simple" icon=false}
Kommen wir nochmal auf das Münzwurfbeispiel aus @sec-F01 zurück.

Das Gesetz der seltenen Ereignisse besagt, dass das Binomial-Verteilungsmodell $B(n,p)$ zum Poisson-Wahrscheinlichkeitsverteilungsmodell $P(np)$ tendiert, wenn $n$ gegen $\infty$ und $p$ gegen $0$ tendiert. Insbesondere ist das Poisson-Modell eine gute Annäherung an das Binomialmodell für $n \geq 30$ und $p \leq 0,1$. 

Zur Überprüfung dieses Gesetz,

a) berechnen Sie die Wahrscheinlichkeitsverteilung des binomialen Modells $B(30, 0.1)$.
b) berechnen Sie die Wahrscheinlichkeitsverteilung des Poissonmodells $P(3)$ und vergleichen Sie es mit dem binomialen Modell $B(30, 0.1)$.
c) berechnen Sie die Wahrscheinlichkeitsverteilung des binomialen Modells $B(100, 0.3)$ und vergleichen Sie es es mit dem Modell $P(3)$. Sind diese Modelle ähnlicher als die vorherigen?
d) Plotten Sie die Wahrscheinlichkeitsfunktionen der vorherigen Modelle. Erhöhen Sie die Anzahl der Wiederholungen und verringern Sie die Erfolgswahrscheinlichkeit im Binomialmodell und beobachten Sie, wie sich die Wahrscheinlichkeiten des Binomialmodells und des Poissonmodells annähern.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF03
:::

### Aufgabe [-@sec-F04] Münzwürfe (II) {#sec-F04}
::: {.callout-note appearance="simple" icon=false}
Wie groß ist die Wahrscheinlichkeit, beim Werfen von 100 Münzen zwischen 40 und 60 Mal `Kopf` zu erhalten (beide Werte eingeschlossen)?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF04
:::



### Aufgabe [-@sec-F05] Behandlungserfolg {#sec-F05}
::: {.callout-note appearance="simple" icon=false}
Die Wahrscheinlichkeit, dass eine Behandlung Erfolg hat, liegt bei 85\%. Wenn wir an 6 Personen die Behandlung durchführen,

a) wie groß ist die Wahrscheinlichkeit, dass die Hälfte der Patienten geheilt wird?
b) wie groß ist die Wahrscheinlichkeit, dass mindestens 4 Patienten geheilt werden?
c) plotten Sie die Wahrscheinlichkeitsfunktion für die Anzahl geheilter Patienten.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF05
:::
\smallskip\ 


### Aufgabe [-@sec-F06] Impfreaktion {#sec-F06}
::: {.callout-note appearance="simple" icon=false}
Die Wahrscheinlichkeit einer starken Impfreaktion beträgt $0,001$. Wenn 2.000 Personen geimpft werden, wie hoch ist die Wahrscheinlichkeit für starke Reaktionen? 
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF06
:::
\smallskip\ 


### Aufgabe [-@sec-F07] Telefonanrufe {#sec-F07}
::: {.callout-note appearance="simple" icon=false}
Die durchschnittliche Anzahl an Telefonanrufen in unserer Telefonzentrale beträgt 120 Anrufe pro Minute.

a) Wie hoch ist die Wahrscheinlichkeit, dass weniger als 4 Anrufe in 2 Sekunden eintreffen?
b) Wie hoch ist die Wahrscheinlichkeit, dass mindestens 3 Anrufe in 3 Sekunden eintreffen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LF07
:::
\smallskip\ 



## Kontinuierliche Wahrscheinlichkeitsverteilungen {#sec-aufgabeKontiWahrscheinlich}

### Aufgabe [-@sec-G01] Bushaltestelle {#sec-G01}
::: {.callout-note appearance="simple" icon=false}

Nehmen wir an, dass ein Bus alle 15 Minuten an einer Haltestelle vorbeifährt und dass eine Person zu jedem Zeitpunkt mit der gleichen Wahrscheinlichkeit eintreffen kann. Dann folgt die Variable, die die Wartezeit auf den Bus misst, einer gleichmäßigen Wahrscheinlichkeitsverteilung $U(0,15)$, da jede Wartezeit zwischen $0$ und $15$ Minuten die gleiche Wahrscheinlichkeit hat.

a) Plotten Sie die Dichtefunktion der Wartezeit.
b) Plotten Sie die Verteilungsfunktion der Wartezeit.
c) Berechnen Sie die Wahrscheinlichkeit, weniger als 5 Minuten auf den Bus zu warten.
d) Berechnen Sie die Wahrscheinlichkeit, länger als 12 Minuten auf den Bus zu warten.
e) Berechnen Sie die Wahrscheinlichkeit, zwischen 5 und 10 Minuten auf den Bus zu warten.
f) Bei welcher Zeit zwischen 0 und 15 Minuten muss die Hälft der Personen kürzer auf den Bus warten als die angegebene Zeit?
g) Bei welcher Zeit zwischen 0 und 15 Minuten müssen 10\% der Personen länger auf den Bus warten als die angegebene Zeit?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG01
:::
\smallskip\ 


### Aufgabe [-@sec-G02] Standardnormalverteilung {#sec-G02}
::: {.callout-note appearance="simple" icon=false}

Eine Variable folgt in ihren Ausprägungen der Standardnormalverteilung ($Z \sim N(0,1)$)

a) Plotten Sie die Dichtefunktion von $Z$.
b) Wie beeinflussen Mittelwert und Standardabweichung die Form der Gausschen Glockenkurve?
c) Plotten Sie die Verteilungsfunktion von $Z$.
d) Berechnen Sie die Wahrscheinlichkeit $P(Z < -1)$.
e) Berechnen Sie die Wahrscheinlichkeit $P(Z > 1)$
f) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus der Standardabweichung und dem Mittelwert plus der Standardabweichung liegt, d. h. $P(-1 \leq Z \leq 1)$.
g) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus zwei Standardabweichungen und dem Mittelwert plus zwei Standardabweichungen liegt, d. h. $P(-2 \leq Z \leq 2)$.
h) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus drei Standardabweichungen und dem Mittelwert plus drei Standardabweichungen liegt, d. h. $P(-3 \leq Z \leq 3)$.
i) Berechnen Sie die Quartile.
j) Bei welchem $Z$-Wert liegen 95\% der Fläche unterhalb des Wertes?
k) Bei welchem $Z$-Wert liegen 2,5\% der Fläche oberhalb des Wertes?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG02
:::
\smallskip\ 


### Aufgabe [-@sec-G03] Chiquadratverteilungen {#sec-G03}
::: {.callout-note appearance="simple" icon=false}

Wenn $X_{1}, \dots, X_{n}$ unabhängige standardnormalverteilte Werte sind, dann folgt die Variable $X = X_{1}^{2} + \dots + X_{n}^{2}$ einer Chiquadratverteilung mit $n$ Freiheitsgraden ($\chi^2(n)$). Nehmen wir nun an, X würde der Chiquadratverteilung mit $6$ Freiheitsgraden folgen ($\chi^2(6)$).

a) Plotten Sie die Dichtefunktion dieser Verteilung
b) Wie groß ist die Wahrscheinlichkeit für $P(X<6)$?
c) Berechnen Sie das fünfte Perzentil der Verteilung.
d) Bei welchem Wert liegen 10\% der Fläche oberhalb des Wertes?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG03
:::
\smallskip\ 



### Aufgabe [-@sec-G04] t-Verteilung {#sec-G04}
::: {.callout-note appearance="simple" icon=false}

Wenn $Y$ einer Chiquadratverteilung mit $n$ Freiheitsgraden folgt ($\chi^2(n)$) und $Z$ der Standardnormalverteilung ($N(0,1)$), dann folgt die Variable $X = \frac{Z}{\sqrt{Y/n}}$ einer Student-t-Verteilung mit 8 Freiheitsgraden ($T(8)$).

a) Plotten Sie die Dichtefunktion von $X$ und vergleichen Sie diese mit der Dichtefunktion der Standardnormalverteilung.
b) Berechnen Sie das 8te Perzentil von $X$.
c) Bei welchem Wert von $X$ liegen 5\% aller Fälle oberhalb dieses Wertes?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG04
:::
\smallskip\ 


### Aufgabe [-@sec-G05] Fishers F-Verteilung {#sec-G05}
::: {.callout-note appearance="simple" icon=false}

Wenn $Y_{1}$ und  $Y_{2}$ zwei unabhängige Variablen aus den Chiquadratverteilungen mit $n$ und $m$ Freiheitsgraden stammen, dann folgt die Variable $X = \frac{Y_{1}/n}{Y_{2}/m}$ einer Fisher-F-Verteilung mit $n$ und $m$ Freiheitsgraden ($F(n,m)$). 
Nehmen wir an, $X$ folge einer Fisher-F-Verteilung mit 10 und 20 Freiheitsgeraden ($F(10,20)$).

a) Plotten Sie die Dichtefunktion von $X$.
b) Berechnen Sie Wahrscheinlichkeit $P(X>1)$.
c) Berechnen Sie den Interquartilsabstand.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG05
:::
\smallskip\ 


### Aufgabe [-@sec-G06] Blutzuckerspiegel {#sec-G06}
::: {.callout-note appearance="simple" icon=false}

Es ist bekannt, dass der Glukosespiegel im Blut von Diabetikern einem Normalverteilungsmodell  mit einem Mittelwert von 106 mg/100 ml und einer Standardabweichung von 8 mg/100 ml folgt.

a) Berechnen Sie die Wahrscheinlichkeit, dass ein zufällig ausgewählter Diabetiker einen Glukosespiegel von weniger als 120 mg/100 ml hat.
b) Wie viel Prozent der Personen haben einen Glukosespiegel zwischen 90 und 120 mg/100 ml?
c) Berechnen und interpretieren Sie das erste Quartil des Glukosespiegels.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG06
:::
\smallskip\ 

### Aufgabe [-@sec-G07] Cholesterinspiegel bei Männern {#sec-G07}
::: {.callout-note appearance="simple" icon=false}

Es ist bekannt, dass der Cholesterinspiegel bei Männern im Alter von 30 Jahren einer Normalverteilung folgt mit Mittelwert 220 mg/dl und einer Standardabweichung von 30 mg/dl. In einer bestimmten Population gibt es 20.000 Männer im Alter von 30 Jahren.

a) Wie viele von ihnen haben einen Cholesterinspiegel zwischen 210 und 240 mg/dl?
b) Wenn ein Cholesterinspiegel von mehr als 250 mg/dl eine Thrombose auslösen kann, wie viele von ihnen sind thrombosegefährdet?
c) Welcher Cholesterinwert wird von mindestens 20% der Männer erreicht?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LG07
:::
\smallskip\ 



## Konfidenzintervalle (eine Stichprobe) {#sec-aufgabeKonfidenzintervalle}

### Aufgabe [-@sec-H01] Wirkstoffkonzentration {#sec-H01}
::: {.callout-note appearance="simple" icon=false}
Die Wirkstoffkonzentration einer Zufallsstichprobe von 10 Arzneimittelbehältern aus einer Charge beträgt (in mg/mm$^{3}$ )


$$
17.6\quad 19.2\quad 21.3\quad 15.1\quad 17.6\quad 18.9\quad 16.2\quad 18.3\quad 19.0\quad 16.4
$$

a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Konzentration`.
b) Berechnen Sie das Konfidenzintervall für die mittlere Konzentration bei einem Konfidenzniveau von 95\% (Signifikanzlevel $\alpha = 0,05$).
c) Berechnen Sie das Konfidenzintervall für die mittlere Konzentration bei einem Konfidenzniveau von 99\% (Signifikanzlevel $\alpha = 0,01$).
d) Wenn wir die Genauigkeit des Intervalls als den Kehrwert seiner Breite definieren, wie ändert sich die Genauigkeit eines Intervalls, wenn wir das Konfidenzniveau erhöhen? Warum?
e) Welche Stichprobengröße wird benötigt, um den mittleren Konzentrationswert mit einem Fehler von $\pm 0.5$mg/mm$^{3}$ und einem Konfidenzniveau von 95\% Sicherheit zu bestimmen?
f) Wenn die Konzentration des Wirkstoffs mindestens 16 mg/mm$^{3}$ betragen muss, um wirksam zu sein, ist dann unsere Medikamentencharge wirksam?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH01
:::
\smallskip\ 


### Aufgabe [-@sec-H02] Milchfett {#sec-H02}
::: {.callout-note appearance="simple" icon=false}
Ein Molkereibetrieb erhält Milch von zwei Bauernhöfen X und Y. Um die Qualität der Milch zu analysieren, wird das Milchfett für zwei Milchproben, eine von jedem Betrieb, gemessen. Die Ergebnisse sind in der nachstehenden Tabelle aufgeführt.

$$
\begin{array}{ll|ll}
\multicolumn{2}{c|}{X} & \multicolumn{2}{c}{Y} \\
\hline
0.34 & 0.34 & 0.28 & 0.29 \\
0.32 & 0.35 & 0.30 & 0.32 \\
0.33 & 0.33 & 0.32 & 0.31 \\
0.32 & 0.32 & 0.29 & 0.29 \\
0.33 & 0.30 & 0.31 & 0.32 \\
0.31 & 0.32 & 0.29 & 0.31 \\
 &  & 0.33 & 0.32 \\
 &  & 0.32 & 0.33 \\
\end{array}
$$


a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Hof1` und `Hof2`.
b) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt.
c) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt, getrennt nach Höfen.
d) Plotten Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt, getrennt nach Höfen.
e) Lässt sich aus den Konfidenzintervallen ein signifikanter Untschied zwischen den Höfen feststellen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH02
:::
\smallskip\ 


### Aufgabe [-@sec-H03] Bibliotheksnutzung {#sec-H03}
::: {.callout-note appearance="simple" icon=false}
In einer von einer Universität durchgeführten Umfrage über die Nutzung der Bibliothek wurde eine Stichprobe von 34 Studierenden gefragt, ob sie mindestens einmal pro Woche in die Bibliothek gehen.

> nein  ja  nein  nein  nein  ja  nein  ja  ja  ja  ja  nein  ja  nein ja  nein  nein nein  ja  ja  ja  nein  nein  ja  nein  nein  ja  ja  nein  nein  ja  nein  ja nein

a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Antwort`.
b) Berechnen Sie das Konfidenzintervall für den Anteil an Studierenden, welche die Bibliothek wöchentlich nutzen mit einem Signifikanzlevel von $\alpha=0,01$.
c) Wie präzise ist das Intervall?
d) Welcher Stichprobenumfang ist erforderlich, um eine Schätzung des Anteils der Studierenden zu erhalten, die die Bibliothek mindestens einmal pro Woche nutzen, mit einem Fehler von $\pm1$\% und einem Konfidenzniveau von 95\%?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH03
:::
\smallskip\ 


### Aufgabe [-@sec-H04] Atemwegsprobleme und Impfung {#sec-H04}
::: {.callout-note appearance="simple" icon=false}
Das Gesundheitsministerium möchte ein Konfidenzintervall für den Anteil der Personen über 65 Jahre mit Atemwegsproblemen berechnen, die geimpft worden sind. In einer Zufallsstichprobe von 200 Personen über 65 mit Atemwegsproblemen wurden 154 geimpft.

a) Berechnen Sie das 95\%-Konfidenzintervall für den Anteil an geimpften Probanden in der Grundgesamtheit.
b) Wenn das Gesundheitsministerium das Ziel verfolgt, dass mindestens 70\% der Menschen über 65 mit Atemwegserkrankungen geimpft sind, können wir dann sagen, dass das Ministerium das Ziel erreicht hat?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH04
:::
\smallskip\ 

### Aufgabe [-@sec-H05] Cholesterin {#sec-H05}
::: {.callout-note appearance="simple" icon=false}

Der Cholesterinspiegel (in mg/dl) in einer Zufallsstichprobe mit 8 Probanden beträgt

> 196 212  188  206  203  210  201  198


a) Berechnen Sie die Konfidenzintervalle für den Mittelwert mit den Signifikanzniveaus $0.1$, $0.05$ und $0.01$. 
B) Kann man schließen, dass der Mittelwert des Cholesterinspiegels der Bevölkerung unter 210 mg/dl liegt?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH05
:::
\smallskip\ 




### Aufgabe [-@sec-H06] Neurologisches Syndrom {#sec-H06}
::: {.callout-note appearance="simple" icon=false}

Zur Behandlung eines neurologischen Syndroms gibt es zwei Therapien, $A$ und $B$. In einer Studie wurde eine Stichprobe von 60 Personen gezogen. Bei 25 von ihnen wurde Therapie $A$ angewandt, bei den anderen 35 Therapie $B$. Insgesmant $18$ der mit $A$ behandelten Personen wurden geheilt, während $21$ der mit $B$ behandelten Personen geheilt wurden. 

a) Berechnen Sie für jede Therapie das 95\% Konfidenzintervall für den Anteil an Personen, die geheilt wurden. 
b) Welches Intervall ist präziser?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH06
:::
\smallskip\ 



### Aufgabe [-@sec-H07] Neugeborene {#sec-H07}
::: {.callout-note appearance="simple" icon=false}

Der Datensatz `neonates` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/neonates.RData>] enthält Informationen über eine Stichprobe von 320 Neugeborenen, die im Laufe eines Jahres nach normaler Schwangerschaftsdauer geboren wurden.


a) Berechnen Sie das 99\% Konfidenzintervall für den Mittelwert des Gewichts der Neugeborenen.
b) Berechnen Sie die Konfidenzintervalle für den APGAR-Score nach 1 Minute und für den APGAR-Score nach 5 Minuten und vergleiche sie beide Intervalle. Gibt es auf Grundlage der Konfidenzintervalle einen signifikanten Unterschied zwischen den Mittelwerten der beiden Scores?
c) Berechnen Sie die Konfidenzintervalle für den Prozentsatz der Neugeborenen mit einem Gewicht von $\leq 2,5$ kg für Raucher- und Nichtrauchermütter und vergleichen Sie die Intervalle.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LH07
:::
\smallskip\ 



## Konfidenzintervalle (zwei Stichproben) {#sec-aufgabeKonfidenzintervalle2}

### Aufgabe [-@sec-I01] Medikamentenwerbung {#sec-I01}
::: {.callout-note appearance="simple" icon=false}
Um festzustellen, ob eine Werbekampagne den Absatz eines Arzneimittels erhöht hat, wurde eine Stichprobe von 8 Apotheken aus einer Stadt gezogen. In jeder Apotheke wurden die monatlichen Verkäufe des Arzneimittels vor und nach der Kampagne in der folgenden Tabelle erfasst.

| Vorher |  147| 163| 121| 205| 132| 190| 176| 147|
|---|---|---|---|---|---|---|---|---|
| Nachher |  150| 171| 132| 208| 141| 184| 182| 145|

a) Erstellen Sie ein Datenframe mit den Variablen `vorher` und `nachher` und übertragen Sie die Daten.
b) Berechnen Sie den Mittelwert der monatlichen Umsätze vor und nach der Kampagne. Sind die Mittelwerte unterschiedlich? Hat die Kampagne den Absatz des Arzneimittels erhöht?
c) Berechnen Sie die Konfidenzintervalle für den durchschnittlichen Unterschied mit $\alpha = 0,05$ und $\alpha = 0,01$.
d) Können wir dieselbe Schlussfolgerung ziehen, wenn wir die Verkäufe nach der Kampagne der beiden letzten Apotheken ändern und $190$ statt $182$ und $165$ statt $145$ angeben? Was passiert mit den Konfidenzintervallen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI01
:::
\smallskip\ 


### Aufgabe [-@sec-I02] Milchfett {#sec-I02}
::: {.callout-note appearance="simple" icon=false}
Ein Molkereibetrieb erhält Milch von zwei Bauernhöfen X und Y. Um die Qualität der Milch zu analysieren, wird das Milchfett für zwei Milchproben, eine von jedem Betrieb, gemessen. Die Ergebnisse sind in der nachstehenden Tabelle aufgeführt.


$$
\begin{array}{ll|ll}
\multicolumn{2}{c|}{X} & \multicolumn{2}{c}{Y} \\
\hline
0.34 & 0.34 & 0.28 & 0.29 \\
0.32 & 0.35 & 0.30 & 0.32 \\
0.33 & 0.33 & 0.32 & 0.31 \\
0.32 & 0.32 & 0.29 & 0.29 \\
0.33 & 0.30 & 0.31 & 0.32 \\
0.31 & 0.32 & 0.29 & 0.31 \\
 &  & 0.33 & 0.32 \\
 &  & 0.32 & 0.33 \\
\end{array}
$$



a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Hof1` und `Hof2`.
b) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettunterschied in der Milch von `Hof1` und `Hof2`.
c) Kann man daraus schließen, dass der Unterschied zwischen den Milchfettmittelwerten der Betriebe signifikant ist? Welcher Betrieb hat Milch mit mehr Fett? Wie viel mehr Fett hat die Milch von `Hof1` als die Milch von `Hof2`?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI02
:::
\smallskip\ 



### Aufgabe [-@sec-I03] Bibliotheksnutzung nach Geschlecht {#sec-I03}
::: {.callout-note appearance="simple" icon=false}
In einer von einer Universität durchgeführten Umfrage über die Nutzung der Bibliothek wurde eine Stichprobe von 34 Studierenden gefragt, ob sie mindestens einmal pro Woche in die Bibliothek gehen.

|Antwort    | nein | ja | nein | nein | nein | ja | nein | ja | ja | ja | ja | nein |
|---------|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|Geschlecht | m    | w  |  w   | m    |  m   |  m |  w   |  w |  w |  w | m  | m    |


|Antwort    | nein | ja |  nein|nein  | nein |ja  | ja   | ja | nein |  nein |  ja   |nein | 
|---------|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|Geschlecht | m    | w  |  m   | m    | w    | m  | w    | w  |  w   | m     | w     | m   |  


|Antwort    | ja |  ja |  nein |  nein |  ja  | nein |  ja | nein | ja |   nein |
|---------|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|Geschlecht | w  |  w  |  m    |   m   |  w | w | w | m | w  |  m   |



a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Antwort` und `Geschlecht`.
b) Berechnen Sie das Konfidenzintervall für den Unterschied zwischen den Anteilen der Frauen und Männern, die die Bibliothek mindestens einmal pro Woche nutzen.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI03
:::
\smallskip\ 


### Aufgabe [-@sec-I04] Prüfungen vormittags und nachmittags {#sec-I04}
::: {.callout-note appearance="simple" icon=false}
In einem Kurs gibt es zwei Gruppen von Studierenden, eine am Vormittag und die andere am Nachmittag. In der Vormittagsgruppe haben 55 von 80 Studierenden bestanden, während in der Nachmittagsgruppe 32 von 90 Studierenden bestanden haben.

a) Gibt es signifikante Unterschiede zwischen den Prozentsätzen der Studierenden, die am Vormittag und am Nachmittag bestanden haben? Kann man daraus schließen, dass der Stundenplan die Ursache für diese Unterschiede ist? 

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI04
:::
\smallskip\ 



### Aufgabe [-@sec-I05] Cholesterin und Sport {#sec-I05}
::: {.callout-note appearance="simple" icon=false}
In einer Studie zur Ermittlung des Zusammenhangs zwischen körperlicher Betätigung und dem Cholesterinspiegel im Blut wurde eine wurde eine Stichprobe von 11 Personen gezogen. Der Cholesterinspiegel der Teilnehmer (in mg/dl) vor und nach der Teilnahme an einem Programm mit körperlichen Übungen ist unten dargestellt.

| vorher |  182 | 232|191| 200| 148| 249| 276| 213| 241| 280| 262|
|---|---|---|---|---|---|---|---|---|---|---|---|
| nachher|  198 | 210| 194| 220| 138| 220| 219| 161| 210| 213| 226|

a) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Unterschied der Cholesterinwerte vor und nach den körperlichen Übungen
b) Berechnen Sie das 99\%-Konfidenzintervall für den durchschnittlichen Unterschied der Cholesterinwerte vor und nach den körperlichen Übungen
c) Auf Grundlage der zuvor berechneten Intervalle, welchen Schluss bezüglich des Einflusses von körperlichen Aktivitäten auf den Cholesterinspiegel können Sie ziehen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI05
:::
\smallskip\ 



### Aufgabe [-@sec-I06] Patientenzufriedenheit {#sec-I06}
::: {.callout-note appearance="simple" icon=false}

Insgesamt 500 Patienten aus zwei Krankenhäusern wurden zu ihrer Zufriedenheitbefragt.
In Krankenhaus 1 wurden 200 Patienten befragt, von denen 140 zufrieden waren. In Krankenhaus 2 wurden 300 Patienten befragt, von denen 180 zufrieden waren.

a) Berechnen Sie das 95\%-Konfidenzintervall für den Anteilsunterschied an zufriedenen Patienten in beiden Häusern.
b) Wenn $\alpha = 0,01$ ist, können dann Rückschlüsse gezogen werden, ob der Unterschied der Anteile zufriedener Patienten signifikant ist?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI06
:::
\smallskip\ 



### Aufgabe [-@sec-I07] Neugeborene {#sec-I07}
::: {.callout-note appearance="simple" icon=false}

Der Datensatz `neonates` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/neonates.RData>] enthält Informationen über eine Stichprobe von 320 Neugeborenen, die im Laufe eines Jahres nach normaler Schwangerschaftsdauer geboren wurden.


a) Berechnen Sie das 95\%-Konfidenzintervall für den durchscnnittlichen Unterschied des Geburtsgewichts zwischen Kindern von Raucherinnen und Nichtraucherinnen. Wie groß ist der durchschnittliche Gewichtsunterschied?
b) Berücksichtigen Sie nur die Daten der Mütter, die *während* der Schwangerschaft nicht geraucht haben. Berechnen Sie das 95\%-Konfidenzintervall für den durchscnnittlichen Unterschied des Geburtsgewichts zwischen Kindern von Müttern, die *vor* der Schwangerschaft geraucht haben, und den Nichtraucherinnen.
c) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Unterschied von APGAR-1-Werten und APGAR-5-Werten. Wie entwickeln sich Neugeborene in den ersten 5 Minuten nach der Geburt?
d) Wenn Neugeborene mit einem APGAR-1-Wert $\leq3$ in einem kritischen Zustand sind, berechnen Sie das 90\%-Konfidenzintervall für den Unterschied der Anteile von Neugeborenen in kritischem Zustand zwischen Müttern, die *während* der Schwangerschaft geraucht haben und den Nichtraucherinnen.
e) Hat das Alter der Mutter einen signifikanten Einfluss auf den Anteil an Neugeborenen in kritischem Zustand?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LI07
:::
\smallskip\ 


## Signifikanztests {#sec-aufgabeSignifikanztests}

### Aufgabe [-@sec-J01] Wirkstoffkonzentration {#sec-J01}
::: {.callout-note appearance="simple" icon=false}
Die Wirkstoffkonzentration einer Zufallsstichprobe von 10 Arzneimittelbehältern aus einer Charge beträgt (in mg/mm$^{3}$ )


$$
17.6\quad 19.2\quad 21.3\quad 15.1\quad 17.6\quad 18.9\quad 16.2\quad 18.3\quad 19.0\quad 16.4
$$


a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Konzentration`.
b) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 18$ versus $H_{1}: \mu \neq 18$ mit einem Signifikanzniveau von $\alpha=0,05$.
c) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 19,5$ versus $H_{1}: \mu \neq 19,5$ mit den Signifikanzniveaus von $\alpha=0,05$ und $0,01$. Wie beeinflusst das Signifikanzniveau das Testergebnis?
d) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 17$ versus $H_{1}: \mu \neq 17$ mit einem Signifikanzniveau von $\alpha=0,05$. Testen Sie ebenfalls die Hypothesen $H_{0}: \mu = 17$ versus $H_{1}: \mu > 17$ mit $\alpha=0,05$. Was ist der Unterschied zwischen den $p$-Werten des zweiseitigen und des einseitigen Tests?
e) Wenn der Hersteller angibt, die Konzentration des Wirkstoffs erhöht zu haben (im Vergleich zu früheren Chargen, bei denen der Mittelwert der Konzentration 17 mg/mm$^{3}$ war), können wir ihm glauben?
f) Welche Fallzahl würde benötigt, um einen Konzentrationsanstieg von 0,5 mg/mm$^{3}$ zu erkennen (mit $\alpha=0,05$ und einer Power von $1-\beta=0,8$)?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ01
:::
\smallskip\ 


### Aufgabe [-@sec-J02] Bibliotheksnutzung {#sec-J02}
::: {.callout-note appearance="simple" icon=false}
In einer von einer Universität durchgeführten Umfrage über die Nutzung der Bibliothek wurde eine Stichprobe von 34 Studierenden gefragt, ob sie mindestens einmal pro Woche in die Bibliothek gehen.

> nein  ja  nein  nein  nein  ja  nein  ja  ja  ja  ja  nein  ja  nein ja  nein  nein nein  ja  ja  ja  nein  nein  ja  nein  nein  ja  ja  nein  nein  ja  nein  ja nein

a) Übertragen Sie die Daten in ein Datenframe mit der Variable `bib`.
b) Testen Sie die Hypothese, dass der Anteil an Studierenden, die wöchentlich die Bibliothek nutzen, größer als 40% ist.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ02
:::
\smallskip\ 


### Aufgabe [-@sec-J03] Laufen lernen {#sec-J03}
::: {.callout-note appearance="simple" icon=false}

Eine Studie möchte untersuchen, ob Babies aus den unterschiedlichen Populationen $A$ und $B$ zu unterschiedlichen Zeiten anfangen zu laufen. In folgender Tabelle ist das Alter der Babies in Monaten aufgeführt, zu welchem sie mit dem Laufen anfingen.


\begin{center}
\begin{tabular}{lrrrrrrrrrrrr}
\toprule
A & 9.5 & 10.5 & 9.0 & 9.8 & 10.0 & 13.0 & 10.0 & 13.5 & 10.0 & 9.8\\
B & 12.5 & 9.5 & 13.5 & 13.8 & 12.0 & 13.8 & 12.5 & 9.5 & 12.0 & 13.5 & 12.0 & 12.0\\
\bottomrule
\end{tabular}
\end{center}


a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Alter` und `Population`.
b) Testen Sie die Hypothese, dass das durchschnittliche Alter in den Populationen unterschiedlich ist, mit $\alpha = 0,05$.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ03
:::
\smallskip\ 

### Aufgabe [-@sec-J04] Bronchialretention {#sec-J04}
::: {.callout-note appearance="simple" icon=false}
Forschende haben bei Rauchern einen größeren Atemwegswiderstand festgestellt als bei Nichtrauchern. Zur Überprüfung wurde bei 12 Probanden der Prozentsatz der tracheobronchialen Retention gemessen als sie Raucher waren und ein Jahr nach dem Rauchstopp. 


| Rauchen | Nichrauchen |
|:---:|:---:|
|60.6 | 47.5 |
|12.0 | 13.3 |
|56.0 | 33.0 |
|75.2 | 55.2 |
|12.5 | 21.9 |
|29.7 | 27.9 |
|57.2 | 54.3 |
|62.7 | 13.9 |
|28.7 | 8.90 |
|66.0 | 46.1 |
|25.2 | 29.8 |
|40.1 | 36.2 |

a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `vorher` und `nachher`.
b) Testen Sie, ob sich die Bronchialretention nach dem Rauchstopp verringert.
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ04
:::
\smallskip\ 

### Aufgabe [-@sec-J05] Prüfungen vormittags und nachmittags {#sec-J05}
::: {.callout-note appearance="simple" icon=false}
In einem Kurs gibt es zwei Gruppen von Studierenden, eine am Vormittag und die andere am Nachmittag. Unter der Vormittagsgruppe haben 55 von 80 Studierenden bestanden, während in der Nachmittagsgruppe 32 von 90 Studierenden bestanden haben.

a) Gibt es signifikante Unterschiede zwischen den Prozentsätzen der Studiereden, die am Vormittag und am Nachmittag bestanden haben? Kann man daraus schließen, dass der Stundenplan die Ursache für diese Unterschiede ist? 

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ05
:::
\smallskip\ 



### Aufgabe [-@sec-J06] Pulsmessung {#sec-J06}
::: {.callout-note appearance="simple" icon=false}
Der Datensatz `pulse` von rk.Teaching^[<https://github.com/rkward-community/rk.Teaching>, auch verfügbar unter\newline <https://www.produnis.de/R/data/pulse.RData>] enthält Informationen über den Puls einer Stichprobe von Personen nach verschiedenen Übungen:    

- Ruhepuls in Schlägen pro Minute (`pulse1`), 
- Puls nach Bewegung in Schlägen pro Minute (`pulse2`), 
- Art der Bewegung (`type`), 
- Geschlecht (`sex`) und Gewicht (`weight`)

a) Testen Sie, ob der Ruhepuls weniger als 75 Schläge pro Minute beträgt.
b) Welcher Stichprobenumfang ist erforderlich, um einen Anstieg des Ruhepulses um 2 Schläge pro Minute mit einem Signifikanzniveau von 0,05 und einer Power von 0,9 festzustellen? 
c) Testen Sie, ob der Puls nach dem Laufen größer als 85 Schläge pro Minute ist.
d) Eine Person hat eine leichte Tachykardie, wenn der Ruhepuls größer als 90 Schläge pro Minute ist. Prüfen Sie, ob der Prozentsatz der Personen mit leichter Tachykardie größer als 5\% ist.
e) Kann man mit 95\%iger Sicherheit schließen, dass Bewegung den Puls erhöht? Und bei einem Signifikanzniveau von $\alpha =0,01$? 
f) Gibt es einen Unterschied zwischen den durchschnittlichen Pulsschlägen nach dem Gehen und dem Laufen?
g) Gibt es einen Unterschied zwischen den Mittelwerten des Ruhepulses von Männern und Frauen? Und nach dem Laufen? 

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LJ06
:::

\newpage




## Varianzanalysen (ANOVA) {#sec-aufgabeANOVA}

### Aufgabe [-@sec-K01] Aknetherapie {#sec-K01}
::: {.callout-note appearance="simple" icon=false}
In einer Studie wird versucht, die Wirksamkeit von drei Therapieprogrammen $A$, $B$ und $C$ zur Behandlung von von Akne zu bestimmen. Die Teilnehmer der Studie wurden nach dem Zufallsprinzip in drei Gruppen eingeteilt, und in jeder Gruppe wurde eine der Behandlungen durchgeführt. Nach 16 Wochen Behandlung wurde der prozentuale Rückgang der Akneläsionen gemessen.

\begin{center}
\begin{tabular}{rr|rr|rr}
\multicolumn{6}{c}{Reduction in percentage of lesions} \\
\toprule
\multicolumn{2}{c|}{Treatment $A$} & \multicolumn{2}{c|}{Treatment $B$} & \multicolumn{2}{c}{Treatment $C$} \\
48.6 & 50.8 & 68.0 & 71.9 & 67.5 & 61.4 \\
49.4 & 47.1 & 67.0 & 71.5 & 62.5 & 67.4 \\
50.1 & 52.5 & 70.1 & 69.9 & 64.2 & 65.4 \\
49.8 & 49.0 & 64.5 & 68.9 & 62.5 & 63.2 \\
50.6 & 46.7 & 68.0 & 67.8 & 63.9 & 61.2 \\
     &      & 68.3 & 68.9 & 64.8 & 60.5 \\
     &      &      &      & 62.3 &      \\
\bottomrule
\end{tabular}
\end{center}
    
a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Therapie` und `Aknereduktion`.
b) Plotten Sie die Aknereduktion für jede Therapie. Sind Unterschiede erkennbar?
c) Führen Sie eine ANOVA durch. Gibt es signifikante Unterschiede zwischen den Therapien?
d) Berechnen Sie die Konfidenzintervalle für die paarweisen Unterschiede zwischen den drei Behandlungen. Bei welchen Behandlungen gibt es signifikante Unterschiede?
e) Plotten Sie diese Konfidenzintervalle.

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LK01
:::
\smallskip\ 


### Aufgabe [-@sec-K02] Schulranking {#sec-K02}
::: {.callout-note appearance="simple" icon=false}
Um zu prüfen, ob es zwischen den Schulen einer Stadt Unterschiede in den sportlichen Leistungen gibt, wurde eine Zufallsstichprobe von 8 Schülern jeder Schule gezogen. Die erreichten Punkte bei einem Sportwettkampf (von 1 bis 10) der jeweiligen Schüler sind in der folgenden Tabelle dargestellt.

|$A$ | $B$ | $C$ | $D$ | $E$ |
|---|---|---|---|---|
|5.5 | 6.1 | 4.9 | 3.2 | 6.7 |
|5.2 | 7.2 | 5.5 | 3.3 | 5.8 |
|5.9 | 5.5 | 6.1 | 5.5 | 5.4 |
|7.1 | 6.7 | 6.1 | 5.7 | 5.5 |
|6.2 | 7.6 | 6.2 | 6.0 | 4.9 |
|5.9 | 5.9 | 6.4 | 6.1 | 6.2 |
|5.3 | 8.1 | 6.9 | 4.7 | 6.1 |
|6.2 | 8.3 | 4.5 | 5.1 | 7.0 |
    
a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Schule` und `Punkte`.
b) Plotten Sie die durchschnittlich erreichten Punkte pro Schule. Sind Unterschiede erkennbar?
c) Führen Sie eine ANOVA durch. Gibt es signifikante Unterschiede zwischen den Schulen?
d) In welcher Schule sind die sportlichen Leistungen am besten?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LK02
:::
\smallskip\ 


### Aufgabe [-@sec-K03] Puls und Herzkrankheit {#sec-K03}
::: {.callout-note appearance="simple" icon=false}
Die nachstehende Tabelle zeigt den Puls (in Schlägen pro Minute) von vier Patientengruppen: Kontrollen (`A`), Patienten mit Angina pectoris (`B`), Patienten mit Herzrhythmusstörungen (`C`) und Patienten, die sich von einem Herzinfarkt erholt haben (`D`).

|$A$ | $B$ | $C$ | $D$ |
|---|---|---|---|
|83 | 81 | 75 | 61 |
|61 | 65 | 68 | 75 |
|80 | 77 | 80 | 78 |
|63 | 87 | 80 | 80 |
|67 | 95 | 74 | 68 |
|89 | 89 | 78 | 65 |
|71 | 103 | 69 | 68 |
|73 | 89 | 72 | 69 |
|70 | 78 | 76 | 70 |
|66 | 83 | 75 | 79 |
|57 | 91 | 69 | 61 |

a) Gibt es laut den Daten signifikante Unterschiede zwischen den vier Gruppen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LK03
:::
\smallskip\ 



### Aufgabe [-@sec-K04] Kohlenmonoxid {#sec-K04}
::: {.callout-note appearance="simple" icon=false}
Die folgende Tabelle zeigt die Atemfrequenz (Atemzüge pro Minute) bei einer Stichprobe von Laborratten, die drei Konzentrationen von Kohlenmonoxid ausgesetzt waren.

|Low | Medium | High|
|:---:|:---:|:---:|
|36 | 43 | 45 |
|33 | 38 | 39 |
|35 | 41 | 33 |
|39 | 34 | 39 |
|41 | 28 | 33 |
|41 | 44 | 26 |
|44 | 30 | 39 |
|45 | 31 | 29 |

a) Gibt es laut den Daten signifikante Unterschiede zwischen den drei Gruppen?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LK04
:::
\smallskip\ 






## Chiquadratests für Anteilswerte {#sec-aufgabeAChiquadratAnteile}

### Aufgabe [-@sec-AL01] Magengeschwür {#sec-AL01}
::: {.callout-note appearance="simple" icon=false}
Die folgende Tabelle enthält die Blutgruppe einer Stichprobe von 1655 Patienten mit Magengeschwüren und 10000 Patienten ohne Magengeschwüre Patienten.

|   | 0 | A | B | AB |
|:---|:---:|:---:|:---:|:---:|
| Geschwür | 911 | 579 | 124 | 41 |
| kein Geschwür | 4578 | 4219 | 890 | 313 |

a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Geschwuer` und `Blutgruppe`.
b) Führen Sie einen Chiquadrattest auf die Hypothese durch, dass die Geschwüre von der Blutgruppe abhängig sind.
c)  Gibt es in Anbetracht der Ergebnisse des Vergleichs einen Zusammenhang zwischen dem Magengeschwür und der Blutgruppe? Können wir behaupten, dass der Anteil der Ulkuspatienten je nach Blutgruppe unterschiedlich ist?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL01
:::
\smallskip\ 



### Aufgabe [-@sec-AL02] Blutgruppen {#sec-AL02}
::: {.callout-note appearance="simple" icon=false}
@mitchel76 untersuchten die Verteilung der Blutgruppen in einer Stichprobe von 478 Personen aus verschiedenen Regionen im Südwesten Schottlands. Sie erhielten die folgenden Ergebnisse:

$$
\begin{tabular}{|l|l|l|l|l|}
\cline{2-4}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{Eskdale} & \multicolumn{1}{c|}{Annandale} & \multicolumn{1}{c|}{Nithsdale} & \multicolumn{1}{c}{} \\
\hline
\multicolumn{1}{|c|}{A} & \multicolumn{1}{c|}{33} & \multicolumn{1}{c|}{54} & \multicolumn{1}{c|}{98} & \multicolumn{1}{c|}{185} \\
\hline
\multicolumn{1}{|c|}{B} & \multicolumn{1}{c|}{6} & \multicolumn{1}{c|}{14} & \multicolumn{1}{c|}{35} & \multicolumn{1}{c|}{55} \\
\hline
\multicolumn{1}{|c|}{O} & \multicolumn{1}{c|}{56} & \multicolumn{1}{c|}{52} & \multicolumn{1}{c|}{115} & \multicolumn{1}{c|}{223} \\
\hline
\multicolumn{1}{|c|}{AB} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{5} & \multicolumn{1}{c|}{15} \\
\hline
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{100} & \multicolumn{1}{c|}{125} & \multicolumn{1}{c|}{253} & \multicolumn{1}{c|}{478} \\
\cline{2-5}
\end{tabular}
$$

a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Region` und `Blutgruppe`.
b) Führen Sie einen Chiquadrattest auf die Hypothese durch, dass die Blutgruppe von der Region abhängig sind.
c)  Gibt es in Anbetracht der Ergebnisse einen Zusammenhang zwischen der Blutgruppe und der Region? Können wir behaupten, dass die Region keinen Einfluss auf die Blutgruppe hat?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL02
:::
\smallskip\ 


### Aufgabe [-@sec-AL03] Rauchen und Geschlecht {#sec-AL03}
::: {.callout-note appearance="simple" icon=false}
In einer Studie wurd versucht festzustellen, ob das Rauchen mit dem Geschlecht zusammenhängt. Es wurden 9 Männer und 17 Frauen befragt. Unter den männlichen Probanden gab es 2 Raucher, während in der weiblichen Stichprobe 6 Raucherinnen waren.


a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Rauchen` und `Geschlecht`.
b) Führen Sie einen Chi-Quadrat-Test durch, um festzustellen, ob das Rauchen mit dem Geschlecht zusammenhängt.
c) Ist die Verteilung der Raucher bei beiden Geschlechtern gleich?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL03
:::
\smallskip\ 


### Aufgabe [-@sec-AL04] Migräne {#sec-AL04}
::: {.callout-note appearance="simple" icon=false}

Um die Wirksamkeit von zwei Medikamenten gegen Migräne zu vergleichen, wurden 20 Personen, die häufig unter Migräne litten, ausgewählt und die beiden Medikamente zu verschiedenen Zeitpunkten ausprobiert. Die folgende Tabelle zeigt die Anzahl der Personen, die eine gewisse Linderung erfuhren.

| Drug 1 | Yes | Yes | Yes | Yes | Yes | No  | Yes | No  | Yes | Yes |
|---|---|---|---|---|---|---|---|---|---|---|
| Drug 2 | No  | No  | Yes | No  | Yes | Yes | No  | No  | No  | No  |


| Drug 1 | Yes | No  | Yes | No  | Yes | Yes | Yes | No  | Yes | Yes |
|---|---|---|---|---|---|---|---|---|---|---|
| Drug 2 | Yes | No  | Yes | No  | No  | Yes | No  | Yes | No  | No  |



a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `drug1` und `drug2`.
b) Führen Sie einen McNemar-Test durch, um festzustellen, ob die Linderung mit dem Medikament zusammenhängt.
c) Können wir nach dem Ergebnis des Tests behaupten, dass die Linderung der Migräne vom Medikament abhängt? Wenn ja, welches Medikament bewirkt eine signifikant höhere Linderung?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL04
:::
\smallskip\ 


### Aufgabe [-@sec-AL05] Komatös {#sec-AL05}
::: {.callout-note appearance="simple" icon=false}

Eine Studie versucht zu bestimmen, ob Patienten, die bei der Ankunft im Krankenhaus komatös sind, eine schlechtere Prognose (Überleben oder Sterben) haben.


$$
\begin{tabular}{l|l|l|l|}
\cline{2-3}
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{nicht komatös} & \multicolumn{1}{c|}{komatös} & \multicolumn{1}{c}{} \\
\hline
\multicolumn{1}{|c|}{überleben} & \multicolumn{1}{c|}{484} & \multicolumn{1}{c|}{37} & \multicolumn{1}{c|}{521} \\
\hline
\multicolumn{1}{|c|}{verstorben} & \multicolumn{1}{c|}{118} & \multicolumn{1}{c|}{89} & \multicolumn{1}{c|}{207} \\
\hline
\multicolumn{1}{c|}{} & \multicolumn{1}{c|}{602} & \multicolumn{1}{c|}{126} & \multicolumn{1}{c|}{728} \\
\cline{2-4}
\end{tabular}
$$

a) Ist ein komatöser Zustand bei der Ankunft im Krankenhaus ein Risikofaktor zu versterben?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL05
:::
\smallskip\ 


### Aufgabe [-@sec-AL06] Heilung {#sec-AL06}
::: {.callout-note appearance="simple" icon=false}

Die Heilung einer Krankheit, die durch zwei Behandlungen $A$ und $B$ hervorgerufen wird, wird in drei Kategorien eingeteilt: sehr gut, gut und schlecht. 

Die Behandlung $A$ wird bei 32 Patienten angewandt und $B$ bei 28. Bei Medikament $A$ konnten 10 von insgesamt 22 `sehr guten` Heilungen, 14 von insgesamt 24 `guten` Heilungen  und 8 von insgesamt 14 `schlechten` Heilungen beobachtet werden. Ist die Wirksamkeit der beiden Behandlungen die gleiche?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL06
:::
\smallskip\ 


### Aufgabe [-@sec-AL07] Facherfolg {#sec-AL07}
::: {.callout-note appearance="simple" icon=false}

Um festzustellen, ob Frauen in einem Fach erfolgreicher sind als Männer, wurde eine Stichprobe von 10 Frauen und 10 Männern gezogen. Beide Gruppen wurden von einem Lehrer geprüft, der immer 40\% der Prüflinge durchfallen lässt. Wenn man weiß, dass nur 2 Männer bestanden haben, können wir dann behaupten, dass Frauen in diesem Fach erfolgreicher sind als Männer?
:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL07
:::
\smallskip\ 



### Aufgabe [-@sec-AL08] Statistikdozent {#sec-AL08}
::: {.callout-note appearance="simple" icon=false}

150 Studierende wurden befragt, ob ihnen die Lehrmethoden von zwei Biostatistik-Dozenten (Hans und Erna) gefallen. Die Ergebnisse sind in der nachstehenden Tabelle aufgeführt:

| | like Hans | dislike Hans |
|---|:---:|:---:|
| like Erna | 37 | 48 |
| dislike Erna | 44 | 21 |

Können wir bestätigen, dass es unterschiedliche Meinungen über Hans und Erna gibt?

:::

::: {.callout-tip appearance="simple"}
Für die Lösung siehe @sec-LL08
:::
\smallskip\ 

















\newpage


# Lösungen {#sec-Loesungen}

::: {.callout-caution appearance="simple"}
Die hier vorgestellten Lösungen stellen immer nur *eine mögliche* Vorgehensweisen dar und sind sicherlich nicht der Weisheit letzter Schluss. In `R` führen viele Wege nach Rom, und wenn Sie mit anderem Code zu den richtigen Ergebnissen kommen, dann ist das völlig in Ordnung.

:::


## Lösung zur Aufgabe [-@sec-A01] {#sec-L01}
::: {.callout-tip}
## a)  Erstellen Sie ein Datenframe mit der Variable `Kinder` und übertragen Sie die Daten.
```{r}
#| label: Loesung-1a
# erzeuge Datenframe
df <- data.frame(Kinder = c(1, 2, 4, 2, 2, 2, 3, 2, 1, 1, 0, 2, 2, 0, 
                            2, 2, 1, 2, 2, 3, 1, 2, 2, 1, 2))
```
:::

::: {.callout-tip}
## b) Erzeugen Sie eine einfache Häufigkeitstabelle
```{r}
#| label: Loesung-1b
# erzeuge Datenframe
table(df$Kinder)

# oder
xtabs(~Kinder, data=df)
```
:::

::: {.callout-tip}
## c) Erzeugen Sie ein Balkendiagramm der Häufigkeiten
```{r}
#| label: Loesung-1c
#| layout-ncol: 2
# Balkendiagramm mit R-Base
barplot(table(df$Kinder), col="skyblue", xlab="Anzahl Kinder")

# mit ggplot
ggplot(df, aes(x=Kinder)) +
          geom_bar(fill="skyblue", color="black")
```
:::

::: {.callout-tip}
## d) Erzeugen Sie eine vollständige Häufigkeitstabelle, inklusive absoluter, relativer und jeweils kumulativer Häufigkeiten

```{r}
#| label: Loesung-1d

## zu Fuß
# kumulierte absoulte Häufigkeiten
cumsum(table(df$Kinder))

# relative Häufigkeiten
(table(df$Kinder)/length(df$Kinder))*100

# kumulierterelative Häufigkeiten
cumsum(table(df$Kinder)/length(df$Kinder))*100

## einfacher
# erzeuge vollständige Häufigkeitstabelle
jgsbook::freqTable(df$Kinder)

```


:::

\bigskip


## Lösung zur Aufgabe [-@sec-A02] {#sec-L02}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit der Variable `Patienten` und übertragen Sie die Daten.

```{r}
#| label: Loesung-2a
# erzeuge Datenframe
df <- data.frame(Patienten = c(15, 23, 12, 10, 28, 50, 12, 17, 20, 
                               21, 18, 13, 11, 12, 26, 30,  6, 16,
                               19, 22, 14, 17, 21, 28,  9, 16, 13,
                               11, 16, 20))
```
:::

::: {.callout-tip}
## b) Erzeugen Sie ein Boxplot und entfernen Sie etwaige Ausreißer.

```{r}
#| label: Loesung-2b
#| layout-ncol: 2
# Boxplot mit Rbase
boxplot(df$Patienten, col="seagreen3", ylab="Anzahl Patienten")

# Boxplot mit ggplot
ggplot(df, aes(y=Patienten)) +
    geom_boxplot(fill="seagreen3") +
    # whiskers
    stat_boxplot(geom="errorbar") +
    theme(axis.ticks.x=element_blank(),
          axis.text.x=element_blank())
```
Es ist ein Ausreißer enthalten.
```{r}
#| label: Loesung-2bb
# entferne Ausreißer für weiteres Vorgehen
df <- subset(df, Patienten < 50)
```

:::

\smallskip\  

::: {.callout-tip}
## c) Erzeugen Sie eine Häufigkeitstabelle, welche die Daten in 5 Klassen gruppiert.

```{r}
#| label: Loesung-2c
# klassiere in 5 Gruppen
gruppen <- cut(df$Patienten, breaks = 5, ordered_result = TRUE)
# Häufigkeitstabelle
table(gruppen)
```
:::

::: {.callout-tip}
## d) Erzeugen Sie ein Histogram der klassierten absoluten Häufigkeiten.
```{r}
#| label: Loesung-2d
#| layout-ncol: 3
# Histogram mit Rbase
hist(df$Patienten, col="pink")
# mit ggplot werden andere Breaks erzeugt
ggplot(df, aes(x=Patienten)) +
   geom_histogram(fill="pink", color="black", 
                  bins=5)
# also die Klassengrenzen manuell festlegen
ggplot(df, aes(x=Patienten)) +
   geom_histogram(fill="pink", color="black", 
                  breaks=c(5, 10, 15, 20, 25, 30))
```
:::


::: {.callout-tip}
## e) Erzeugen Sie ebenso Histogramme der relativen und jeweils kumulativen Häufigkeiten, inklusive Polygonzügen.

Mit R base können wir wie folgt vorgehen.
```{r}
#| label: Loesung-2e
#| layout-ncol: 3
# 1. kumulierte absolute Häufigkeiten
#------------------------------------
# speichere Histogramm in Objekt h
h <- hist(df$Patienten, plot=FALSE)

# ersetze die Zellen durch kumulierte Häufigkeiten
h$counts <- cumsum(h$counts)

# plotte das kumulative Histogram
plot(h, col="hotpink", main = "kumulierte Häufigkeiten")
# füge Polygonzug hinzu
lines(c(0, h$mids),c(0,h$counts), col="blue") # type="s"

##----------------------------------------#


# 2. Histogram der relativen Häufigkeiten #
##----------------------------------------#
# speichere Histogramm in Objekt h
h <- hist(df$Patienten, plot=FALSE)

# relative Häufigkeiten
h$counts <- h$counts/sum(h$counts)
### plot
plot(h, col="hotpink", main = "Relative Häufigkeiten",
     ylab = "Relative Häufigkeit" )
# Polygon hinzufügen
lines(h$breaks, c(0, h$counts), col = "blue") # add type="s" if you like


##----------------------------------------------------#


# 3. Histogram der kumulierten relativen Häufigkeiten #
##----------------------------------------------------#
# speichere Histogramm in Objekt h
h <- hist(df$Patienten, plot=FALSE)

# kumulative relative Häufigkeiten
h$counts <- cumsum(h$counts)/sum(h$counts)
### plot
plot(h, col="hotpink", main = "Kumulierte relative Häufigkeiten",
     ylab = "Relative Häufigkeit" )
# Polygon hinzufügen
lines(h$breaks, c(0, h$counts), col = "blue") # add type="s" if you like

```


Im Tidyverse können wir so vorgehen.
```{r}
#| label: Loesung-2eb
#| layout-ncol: 3
### Mittels ggplot()
# Klassengrenzen festlegen
breaks = c(5, 10, 15, 20, 25, 30)

# kumulierte Häufigkeiten
ggplot(df, aes(x=Patienten)) +
  ylab("Häufigkeiten")+
  geom_histogram(aes(y=cumsum(after_stat(count))),
                  fill="hotpink", color="black", 
                  breaks=breaks) +
  stat_bin(aes(y=cumsum(after_stat(count))), 
           breaks=breaks, 
           geom="line", color="blue", linewidth=1.5) # oder geom="step"
#-----------------

# relative Häufigkeiten
ggplot(df, aes(x=Patienten))+
  ylab("relative Häufigkeiten")+
  geom_histogram(aes(y=after_stat(count)/sum(after_stat(count))), 
                 breaks=breaks, fill="hotpink2", color="black") +
  geom_freqpoly(aes(y=after_stat(count)/sum(after_stat(count))), 
                 breaks=breaks, color="blue", linewidth=1.5)
#-----------------

# kumulierte relative Häufigkeiten
ggplot(df, aes(x=Patienten)) +
  ylab("relative Häufigkeiten")+
  geom_histogram(aes(y=cumsum(after_stat(count)/sum(after_stat(count)))), 
                 breaks=breaks, fill="hotpink3", color="black") +
  stat_bin(aes(y=cumsum(after_stat(count)/sum(after_stat(count)))), 
                 breaks=breaks, 
                 geom="step", color="blue", linewidth=1.5) # oder geom="line"
  
```

:::

\bigskip


## Lösung zur Aufgabe [-@sec-A03] {#sec-L03}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit der Variable `Blutgruppe` und übertragen Sie die Daten.
```{r}
#| label: Loesung-3a
# Übertrage Daten
df <- data.frame(Blutgruppe = factor(c("A", "B", "B", "A", "AB", "0", "0", "A", 
                                       "B", "B", "A", "A", "A", "A", "AB", "A", 
                                       "A", "A", "B", "0", "B", "B", "B", "A", 
                                       "A", "A", "0", "A", "AB", "0")))
```
:::


::: {.callout-tip}
## b) Erzeugen Sie eine Häufigkeitstabelle
```{r}
#| label: Loesung-3b
table(df$Blutgruppe)
```


:::



::: {.callout-tip}
## c) Erzeugen Sie ein Kreisdiagramm

```{r}
#| label: Loesung-3c
#| layout-ncol: 2
# mit R base
pie(table(df$Blutgruppe), 
    labels = paste(levels(df$Blutgruppe),"=",
                   as.numeric(table(df$Blutgruppe))
                  )
    )
#------

# mit ggplot benötigen wir ein Hilfsdatenframe
df2 <- as.data.frame(table(df$Blutgruppe))
colnames(df2) <- c("Blutgruppe", "Wert")

ggplot(df2, aes(x="", y=Wert, fill=Blutgruppe)) +
  geom_col(color="black") +
  # Werte schreiben
  geom_text(aes(label = Wert),
            position = position_stack(vjust = 0.5)) +
  # verbiege zu Kreisdiagramm
  coord_polar(theta="y") +
  # entferne Achsen und Ticks
  theme_void()
```

:::

\newpage






## Lösung zur Aufgabe [-@sec-A04] {#sec-L04}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit den Variablen `Alter` und `Familienstand` und übertragen Sie die Daten.

```{r}
#| label: Loesung-4a
df <- data.frame(Alter = c(31, 45, 35, 65, 21, 38, 62, 22, 31,
                           72, 39, 62, 59, 25, 44, 54,
                           80, 68, 65, 40, 78, 69, 75,
                           31, 65, 59, 58, 50),
                 Familienstand = c( rep("Single", 9),
                                    rep("Verheiratet", 7),
                                    rep("Verwitwet", 7),
                                    rep("Geschieden", 5)
                                  ) 
                 )
```
:::


::: {.callout-tip}
## b) Erzeugen Sie für jeden `Familienstand` eine Häufigkeitstabelle des `Alters`.


```{r}
#| label: Loesung-4b1
# Singles
df2 <- subset(df, Familienstand=="Single")
table(df2$Alter)

# Verheiratet
df2 <- subset(df, Familienstand=="Verheiratet")
table(df2$Alter)

# Verwitwet
df2 <- subset(df, Familienstand=="Verwitwet")
table(df2$Alter)

# Geschieden
df2 <- subset(df, Familienstand=="Geschieden")
table(df2$Alter)
```
:::


::: {.callout-tip}
## c) Erzeugen Sie für jeden `Familienstand` eine Boxplot des `Alters`. Gibt es Ausreißer? In welcher Gruppe streut das Alter am meisten?

Mit R base können wir so vorgehen.

```{r}
#| label: Loesung-4c
#| layout-ncol: 2
# Singles
df2 <- subset(df, Familienstand=="Single")
boxplot(df2$Alter, main="Alter der Singles", col="seagreen")
#----------------------------------------

# Verheiratet
df2 <- subset(df, Familienstand=="Verheiratet")
boxplot(df2$Alter, main="Alter der Verheirateten", col="skyblue2")
#----------------------------------------

# Verwitwet
df2 <- subset(df, Familienstand=="Verwitwet")
boxplot(df2$Alter, main="Alter der Verwitweten", col="lightsalmon4")
#----------------------------------------

# Geschieden
df2 <- subset(df, Familienstand=="Geschieden")
boxplot(df2$Alter, main="Alter der Geschiedenen", col="maroon3")
#----------------------------------------
```
Oder alle auf einmal:
```{r}
#| label: Loesung-4cAll
boxplot(Alter ~ Familienstand , data=df,
        col=c("maroon3", "seagreen", "skyblue2", "lightsalmon4"))
```

Es sind Ausreißer erkennbar in der Gruppe der Verwitweten und der Geschiedenen.
\newpage

Im Tidyverse können wir so vorgehen:
```{r}
#| label: Loesung-4ctidy
ggplot(df, aes(y=Alter, x=Familienstand)) +
  geom_boxplot(aes(fill=Familienstand)) +
  stat_boxplot(geom="errorbar")+    
  scale_fill_manual(values=c("seagreen", "skyblue2",
                             "lightsalmon4", "maroon3"),
                      breaks=c("Single", "Verheiratet", 
                               "Verwitwet", "Geschieden"))
```

Auch hier sind die Ausreißer in den Gruppen der Verwitweten und der Geschiedenen erkennbar.
:::

\newpage


::: {.callout-tip}
## d) Erzeugen Sie für jeden `Familienstand` eine Histogram des `Alters`. Wie unterscheiden sich die Histogramme?

Mit R base können wir so vorgehen
```{r}
#| label: Loesung-4d
#| layout-ncol: 2
# Singles
df2 <- subset(df, Familienstand=="Single")
hist(df2$Alter, main="Alter der Singles", col="seagreen")
#----------------------------------------

# Verheiratet
df2 <- subset(df, Familienstand=="Verheiratet")
hist(df2$Alter, main="Alter der Verheirateten", col="skyblue2")
#----------------------------------------

# Verwitwet
df2 <- subset(df, Familienstand=="Verwitwet")
hist(df2$Alter, main="Alter der Verwitweten", col="lightsalmon4")
#----------------------------------------

# Geschieden
df2 <- subset(df, Familienstand=="Geschieden")
hist(df2$Alter, main="Alter der Geschiedenen", col="maroon3")
#----------------------------------------
```

\newpage

Im Tidyverse können wir so vorgehen:
```{r}
#| label: Loesung-4dtidy
breaks = c(seq(10,80,10))
ggplot(df, aes(x=Alter, fill=Familienstand)) +
    geom_histogram(breaks=breaks, color="black")+
    scale_fill_manual(values=c("seagreen", "skyblue2",
                               "lightsalmon4", "maroon3"),
                      breaks=c("Single", "Verheiratet", 
                               "Verwitwet", "Geschieden"))+
    facet_wrap(~Familienstand)
```

:::

\smallskip\ 


## Lösung zur Aufgabe [-@sec-A05] {#sec-L05}
::: {.callout-tip}
## a) Erstellen Sie eine Häufigkeitstabelle

```{r}
#| label: Loesung-5a
# erzeuge Daten
Verletzung <- c(0, 1, 2, 1, 3, 0, 1, 0, 1, 2, 0, 1, 1, 1, 2, 0, 
              1, 3, 2, 1, 2, 1, 0, 1)

# Häufigkeitstabelle
xtabs(~Verletzung)
```
:::

\smallskip\ 

::: {.callout-tip}
## b) Erzeugen Sie ein Säulendiagramm der relativen und kumulativen relativen Häufigkeiten.

```{r}
#| label: Loesung-5b
#| layout-ncol: 2

# relative Häufigkeiten als Barplot
barplot( table(Verletzung) / length(Verletzung)*100,
        col="blanchedalmond", main="relative Häufigkeiten",
        ylab="relative Häufigkeit in %", xlab="Verletzungen")
#------------------------------------------------------

# relative kumulierte Häufigkeiten als Barplot
barplot( cumsum(table(Verletzung)) / sum(table(Verletzung))*100,
        col="goldenrod1", main="kumulierte relative Häufigkeiten",
        ylab="relative Häufigkeit in %", xlab="Verletzungen")
```

Mit ggplot
```{r}
#| label: Loesung-5btidy
#| layout-ncol: 2
df <- data.frame(Verletzung)
ggplot(df, aes(x=Verletzung))+
    geom_bar(aes(y=after_stat(count)/sum(after_stat(count))*100),
            fill="blanchedalmond", color="black") +
    ylab("relative Häufigkeiten in %")
#-----------------------------

# kumulierte relative Häufigkeiten
ggplot(df, aes(x=Verletzung))+
    ylab("relative Häufigkeiten in %")+
    geom_bar(aes(y=cumsum(after_stat(count)/sum(after_stat(count)))*100),
            fill="goldenrod1", color="black")
```

:::

\smallskip\ 

::: {.callout-tip}
## c) Erzeugen Sie ein Boxplot
```{r}
#| label: Loesung-5c
#| layout-ncol: 2

boxplot(Verletzung, col="lightcoral", ylab="Anzahl der Verletzungen")
#--------------------

# mit ggplot
ggplot(df, aes(y=Verletzung)) + 
    geom_boxplot(fill="lightcoral") +
    stat_boxplot(geom="errorbar") + 
    theme(axis.ticks.x=element_blank(),
          axis.text.x=element_blank())
```
:::

\smallskip\ 

## Lösung zur Aufgabe [-@sec-A06] {#sec-L06}
::: {.callout-tip}
## a) Erstellen Sie ein Histogram der Körpergröße mit Klassen von 150cm bis 200cm, die jeweils 10cm breit sind. 

```{r}
#| label: Loesung-6a
#| layout-ncol: 2
 
Koerpergroesse <- c(179, 173, 181, 170, 158, 174, 172, 166, 194, 185,
                    162, 187, 198, 177, 178, 165, 154, 188, 166, 171,
                    175, 182, 167, 169, 172, 186, 172, 176, 168, 187)
                    
hist(Koerpergroesse, breaks=seq(150, 200, 10),
                     col="aliceblue")
#-----------------------

# mit ggplot
as.data.frame(Koerpergroesse) %>% 
    ggplot(aes(x=Koerpergroesse)) +
        geom_histogram(breaks=seq(150, 200, 10), 
                       fill="aliceblue", color="black")
```
:::

::: {.callout-tip}
## b) Gibt es Ausreißer?

```{r}
#| label: Loesung-6b

boxplot(Koerpergroesse, col="dodgerblue1")
```
Es sind keine Ausreißer erkennbar.

:::


\smallskip\ 

## Lösung zur Aufgabe [-@sec-A07] {#sec-L07}

```{r}
#| label: Loesung-7vorbereitung
#| eval: false
# lade Daten
load("https://www.produnis.de/R/data/neonates.RData")
```

```{r}
#| label: Loesung-7vorbereitung2
#| include: false
# lade Daten
load("data/neonates.RData")
```

```{r}
#| label: Loesung-7vorbereitung3
# Datensatz anschauen
summary(neonates)
```



::: {.callout-tip}
## a) Erstellen Sie die Häufigkeitstabelle des APGAR-Scores nach 1 Minute. Wenn ein Score von 3 oder weniger anzeigt, dass das Neugeborene in einem kritischen Zusatand ist, wie viel Prozent der Neugeborenen in der Stichprobe sind dann in einem kritischen Zustand?

```{r}
#| label: Loesung-7a
# neue Variable "kritisch"
neonates$kritisch <- FALSE
# nur solche mit APGAR<4 sind kritisch
neonates$kritisch[neonates$apgar1<4] <- TRUE 
# relative Häufigkeiten
table(neonates$kritisch) / length(neonates$kritisch) * 100
```
7,81\% der Neugeborenen sind in einem kritischen Zustand.
:::

::: {.callout-tip}
## b) Erstellen Sie die Häufigkeitstabelle des Geburtsgewichts der Neugeborenen, indem Sie die Daten in Klassen mit einer Breite von 0,5 kg von 2 bis 4,5 kg einteilen. Welches Intervall enthält die meisten Neugeborenen?

```{r}
#| label: Loesung-7b
# neue Variable für die Gewichtsklassifikation
neonates$gewiKat <- cut(neonates$weight, breaks=seq(2, 4.5, 0.5),
                        ordered_results=TRUE)
# einfache Häufigkeitstabelle
table(neonates$gewiKat)

# oder vollständige
jgsbook::freqTable(neonates$gewiKat)
```
Das Intervall von 3-3,5kg enthält die meisten Neugeborenen.

:::

::: {.callout-tip}
## c) Vergleichen Sie die Häufigkeitsverteilung des APGAR-Scores nach 1 Minute für Mütter unter 20 Jahren und für Mütter über 20 Jahren. Welche Gruppe hat mehr Neugeborene in kritischem Zustand?

```{r}
#| label: Loesung-7c
# gruppieren
gruppe1 <- neonates$apgar1[neonates$age=="less than 20"]
gruppe2 <- neonates$apgar1[neonates$age=="greater than 20"]

# Jünger als 20
jgsbook::freqTable(gruppe1)

# Älter als 20
jgsbook::freqTable(gruppe2)


```
In der Gruppe der unter-20-jährigen liegt der Prozentsatz an Neugeborenen mit APGAR-Werten kleinergleich 3 bei 12,74\%. In der Gruppe der über-20-jährigen liegt der Prozentwert bei 5,51\%. Es tritt also in der Gruppe der jüngeren Mütter häufiger auf.
:::


::: {.callout-tip}
## d) Vergleichen Sie die relative Häufigkeitsverteilung des Geburtsgewichts der Neugeborenen, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Wenn ein Gewicht unter 2,5 kg als niedriges Gewicht gilt, welche Gruppe hat einen höheren Prozentsatz an Neugeborenen mit niedrigem Gewicht?

```{r}
#| label: Loesung-7d
# (hatten wir oben schon)
# Gewichtsklassifikation
neonates$gewiKat <- cut(neonates$weight, breaks=seq(2, 4.5, 0.5),
                        right=FALSE, ordered_results=TRUE)
gruppe1 <- neonates$gewiKat[neonates$smoke=="No"]
gruppe2 <- neonates$gewiKat[neonates$smoke=="Yes"]

# Nichtraucherinnen
jgsbook::freqTable(gruppe1)

# Raucherinnen
jgsbook::freqTable(gruppe2)
```
In der Gruppe der Nichtraucherinnen trat ein Geburtsgewicht kleiner 2,5kg in 2,27\% der Fälle auf. Bei den Raucherinnen waren es 17\%.

:::

::: {.callout-tip}
## e) Berechnen Sie die Prävalenz von Neugeborenen mit niedrigem Gewicht für Mütter, die vor der Schwangerschaft geraucht haben, und den Nichtraucherinnen.

```{r}
#| label: Loesung-7e
gruppe1 <- neonates$gewiKat[neonates$smoke.before=="No"]
gruppe2 <- neonates$gewiKat[neonates$smoke.before=="Yes"]

# Nichtraucherinnen
jgsbook::freqTable(gruppe1)

# Raucherinnen
jgsbook::freqTable(gruppe2)
```
Die Prävalenz beträgt unter den Nichtraucherinnen 1,08\% und unter den Raucherinnen 14,81\%.

:::

::: {.callout-tip}
## f) Berechnen Sie das relative Risiko eines niedrigen Geburtsgewichts des Neugeborenen, wenn die Mutter während der Schwangerschaft raucht, im Vergleich dazu, wenn die Mutter nicht raucht.

```{r}
#| label: Loesung-7f
# neue binäre Variable, ob Gewicht niedrig ist
neonates$gewiLow <- FALSE
neonates$gewiLow[neonates$gewiKat=="[2,2.5)"] <- TRUE

# Kreuztabelle
table(neonates$smoke, neonates$gewiLow)
```
$\text{relatives Risiko} = \frac{a\cdot(c+d)}{c\cdot(a+b)}$

```{r}
#| label: Loesung-7f2
# Kreuztabelle als numerische Werte
tab <- as.numeric(table(neonates$smoke, neonates$gewiLow))

# rechne das relative Risiko nach der obigen Formel
( tab[1] * (tab[2]+tab[4]) ) / ( tab[2] * (tab[1]+tab[3]) )
```
Raucherinnen haben ein 1,177437-fach höheres Risiko ein Kind mit niedrigem Gewicht zugebären als Nichtraucherinnen. Die Wahrscheinlichkeit ist in der Raucherinnengruppe also 17,74\% höher als bei den Nichtraucherinnen.
:::

::: {.callout-tip}
## g) Erstellen Sie ein Balkendiagramm des APGAR-Scores nach 1 Minute. Welcher Score ist am häufigsten?

```{r}
#| label: Loesung-7g
#| layout-ncol: 2
# mit R base
barplot(table(neonates$apgar1), col="mistyrose")
#-------------------------

# mit ggplot
ggplot(neonates, aes(x=apgar1)) +
  geom_bar(color="black", fill="mistyrose")+ 
  scale_x_continuous(breaks=seq(2, 9, 1))
```
Am häufigsten tritt Wert $6$ auf.
:::

::: {.callout-tip}
## h) Erstellen Sie das Balkendiagramm der kumulierten relativen Häufigkeit des APGAR-Scores nach 1 Minute. Unter welchem Wert liegen die Hälfte der Neugeborenen?

```{r}
#| label: Loesung-7h
#| layout-ncol: 2
# mit R base
# plotte das kumulative Balkendiagramm
barplot(cumsum(table(neonates$apgar1))/sum(table(neonates$apgar1)),
        col="olivedrab1", main = "kumulierte relative Häufigkeiten")
# Linie bei 50% ziehen
abline(h=0.5, col="blue")
#-------------------------

# mit ggplot()
ggplot(neonates, aes(x=apgar1)) +
  geom_bar(aes(y=cumsum(after_stat(count)/sum(after_stat(count)))),
        fill="olivedrab1", color="black") +
  ylab("relative Häufigkeit") +
  geom_hline(yintercept= 0.5, color="blue", linewidth=1) + 
  scale_x_continuous(breaks=seq(2, 9, 1))
```

Der Median liegt bei $6$.

:::



::: {.callout-tip}
## i) Vergleichen Sie die Balkendiagramme der relativen Häufigkeitsverteilungen des APGAR-Scores nach 1 Minute, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Welche Schlussfolgerungen können gezogen werden?

```{r}
#| label: Loesung-7i
#| layout-ncol: 2
# mit R base
gruppe1 <- neonates$apgar1[neonates$smoke=="No"]
gruppe2 <- neonates$apgar1[neonates$smoke=="Yes"]

barplot( table(gruppe1)/sum(table(gruppe1)) *100, 
        ylab="relative Häufigkeit in %", main="Nichtraucherinnen",
        ylim=c(0,35), col="paleturquoise1")
barplot( table(gruppe2)/sum(table(gruppe2)) *100, 
        ylab="relative Häufigkeit in %", main="Raucherinnen",
        ylim=c(0,35), col="paleturquoise4")
```


```{r}
#| label: Loesung-7iTidy
#| layout-ncol: 2
# mit ggplot
# Nichtraucherinnen
neonates %>%
  filter(smoke=="No") %>%
  ggplot(aes(x=apgar1))+
  geom_bar(aes(y=after_stat(count)/sum(after_stat(count))*100), 
          color="black", fill="paleturquoise1")+ 
  scale_x_continuous(breaks=seq(2, 9, 1)) + 
  ylab("relative Häufigkeit in %") +
  ylim(0,35)
#-------------------------------
  
# Raucherinnen
neonates %>%
  filter(smoke=="Yes") %>%
  ggplot(aes(x=apgar1))+
  geom_bar(aes(y=after_stat(count)/sum(after_stat(count))*100), 
          color="black", fill="paleturquoise4") + 
  scale_x_continuous(breaks=seq(2, 9, 1)) + 
  ylab("relative Häufigkeit in %") +
  ylim(0,35)

```

Die Kinder der Raucherinnen haben geringere APGAR-Werte.
:::


::: {.callout-tip}
## j) Erstellen Sie ein Histogramm der Geburtsgewichte der Neugeborenen mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg. Welche Klasse enthält die meisten Neugeborenen?

```{r}
#| label: Loesung-7j
#| layout-ncol: 2
# mit R base
hist(neonates$weight, breaks = seq(2, 4.5, 0.5),
    col="peachpuff3")
#---------------------

# mit ggplot
ggplot(neonates, aes(x=weight)) +
  geom_histogram( breaks = seq(2, 4.5, 0.5),
                  fill="peachpuff3", color="black")
```
Die Gewichtsklasse 3kg-3,5kg enthält die meisten Neugeborenen

:::




::: {.callout-tip}
## k) Vergleichen Sie die relativen Häufigkeitshistogramme der Geburtsgewichte der Neugeborenen, mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg, je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht. Welche Gruppe hat Neugeborene mit geringeren Gewichten?

```{r}
#| label: Loesung-7k
#| layout-ncol: 2
# mit R base
hist(neonates$weight[neonates$smoke=="No"], 
     breaks=seq(2, 4.5, 0.5), col="springgreen1", 
     main="Nichtraucherinnen", xlab="Gewichtskategorien", 
     ylab="relative Häufigkeiten", freq=FALSE)
#---------------------

# Raucherinnen
hist(neonates$weight[neonates$smoke=="Yes"], 
     breaks=seq(2, 4.5, 0.5), col="springgreen4", 
     main="Raucherinnen", xlab="Gewichtskategorien", 
     ylab="relative Häufigkeiten", freq=FALSE)

```
```{r}
#| label: Loesung-7kTidy
#| layout-ncol: 2
# mit ggplot

neonates %>%
  filter(smoke=="No") %>%
  ggplot(aes(x=weight)) +
    geom_histogram(aes(y=after_stat(count)/sum(after_stat(count))), 
                   breaks=seq(2, 4.5, 0.5), 
                   fill="springgreen1", color="black") +
    ylab("relative Häufigkeiten") + xlab("Geburtsgewicht")
#-----------

# Raucherinnen
neonates %>%
  filter(smoke=="Yes") %>%
  ggplot(aes(x=weight)) +
    geom_histogram(aes(y=after_stat(count)/sum(after_stat(count))), 
                   breaks=seq(2, 4.5, 0.5), 
                   fill="springgreen4", color="black") +
    ylab("relative Häufigkeiten") + xlab("Geburtsgewicht")
```

Kinder von Raucherinnen haben durchschnittlich weniger Geburtsgewicht.
:::



::: {.callout-tip}
## l) Vergleichen Sie die relativen Häufigkeitshistogramme der Geburtsgewichte der Neugeborenen, mit Klassenbreiten von 0,5 kg von 2 bis 4,5 kg, je nachdem, ob die Mutter vor der Schwangerschaft geraucht hat oder nicht. Welche Schlussfolgerungen können gezogen werden?

```{r}
#| label: Loesung-7l
#| layout-ncol: 2
# mit R base
hist(neonates$weight[neonates$smoke.before=="No"], 
     breaks=seq(2, 4.5, 0.5), col="steelblue1", 
     main="Nichtraucherinnen", xlab="Gewichtskategorien", 
     ylab="relative Häufigkeiten", freq=FALSE)
#---------------------

# Raucherinnen
hist(neonates$weight[neonates$smoke.before=="Yes"], 
     breaks=seq(2, 4.5, 0.5), col="steelblue4", 
     main="Raucherinnen", xlab="Gewichtskategorien", 
     ylab="relative Häufigkeiten", freq=FALSE)

```

```{r}
#| label: Loesung-7lTidy
#| layout-ncol: 2
# mit ggplot

neonates %>%
  filter(smoke.before=="No") %>%
  ggplot(aes(x=weight)) +
    geom_histogram(aes(y=after_stat(count)/sum(after_stat(count))), 
                   breaks=seq(2, 4.5, 0.5), 
                   fill="steelblue1", color="black") +
    ylab("relative Häufigkeiten") + xlab("Geburtsgewicht")
#-----------

# Raucherinnen
neonates %>%
  filter(smoke.before=="Yes") %>%
  ggplot(aes(x=weight)) +
    geom_histogram(aes(y=after_stat(count)/sum(after_stat(count))), 
                   breaks=seq(2, 4.5, 0.5), 
                   fill="steelblue4", color="black") +
    ylab("relative Häufigkeiten") + xlab("Geburtsgewicht")
```

Kinder von Müttern, die vor der Schwangerschaft geraucht haben, haben durchschnittlich weniger Geburtsgewicht.
:::



::: {.callout-tip}
## m) Erstellen Sie ein Boxplot der Geburtsgewichte der Neugeborenen. Welcher Gewichtsbereich kann in der Stichprobe als normal angesehen werden? Gibt es Ausreißer in der Stichprobe?

```{r}
#| label: Loesung-7m
#| layout-ncol: 2
# mit R base
boxplot(neonates$weight, col="thistle")
# mit ggplot()
ggplot(neonates, aes(y=weight)) +
  geom_boxplot(fill="thistle") +     
  stat_boxplot(geom="errorbar") +
  theme(axis.ticks.x=element_blank(),
        axis.text.x=element_blank())
```

```{r}
#| label: Loesung-7mSum
# Zusammenfassung
summary(neonates$weight)
```

Gewichte zwischen 2,794kg und 3,267kg können als normal angesehen werden. Es gibt je einen Ausreißer nach oben und nach unten.
:::


::: {.callout-tip}
## n) Vergleichen Sie die Boxplots der Geburtsgewichte der Neugeborenen je nachdem, ob die Mutter während der Schwangerschaft geraucht hat oder nicht und ob die Mutter unter 20 oder über 20 Jahre alt war. Welche Gruppe hat eine größere zentrale Streuung? Welche Gruppe hat Neugeborene mit geringerem Gewicht?
```{r}
#| label: Loesung-7n
#| layout-ncol: 2
# R base
boxplot(weight ~ smoke, data=neonates)

# Alterkategorie
boxplot(weight ~ age, data=neonates)
```
```{r}
#| label: Loesung-7nTidy
#| layout-ncol: 2
# ggplot Rauchen
ggplot(neonates, aes(y=weight, x=smoke)) +
  geom_boxplot() +
  stat_boxplot(geom="errorbar") +
  theme(axis.ticks.x=element_blank(),
        axis.text.x=element_blank())
#-------------------------------------
# 20 Jahre alt
ggplot(neonates, aes(y=weight, x=age)) +
  geom_boxplot() +
  stat_boxplot(geom="errorbar") +
  theme(axis.ticks.x=element_blank(),
        axis.text.x=element_blank())
  
```


Das Gewicht ist in der Gruppe der Raucherinnen und in der Gruppe der unter-20jährigen geringer.


:::

::: {.callout-tip}
## o) Vergleichen Sie die Boxplots der APGAR-Scores nach 1 Minute und nach 5 Minuten. Welche Variable hat eine größere zentrale Streuung?
```{r}
#| label: Loesung-7o
#| layout-ncol: 2
# daten tidy machen
df <- pivot_longer(neonates, apgar1:apgar5, 
                   names_to  = "minute", 
                   values_to = "wert")

# boxplot
boxplot(wert ~ minute, data=df)
#-------------------------------

# ggplot
ggplot(df, aes(y=wert, fill=minute)) +
  geom_boxplot() +     
  stat_boxplot(geom="errorbar") +
  theme(axis.ticks.x=element_blank(),
        axis.text.x=element_blank())
```
Die Streuung in `apgar5` ist größer.

:::





## Lösung zur Aufgabe [-@sec-B01] {#sec-LB01}
::: {.callout-tip}
## a)  Erstellen Sie ein Datenframe mit der Variable `Kinder` und übertragen Sie die Daten.
```{r}
#| label: Loesung-B1a
# erzeuge Datenframe
df <- data.frame(Kinder = c(1, 2, 4, 2, 2, 2, 3, 2, 1, 1, 0, 2, 2, 0, 
                            2, 2, 1, 2, 2, 3, 1, 2, 2, 1, 2))
```
:::


::: {.callout-tip}
## b) Berechnen Sie das arithmetische Mittel, die Varianz sowie die Standardabweichung für die Anzahl an Kindern.

```{r}
#| label: Loesung-B1b
# arithmetisches Mittel
mean(df$Kinder)

# Varianz
var(df$Kinder)

# Standardabweichung
sd(df$Kinder)
```

:::

::: {.callout-tip}
## c) Berechnen Sie die Quartile, die Spannweite, den Interquartilsabstand, das dritte Dezil sowie das 68te Perzentil.
```{r}
#| label: Loesung-B1c

# Quartile (so wie SPSS rechnet)
quantile(df$Kinder, type=6)

# Spannweite
range(df$Kinder)

# Interquartilsabstand (so wie SPSS rechnet)
IQR(df$Kinder, type=6)

# drittes Dezil und 68tes Perzentil
quantile(df$Kinder, probs=c(0.3, 0.68), type=6)
```

:::


\smallskip\  

## Lösung zur Aufgabe [-@sec-B02] {#sec-LB02}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit der Variable `Patienten` und übertragen Sie die Daten.

```{r}
#| label: Loesung-B2a
# erzeuge Datenframe
df <- data.frame(Patienten = c(15, 23, 12, 10, 28, 50, 12, 17, 20, 
                               21, 18, 13, 11, 12, 26, 30,  6, 16,
                               19, 22, 14, 17, 21, 28,  9, 16, 13,
                               11, 16, 20))
```
:::


::: {.callout-tip}
## b) Berechnen Sie das arithmetische Mittel, die Varianz, die Standardabweichung und den Variationskoeffizienten.
```{r}
#| label: Loesung-B2b
# arithmetisches Mittel
mean(df$Patienten)

# Varianz
var(df$Patienten)

# Standardabweichung
sd(df$Patienten)

# Variationskoeffizient in Prozent
(sd(df$Patienten) / mean(df$Patienten)) * 100
```

:::

::: {.callout-tip}
## c) Berechnen Sie die Skewness (Schiefe) und Kurtosis ("Spitzigkeit") und interpretieren Sie die Werte.
```{r}
#| label: Loesung-B2c
# Skewness
psych::skew(df$Patienten, type=2) # rechne wie SPSS

# Kurtosis
psych::kurtosi(df$Patienten, type=2) # rechne wie SPSS
```

Die Skewness beträgt `r psych::skew(df$Patienten, type=2)`, was für eine rechtsschiefe Verteilung spricht. Die Kurtosis  beträgt `r psych::kurtosi(df$Patienten, type=2)` und ist somit größer als 3. Das bedeutet, die Verteilung hat eine schmale Spitze und fette Ränder.
:::


\smallskip\  

## Lösung zur Aufgabe [-@sec-B03] {#sec-LB03}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit der Variable `Bewertung` und übertragen Sie die Daten.

```{r}
#| label: Loesung-B3a
# erzeuge Datenframe
df <- data.frame(Bewertung = c("SS", "AP", "SS", "AP", "AP", "NT", "NT", "AP", 
                               "SB", "SS", "SB", "SS", "AP", "AP", "NT", "AP", 
                               "SS", "NT", "SS", "NT"))
```
:::


::: {.callout-tip}
## b) Wandeln Sie die `Bewertung` in Punkte um nach dem Schema “SS” = 2,5 | “AP” = 6 | “NT”= 8 | “SB” = 9,5.

```{r}
#| label: Loesung-B3b
# Umkodieren
df$Punkte[df$Bewertung=="SS"] <- 2.5
df$Punkte[df$Bewertung=="AP"] <- 6
df$Punkte[df$Bewertung=="NT"] <- 8
df$Punkte[df$Bewertung=="SB"] <- 9.5

```
:::

::: {.callout-tip}
## c) Bestimmen Sie den Median und den Interquartilsabstand.

```{r}
#| label: Loesung-B3c
# Median
median(df$Punkte)

# Interquartilsabstand, so wie SPSS ihn rechnen würde
IQR(df$Punkte, type=6)
```
:::



\smallskip\  

## Lösung zur Aufgabe [-@sec-B04] {#sec-LB04}
::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit der Variablen `Geschlecht` und `Koerpergroesse` und übertragen Sie die Daten.

```{r}
#| label: Loesung-B4a
# erzeuge Datenframe
df <- data.frame(Geschlecht = c(rep("weiblich", 14),
                                rep("männlich", 16)),
                 Koerpergroesse = c(173, 158, 174, 166, 162, 177, 165, 154, 166, 
                 182, 169, 172, 170, 168, 179, 181, 172, 194, 185, 187, 198, 
                 178, 188, 171, 175, 167, 186, 172, 176, 187))
```
:::

::: {.callout-tip}
## b) Bestimmen Sie in Abhängigkeit zum `Geschlecht` das arithmetische Mittel, den Median, die Varianz, die Standardabweichung sowie die Quartile.

```{r}
#| label: Loesung-B4b
# mit dplyr
df %>% group_by(Geschlecht) %>% 
  reframe(aritMittel = mean(Koerpergroesse),
          Median = median(Koerpergroesse),
          Varianz = var(Koerpergroesse),
          StdAbw  = sd(Koerpergroesse),
          Q1 = quantile(Koerpergroesse, probs=0.25, type=6),
          Q3 = quantile(Koerpergroesse, probs=0.75, type=6)
  )
```
:::



\smallskip\  

## Lösung zur Aufgabe [-@sec-B05] {#sec-LB05}
::: {.callout-tip}
## a) Bestimmen Sie das arithmetische Mittel, den Median, die Varianz sowie die Standardabweichung der Verletzungen.

```{r}
#| label: Loesung-B5a
# Daten übertragen
Handball <- c(0, 1, 2, 1, 3, 0, 1, 0, 1, 2, 0, 1, 1, 
              1, 2, 0, 1, 3, 2, 1, 2, 1, 0, 1)

# Mittelwert
mean(Handball)
# Median
median(Handball)
# Varianz
var(Handball)
# Standardabweichung
sd(Handball)
```
:::


::: {.callout-tip}
## b) Bestimmen Sie die Skewness und Kortosis der Verteilung.

```{r}
#| label: Loesung-B5b
# Skewness, wie SPSS
psych::skew(Handball, type=2)

# Kurtosis, wie SPSS
psych::kurtosi(Handball, type=2)
```
:::

::: {.callout-tip}
## c) Berechnen Sie das vierte und achte Dezil der Verteilung. 

```{r}
#| label: Loesung-B5c
quantile(Handball, probs=c(0.4, 0.8), type=6)
```
:::








\newpage  

## Lösung zur Aufgabe [-@sec-B06] {#sec-LB06}
::: {.callout-tip}
## Welcher Monitor funktioniert besser?

```{r}
#| label: Loesung-B6a
# Daten übertragen
monitor <- data.frame(Unterarm=c(111, 109, 112, 111, 113, 113, 114, 111),
                     Handgelenk=c(115, 113, 117, 116, 112, 112, 117, 112)
)

# Standardabweichungen vergleichen
sd(monitor$Unterarm)
sd(monitor$Handgelenk)

```
Die Daten des Monitors am Handgelenk haben eine größere Streuung als jene vom Monitor am Unterarm.
:::


\smallskip\  

## Lösung zur Aufgabe [-@sec-B07] {#sec-LB07}
::: {.callout-tip}
## a) Bestimmen Sie das arithmetische Mittel, den Median, die Varianz sowie die Standardabweichung des `Alters` für jeden `Familienstand`.

```{r}
#| label: Loesung-B7a
# Daten übertragen
df <- data.frame(Familienstand = c(rep("Single", 9),
                                   rep("Verheiratet", 7),
                                   rep("Verwitwet", 7),
                                   rep("Geschieden", 5)),
                 Alter = c(31, 45, 35, 65, 21, 38, 62, 22, 31,
                           72, 39, 62, 59, 25, 44, 54, 
                           80, 68, 65, 40, 78, 69, 75,  
                           31, 65, 59, 58, 50)
                 )

# dplyr
df %>% group_by(Familienstand) %>%
       reframe(Mittel = mean(Alter),
               Median = median(Alter),
               Varianz = var(Alter),
               StdAbw = sd(Alter))
```

:::

::: {.callout-tip}
## Welche Gruppe hat den "besten" Mittelwert?

```{r}
#| label: Loesung-B7b
df %>% group_by(Familienstand) %>%
       reframe(Mittel = mean(Alter),
               Median = median(Alter),
               Varianz = var(Alter),
               StdAbw = sd(Alter),
               Skew = psych::skew(Alter, type=2),
               Kurto = psych::kurtosi(Alter, type=2))
```

In der Gruppe der Geschiedenen ist die Streuung am geringsten, aber das arithmetische Mittel ist weit vom Median entfernt. Insofern scheint der Mittelwert der Verwitweten am "besten" zu sein, da er sowohl eine geringe Differenz zum Median als auch eine niedrige Varianz und Standardabweichung aufweist. 
Die Gruppe der Verheirateten weist hingegen die geringste Schiefe auf. Ach hier könnten wir argumentieren, dass dies für den "besten" Mittelwert spräche.
:::





\newpage

## Lösung zur Aufgabe [-@sec-B08] {#sec-LB08}
::: {.callout-tip}
## a) Vergleichen Sie das arithmetische Mittel, die Standardabweichung, die Skewness und Kurtosis des `Blutdrucks` zwischen Rauchern und Nichtrauchern.

```{r}
#| label: Loesung-B8a
# Daten übertragen
df <- data.frame(Rauchen = c("ja", "nein", "ja", "ja", "ja", "nein", "nein", 
                             "ja", "nein", "ja", "nein", "ja", "nein",
                             "ja", "nein", "nein", "ja", "nein", "nein", 
                             "nein", "ja", "nein", "ja", "nein", "ja"  ),
                 Alkohol = c("nein", "nein", "ja", "ja", "nein", "nein", "ja", 
                             "ja", "nein", "ja", "nein", "ja", "ja" , "ja", 
                             "nein", "ja", "ja", "nein", "nein", "ja", "ja", 
                             "ja", "nein", "ja", "nein" ),
                 Blutdruck = c(80, 92, 75, 56, 89, 93, 101, 67, 89, 63, 98, 58, 
                               91, 71, 52, 98, 104, 57, 89, 70, 93, 69, 82, 70, 
                               49 )
                 )

# dplyr
df %>% group_by(Rauchen) %>%
       reframe(Mittel = mean(Blutdruck),
               StdAbw = sd(Blutdruck),
               Skew =  psych::skew(Blutdruck, type=2),
               Kurto = psych::kurtosi(Blutdruck, type=2))
```

:::

::: {.callout-tip}
## b) Vergleichen Sie die selben Werte zwischen der Alkohol- und Nicht-Alkoholgruppe.

```{r}
#| label: Loesung-B8b
# dplyr
df %>% group_by(Alkohol) %>%
       reframe(Mittel = mean(Blutdruck),
               StdAbw = sd(Blutdruck),
               Skew =  psych::skew(Blutdruck, type=2),
               Kurto = psych::kurtosi(Blutdruck, type=2))
```

:::


::: {.callout-tip}
## c) Vergleichen Sie die selben Werte zwischen der Raucher- und Alkoholgruppe, zwischen der Raucher- und Nicht-Alkoholgruppe, der Nichtraucher- und Alkoholgruppe sowie der Nichtraucher- und Nicht-Alkoholgruppe.

```{r}
#| label: Loesung-B8c
# dplyr
df %>% group_by(Alkohol, Rauchen) %>%
       reframe(Mittel = mean(Blutdruck),
               StdAbw = sd(Blutdruck),
               Skew =  psych::skew(Blutdruck, type=2),
               Kurto = psych::kurtosi(Blutdruck, type=2))
```

:::






## Lösung zur Aufgabe [-@sec-C01] {#sec-LC01}
::: {.callout-tip}
## a)  Erstellen Sie ein Datenframe mit den Variablen `x` und `y`.
```{r}
#| label: Loesung-C1a
# erzeuge Datenframe
df <- data.frame(x = c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ),
                 y = c( 2, 5, 8, 11, 14, 17, 20, 23, 26, 29))
```
:::

::: {.callout-tip}
## b)  Erzeugen Sie ein Scatterplot von  `x` und `y`. Bestimmen Sie anhand des Plots, welche Regressionsfunktion die Daten am besten erklären würde.
```{r}
#| label: Loesung-C1b
#| layout-ncol: 2
# plot()
plot(df$x, df$y)

# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point()
```
Es ist ein deutlicher linearer Zusammenhang erkennbar.

:::


::: {.callout-tip}
## c)   Führen Sie die Regression durch.
```{r}
#| label: Loesung-C1c
# lineares Modell
fit <- lm(y ~ x, data=df)

# anschauen
summary(fit)
```

:::

::: {.callout-tip}
## d)  Fügen Sie die Regressionsfunktion `y erklärt durch x`  dem Plot hinzu.
```{r}
#| label: Loesung-C1d
#| layout-ncol: 2
# plot()
plot(df$x, df$y)
# Regressionsgerade
abline(lm(y~x, data=df), col="skyblue2")


# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point() +
  geom_smooth(method="lm", color="skyblue2") 
```

:::

::: {.callout-tip}
## e) Fügen Sie die Regressionsfunktion `x erklärt durch y` ebenfalls dem Plot hinzu, aber in roter Farbe.
```{r}
#| label: Loesung-C1e
#| layout-ncol: 2
# plot()
plot(df$x, df$y)
# Regressionsgeraden
abline(lm(y~x, data=df), col="skyblue2")
abline(lm(x~y, data=df), col="red")


# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point() +
  geom_smooth(method="lm", color="skyblue2") +
  geom_smooth(aes(x=y, y=x), method="lm", color="red") 
```
Achten Sie darauf, die Variablen nicht zu vertauschen!
:::



::: {.callout-tip}
## f) Wie große sind die Residuen?
```{r}
#| label: Loesung-C1f
fit <- lm(y ~ x, data=df)

# Residuen
fit$residuals
```
Die Residuen sind sehr klein. Die Regressionsgerade scheint sehr gut zu passen.
:::





## Lösung zur Aufgabe [-@sec-C02] {#sec-LC02}
::: {.callout-tip}
## a)  Erstellen Sie ein Datenframe mit den Variablen `Lernen` und `Durchgefallen`.
```{r}
#| label: Loesung-C2a
# erzeuge Datenframe
df <- data.frame(Lernen = c( 3.5, 0.6, 2.8, 2.5, 2.6, 3.9, 1.5, 0.7, 3.6, 3.7,
                             2.2, 3.3, 1.7, 1.1, 2.0, 3.5, 2.1, 1.8, 1.1, 0.7,
                             1.3, 3.1, 2.3, 3.2, 0.9, 1.7, 0.2, 2.9, 1.0, 2.3),
                 Durchgefallen = c( 1, 5, 1, 3, 1, 0, 3, 3, 1, 1, 
                                    2, 0, 3, 3, 3, 0, 2, 2, 4, 4,
                                    4, 0, 2, 2, 4, 2, 5, 1, 3, 2))
```
:::


::: {.callout-tip}
## b) Erzeugen Sie eine Kreuztabelle der Variablen `Lernen` und `Durchgefallen`.

```{r}
#| label: Loesung-C2b
# entweder
table(df$Lernen, df$Durchgefallen)

# oder
xtabs(~ Lernen + Durchgefallen, data=df)
```
:::


::: {.callout-tip}
## c) Führen Sie eine lineare Regression `Durchgefallen erklärt durch Lernen` durch und plotten Sie Ihr Ergebnis.

```{r}
#| label: Loesung-C2c
# lineare Regression
fit <- lm(Durchgefallen ~ Lernen , data=df)
summary(fit)

```


```{r}
#| label: Loesung-C2c2
#| layout-ncol: 2
# plot()
plot(df$Lernen, df$Durchgefallen)
# Regressionsgerade
abline(lm(Durchgefallen ~ Lernen, data=df), col="skyblue2")


# ggplot()
ggplot(df, aes(x=Lernen, y=Durchgefallen)) +
  geom_point() +
  geom_smooth(method="lm", color="skyblue2") 
```
:::



::: {.callout-tip}
## d)  Wie lauten die Regressionskoeffizient des Modells, und wie ist er zu interpretieren?

```{r}
#| label: Loesung-C2d
# Koeffizienten anzeigen
fit$coefficients
```

Der Regressionskoeffizient für `Lernen` beträgt `r fit$coefficients[2]`. Das bedeutet, dass mit ungefähr jeder Stunde Lernen ein Kurs weniger nicht bestanden wird.

:::



::: {.callout-tip}
## e) Ist das soeben erstellte Modell *besser* als das in @sec-LC01 berechnete? Vergleichen Sie zur Beantwortung die Residuen beider Modelle.

```{r}
#| label: Loesung-C2e
# aktuelles Modell
# Residuen anschauen
fit$residuals

# Modell aus anderer Aufgabe
df2 <- data.frame(x = c( 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ),
                 y = c( 2, 5, 8, 11, 14, 17, 20, 23, 26, 29))

fit2 <- lm(y~x, data=df2)
fit2$residuals
```

Im aktuellen Modell sind die Residuen größer als im vorherigen Modell.  Somit ist das vorherige Modell besser.
:::




::: {.callout-tip}
## f) Berechnen Sie den linearen Bestimmungskoeffizient und den Korrelationskoeffizient. Ist das lineare Modell ein gutes Modell, um die Beziehung zwischen den gescheiterten Prüfungen und den täglichen Studienzeiten zu erklären? Wie viel Prozent der Variabilität der durchgefallenen Prüfungen wird durch das lineare Modell erklärt?

```{r}
#| label: Loesung-C2f
# aktuelles Modell
lernen <- summary(fit)
# R^2 anschauen
lernen$r.squared

# Korrelationskoeffizient
cor.test(df$Lernen, df$Durchgefallen)
```

Das Bestimmtheitsmaß $R^{2}$ beträgt `r lernen$r.squared`. Somit können `r round(lernen$r.squared*100,2)`% des Rauschens im aktuellen Modell erklärt werden.

Der Korrelationskoeffizient von `r cor(df$Lernen, df$Durchgefallen)` ist nahe an -1. Dies spricht für einen starken negativen Zusammenhang.
:::



::: {.callout-tip}
## g) Benutzen Sie das lineare Modell, um die Anzahl an durchgefallenen Prüfungen für einen Studenten zu bestimmen, der 3 Stunden Lernzeit investiert hat. Wie glaubwürdig ist die Vorhersage?

```{r}
#| label: Loesung-C2g
# aktuelles Modell
predict(fit, list(Lernen=3))
```
Wenn der Student 3 Stunden lernt, wird er wahrscheinlich "nur" durch 1 Kurs durchfallen. 
:::


::: {.callout-tip}
## h) Wie viele Stunden Lernzeit wird benötigt, um alle Kurse zu bestehen?

```{r}
#| label: Loesung-C2h
# neues Modell
fit <- lm(Lernen ~ Durchgefallen, data = df)
# Wieviel lernen für Durchgefallen=0?
predict(fit, list(Durchgefallen=0))
```
Wenn der Student 3 Stunden lernt, wird er wahrscheinlich "nur" durch 1 Kurs durchfallen. 
:::
























## Lösung zur Aufgabe [-@sec-C03] {#sec-LC03}
::: {.callout-tip}
## a)  Erstellen Sie ein Datenframe mit den Variablen `Minuten` und `Alkohol`.
```{r}
#| label: Loesung-C3a
# erzeuge Datenframe
df <- data.frame(Alkohol = c(1.6, 1.7, 1.5, 1.1, 0.7, 0.2, 2.1),
                 Minuten = c(30, 60, 90, 120, 150, 180, 210))
```
:::


::: {.callout-tip}
## b) Bestimmen Sie den passenden Korrelationskoeffizienten. Werden die Daten ausreichend gut durch das Modell beschrieben?
```{r}
#| label: Loesung-C3b
# Korrelation
cor(df$Minuten, df$Alkohol)
```
Der Korrelationskoeffizient ist eher gering. Das spricht für keinen starken Zusammenhang.
:::


::: {.callout-tip}
## c) Plotten Sie das lineare Regressionsmodell `Alkohol erklärt durch Minuten`. Gibt es Punkte mit großen Residuen? Wenn ja, entfernen Sie diese und führen die Berechnungen erneut durch. Hat sich der Korrelationskoeffizient verbessert?
```{r}
#| label: Loesung-C3c
#| layout-ncol: 2
#| warning: false
# plot()
plot(df$Minuten, df$Alkohol)
abline(lm(Alkohol ~ Minuten, data=df))

# ggplot()
ggplot(df, aes(x=Minuten, y=Alkohol)) +
  geom_point()+
  geom_smooth(method="lm", color="skyblue2") 
```

Der letzte Wert ist ein deutlicher Ausreißer, wahrscheinlich ein Tippfehler bei der Dateneingabe.
```{r}
#| label: Loesung-C3c2
# entferne letzten Wert
df <- df[-7,]
# Korrelation
cor(df$Minuten, df$Alkohol)
```

Der Korrelationskoeffizient ist nun sehr nah an -1. Das spricht für einen starken Zusammenhang.

```{r}
#| label: Loesung-C3c3
#| warning: false
#| layout-ncol: 2
# Modell
# plot()
plot(df$Minuten, df$Alkohol)
abline(lm(Alkohol ~ Minuten, data=df))

# ggplot()
ggplot(df, aes(x=Minuten, y=Alkohol)) +
  geom_point()+
  geom_smooth(method="lm", color="skyblue2") 
```

:::



::: {.callout-tip}
## d) Mit welcher Geschwindigkeit wird der Alkohol pro Minute verstoffwechselt?
```{r}
#| label: Loesung-C3d
# Koeffizienten
fit <- lm(Alkohol ~ Minuten, data=df)
fit$coefficient
```
Der Alkoholspiegel sinkt pro Minute um `r fit$coefficient[2]` g/l.

:::


::: {.callout-tip}
## e) Wenn es gesetzlich erlaubt wäre, mit einem Blutalkoholwert von $0,3$ g/l Auto zu fahren, wie lange muss die Person warten, nachdem sie $1$ Liter Weingetrunken hat, um wieder fahrtüchtig zu sein? Wie zuverlässig ist diese Vorhersage?
```{r}
#| label: Loesung-C3e
# Koeffizienten
fit <- lm(Minuten ~ Alkohol, data=df)
predict(fit, list(Alkohol=0.3))
```
Der Alkoholspiegel wird nach 180 Minuten auf $0,3$ g/l fallen.

:::




## Lösung zur Aufgabe [-@sec-C04] {#sec-LC04}
::: {.callout-tip}
## a) Laden Sie den Datensatz `age.height` in Ihre R-Session.
```{r}
#| label: Loesung-C4a
#| include: false
# lade Datensatz
load("data/age.height.RData")
```

```{r}
#| label: Loesung-C4a2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/age.height.RData"))
```
:::

::: {.callout-tip}
## b) Berechnen Sie die Regressionsgerade `Größe erklärt durch Alter`. Ist das lineare Modell geeignet, den Zusammenhang zwischen `Alter` und `Körpergröße` zu erklären?
```{r}
#| label: Loesung-C4b
# Regression
fit <- lm(height ~ age, data=age.height)
summary(fit)
```
R^2^ ist eher gering, es können nur `r round(summary(fit)$r.squared*100,2)`% des Rauschens mit dem Modell erklärt werden.
:::


::: {.callout-tip}
## c) Erstellen Sie eine Punktwolke inklusive der Regressionsgeraden. Ab welchem Alter ändert sich die Punktetendenz?
```{r}
#| label: Loesung-C4c
#| warning: false
#| layout-ncol: 2
# plot()
plot(age.height$age, age.height$height)
abline(fit)

# ggplot()
ggplot(age.height, aes(x=age, y=height)) +
  geom_point()+
  geom_smooth(method="lm", color="skyblue2") 

```
Ab etwa 20 Jahren ändert sich die Punktetendenz.
:::


::: {.callout-tip}
## d) Erstellen Sie eine Gruppierungsvariable, welche `Alter` in einen ordinalen Faktor mit den Ausprägungen "`jünger als 20`" und "`20 und älter`" einteilt.
```{r}
#| label: Loesung-C4d
# klassieren
age.height$ageK <- cut(age.height$age, 
                       breaks = c(0,20, Inf),
                       right=FALSE, 
                       labels = c("jünger als 20",
                                  "20 und älter"))
# anschauen

head(age.height)
```
:::


::: {.callout-tip}
## e) Führen Sie die lineare Regressionsanalyse für beide Gruppen erneut durch. In welcher Gruppe wird der Zusammenhang zwischen `Alter` und `Körpergröße` am besten erklärt?
```{r}
#| label: Loesung-C4e
# Gruppen
df1 <- subset(age.height, ageK=="jünger als 20")
# Regression
fit1 <- lm(height ~ age, data=df1)
summary(fit1)
```
Das Bestimmtheitsmaß in der Gruppe "jünger als 20" liegt bei `r summary(fit1)$r.squared`, d.h. es werden `r round(summary(fit1)$r.squared*100,2)`% des Rauschens erklärt.

```{r}
#| label: Loesung-C4e2
# Gruppen
df2 <- subset(age.height, ageK=="20 und älter")
# Regression
fit2 <- lm(height ~ age, data=df2)
summary(fit2)
```
Das Bestimmtheitsmaß in der Gruppe "20 und älter" liegt bei `r summary(fit2)$r.squared`, d.h. es werden `r round(summary(fit2)$r.squared*100,2)`% des Rauschens erklärt.
:::


::: {.callout-tip}
## f) Plotten Sie Ihre Modelle
```{r}
#| label: Loesung-C4f
#| warning: false
#| layout-ncol: 2
# < 20 Jahre
plot(df1$age, df1$height)
abline(fit1)
# >= 20 Jahre
plot(df2$age, df2$height)
abline(fit2)

## ggplot()
# < 20 Jahre
ggplot(df1, aes(x=age, y=height)) +
  geom_point() +
  geom_smooth(method="lm")
# >= 20 Jahre
ggplot(df2, aes(x=age, y=height)) +
  geom_point() +
  geom_smooth(method="lm")
```

:::



::: {.callout-tip}
## g) Welche Körpergröße sagt Ihr Modell für eine 14jährige Person vorher, und welche für eine 38jährige Person?
```{r}
#| label: Loesung-C4g
# 14 jährige Person
predict(fit1, list(age=14))
# 38 jährige Person
predict(fit2, list(age=38))
```

:::








## Lösung zur Aufgabe [-@sec-C05] {#sec-LC05}


```{r}
#| label: Loesung-C5setup
df <- data.frame(Jahr=c(1:5),
                 Wirksamkeit=c(96, 84, 70, 58, 52)
)
```

::: {.callout-tip}
## a) Führen Sie eine lineare Regression `Wirksamkeit erklärt durch Jahr` durch und plotten Sie Ihr Ergebnis.
```{r}
#| label: Loesung-C5a
# Regression
fit <- lm(Wirksamkeit~Jahr, data=df)
summary(fit)
```

```{r}
#| label: Loesung-C5a2
#| layout-ncol: 2
# plot()
plot(df$Jahr, df$Wirksamkeit)
abline(fit)
# ggplot()
ggplot(df, aes(x=Jahr, y=Wirksamkeit)) +
  geom_point() +
  geom_smooth(method="lm")
```
:::


::: {.callout-tip}
## b) Wie große ist der jährliche Wirksamkeitsverlust in \%?
```{r}
#| label: Loesung-C5b
# Regression
fit$coefficients
```
Der Wirksamkeitsverlust beträgt `r abs(fit$coefficients[2])`\% pro Jahr. 
:::



::: {.callout-tip}
## c) Nach wie vielen Jahren ist die Wirksamkeit bei 80%, und nach wie vielen bei 0%? Sind beide Werte gleich zuverlässig?
```{r}
#| label: Loesung-C5c
# anderes Modell
fit2 <- lm(Jahr ~ Wirksamkeit, data=df)
# 80% und 0%
predict(fit2, list(Wirksamkeit=c(80,0)))
```
Nach `r round(predict(fit2, list(Wirksamkeit=80)) ,2)` Jahren ist die Wirksamkeit bei 80\%, nach `r round(predict(fit2, list(Wirksamkeit=0)),2)` Jahren bei 0\%.
:::









## Lösung zur Aufgabe [-@sec-C06] {#sec-LC06}

```{r}
#| label: Loesung-C6setup

df <- data.frame(Dosis=c(2,2, 2,2,2,2, 
                         3,3, 3,3,3,3, 
                         3, 4,4,4,4,4, 4,4),
                 Tage =c(5,5, 6,6,6,6, 
                         3,3, 5,5,5,5, 
                         6, 3,3,3,3,3, 5,5))
```

::: {.callout-tip}
## a) Berechnen Sie die Regressionsgerade der Heilungstage in Abhängigkeit von der Dosis.
```{r}
#| label: Loesung-C6a
# Regression
fit <- lm(Tage~Dosis, data=df)
summary(fit)
```
:::

::: {.callout-tip}
## b) Berechnen Sie den Regressionskoeffizienten der Heilungstage in Abhängigkeit von der Dosis und interpretieren Sie ihn.
```{r}
#| label: Loesung-C6b
# Regression
fit$coefficients
```
Mit jeder Dosiserhöhung um 1 verkürzt sich die Heilungsdauer um ca. 1 Tag.
:::


::: {.callout-tip}
## c) Berechnen Sie den Korrelationskoeffizienten und interpretieren Sie ihn.
```{r}
#| label: Loesung-C6c
# Regression
cor(df$Dosis, df$Tage)
```
Der Korrelationskoeffizient ist größer als 0,5. Es liegt ein mittelstarker Zusammenhang vor.
:::

::: {.callout-tip}
## d) Bestimmen Sie die erwartete Zeit, die für die Heilung mit einer Dosis von 5 mg benötigt wird. Ist diese Vorhersage zuverlässig? Begründen Sie die Antwort.
```{r}
#| label: Loesung-C6d
# Vorhersage
predict(fit, list(Dosis=5))
```

:::

::: {.callout-tip}
## e) Welche Dosis muss angewendet werden, um in 4 Tagen zu heilen? Ist diese Vorhersage zuverlässig? Begründen Sie die Antwort.
```{r}
#| label: Loesung-C6e
# neues Modell
fit2 <- lm(Dosis~Tage, data=df)
# Vorhersage
predict(fit2, list(Tage=4))
```

:::



## Lösung zur Aufgabe [-@sec-C07] {#sec-LC07}
::: {.callout-tip}
## a) Laden Sie den Datensatz `heigths.weights.students` in Ihre R-Session.
```{r}
#| label: Loesung-C7a
#| include: false
# lade Datensatz
load("data/heights.weights.students.RData")
```

```{r}
#| label: Loesung-C7a2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/heights.weights.students.RData"))
```
:::


::: {.callout-tip}
## b) Führen Sie eine lineare Regression `Gewicht erklärt durch Größe` durch und plotten Sie Ihr Modell.
```{r}
#| label: Loesung-C7b
# Regression
fit <- lm(weight ~ height, data=heights.weights.students)
summary(fit)
```
```{r}
#| layout-ncol: 2
#| label: Loesung-C7b2
#| warning: false
# plot()
plot(heights.weights.students$height, heights.weights.students$weight)
abline(fit)

# ggplot()
ggplot(heights.weights.students, aes(x=height, y=weight)) +
  geom_point() +
  geom_smooth(method="lm")
```


:::



::: {.callout-tip}
## c) Erstellen Sie eine Punktwolke inklusive Regressionsgeraden jeweils für Männer und Frauen getrennt.
```{r}
#| label: Loesung-C7c
#| layout-ncol: 2
#| warning: false
m <- subset(heights.weights.students, sex=="male")
w <- subset(heights.weights.students, sex=="female")

fit1 <- lm(weight ~ height, data=m)
fit2 <- lm(weight ~ height, data=w)

## plot()
# männlich
plot(m$height, m$weight)
abline(fit1, col="royalblue")
# weiblich
plot(w$height, w$weight)
abline(fit2, col="pink")
## ggplot()
# männlich
ggplot(m, aes(x=height, y=weight))  +
  geom_point() +
  geom_smooth(method="lm", color="royalblue")
# weiblich
ggplot(w, aes(x=height, y=weight))  +
  geom_point() +
  geom_smooth(method="lm", color="pink")
```
:::


::: {.callout-tip}
## d) Berechnen Sie die Bestimmtheitskoeffizienten (R^2^) für beide Modelle. Welches Modell erklärt besser die Beziehung zwischen Gewicht und Größe, das der Männer oder das der Frauen? Begründen Sie die Antwort.
```{r}
#| label: Loesung-C7d
#| warning: false
# Männer
summary(fit1)$r.squared
# Frauen
summary(fit2)$r.squared

```
Das Modell der Männer erklärt `r round(summary(fit1)$r.squared,2)`\% der Streuung, und das der Frauen "nur"  `r round(summary(fit2)$r.squared,2)`\%. Somit ist das Modell für Männer *besser* als das der Frauen.
:::


::: {.callout-tip}
## e) Was ist das zu erwartende Gewicht für einen Mann mit 170cm Körpergröße? Und für eine Frau der selben Größe?
```{r}
#| label: Loesung-C7e
#| warning: false
# Männer
predict(fit1, list(height=170))
# Frauen
predict(fit2, list(height=170))

```

:::




## Lösung zur Aufgabe [-@sec-C08] {#sec-LC08}

```{r}
#| label: Loesung-C8setup
#| include: false
# lade Datensatz
load("data/neonates.RData")
```

```{r}
#| label: Loesung-C8setup2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/neonates.RData"))
```

::: {.callout-tip}
## a) Erstellen Sie eine Kreuztabelle vom APGAR-Wert nach 1 Minute und dem Rauchverhalten der Mütter während der Schwangerschaft. Welche Schlüsse lassen sich ziehen?
```{r}
#| label: Loesung-C8a
# entweder
table(neonates$smoke, neonates$apgar1)
# oder
xtabs(~ smoke + apgar1, data=neonates)
```

Kinder von Frauen, die nicht während der Schangerschaft rauchen, haben höhere APGAR1-Werte als Kinder von Raucherinnen.

:::

::: {.callout-tip}
## b) Erstellen Sie eine Kreuztabelle vom APGAR-Wert nach 1 Minute und der Alterskategorie der Mütter. Welche Schlüsse lassen sich ziehen?
```{r}
#| label: Loesung-C8b
# entweder
table(neonates$age, neonates$apgar1)
# oder
xtabs(~ age + apgar1, data=neonates)
```

Kinder von Frauen, die älter als 20 Jahre sind, haben höhere APGAR1-Werte als Kinder von jüngeren Müttern.

:::

::: {.callout-tip}
## c) Führen Sie eine lineare Regression für `Geburtsgewicht erklärt durch Anzahl täglich gerauchter Zigaretten` durch. Gibt es einen starken linearen Zusammenhang?
```{r}
#| label: Loesung-C8c
# Regression
fit <- lm(weight ~ cigarettes, data=neonates)
summary(fit)
```
 Der Zusammenhang ist eher gering.

:::

::: {.callout-tip}
## d) Plotten Sie Ihre Regression. Passt die Regressionsgerade gut zur Punktwolke?
```{r}
#| label: Loesung-C8d
#| layout-ncol: 2
#| warning: false
# plot()
plot(neonates$cigarettes, neonates$weight)
abline(fit)
# ggplot()
ggplot(neonates, aes(x=cigarettes, y=weight))  +
  geom_point() +
  geom_smooth(method="lm", color="pink")
```
 Der Zusammenhang wird durch die Nichtraucherinnen (0 Zigaretten) verzerrt.

:::





::: {.callout-tip}
## e) Wiederholen Sie die Regression, aber nutzen Sie dieses Mal nur Daten von Raucherinnen. Ist dieses Modell besser oder schlechter als das vorherige? Wieviel Gewicht verliert ein Neugeborenes nach diesem Modell pro täglich gerauchter Zigarette?
```{r}
#| label: Loesung-C8e
# Subset erzeugen
smoke <- subset(neonates, smoke=="Yes")
# Regression
fit2 <- lm(weight ~ cigarettes, data=smoke)
summary(fit2)
```

```{r}
#| label: Loesung-C8ePlot
#| layout-ncol: 2
#| warning: false
# plot()
plot(smoke$cigarettes, smoke$weight)
abline(fit2)
# ggplot()
ggplot(smoke, aes(x=cigarettes, y=weight))  +
  geom_point() +
  geom_smooth(method="lm", color="pink")
```
 Der Zusammenhang ist nun sehr stark.

:::




::: {.callout-tip}
## f) Welches Geburtsgewicht sagt dieses Modell für ein Neugeborenes vorher, dessen Mutter 5 Zigaretten täglich während der Schwangerschaft geraucht hat? Wieviel für eine Mutter, die 30 Zigaretten täglich raucht. Wie zuverlässich sind diese Ergebnisse?
```{r}
#| label: Loesung-C8f
# Vorhersage
predict(fit2, list(cigarettes=c(5, 30)))
```

:::



::: {.callout-tip}
## g) Ändert sich der lineare Zusammenhang, wenn die Daten nach Altersgruppen getrennt untersucht werden?
```{r}
#| label: Loesung-C8g
# Subset
s1 <- subset(smoke, age=="greater than 20")
s2 <- subset(smoke, age=="less than 20")

# neue Modelle
fit1 <- lm(weight ~ cigarettes, data=s1)
fit1 <- lm(weight ~ cigarettes, data=s2)

# vergleichen
summary(fit1)
summary(fit2)
```
Der Zusammenhang bleibt unabhängig von der Altersgruppe bestehen.
:::









## Lösung zur Aufgabe [-@sec-D01] {#sec-LD01}

::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit den Variablen `Stunden` und `Bakterien`.
```{r}
#| label: Loesung-D1a
# Daten erzeugen
df <- data.frame(Stunden=c(1:9),
                 Bakterien=c(25, 28, 47, 65, 86, 121, 190, 290, 362))
```
:::


::: {.callout-tip}
## b) Erzeugen Sie ein Scatterplot. Welche Regression würden Sie auf Grundlage des Plots vorschlagen?
```{r}
#| label: Loesung-D1b
#| layout-ncol: 2
#| warning: false
# plot()
plot(df$Stunden, df$Bakterien)

# ggplot()
ggplot(df, aes(x=Stunden, y=Bakterien)) +
  geom_point()
```
Die Punktwolken sprechen für einen exponentiellen Anstieg.
:::



::: {.callout-tip}
## c) Berechnen Sie die quadratischen und exponentiellen Modelle für die Bakterienvermehrung über die Zeit.
```{r}
#| label: Loesung-D1c
# quadratisch
q <- lm(Bakterien ~ Stunden + I(Stunden^2), data=df)
summary(q)

# exponentiell
e <- lm(log(Bakterien) ~ Stunden, data=df)
summary(e)
```
:::


::: {.callout-tip}
## d) Plotten Sie das bessere Modell in die Punktwolke.
```{r}
#| label: Loesung-D1d
#| layout-ncol: 2
#| warning: false
# Vorbereitung quadratisch
vorhersageQ <- predict(q, list(Stunden=df$Stunden))
# plot() quadratisch
plot(df$Stunden, df$Bakterien, 
     main="quadratischer Zusammenhang")
lines(df$Stunden, vorhersageQ, col="tan4")

# ggplot() quadratisch
ggplot(df, aes(x=Stunden, y=Bakterien)) + 
  geom_point() +
  geom_line(aes(y=vorhersageQ), col="tan4")


# Vorbereitung exponentiell
vorhersageE <- exp(predict(e, list(Stunden=df$Stunden)))

# plot() exponentiell
plot(df$Stunden, df$Bakterien, 
     main="exponentieller Zusammenhang")
lines(df$Stunden, vorhersageE, col="wheat")

# ggplot() exponentiell
ggplot(df, aes(x=Stunden, y=Bakterien)) + 
  geom_point() +
  geom_line(aes(y=vorhersageE), col="wheat")

```
:::


::: {.callout-tip}
## e) Wie viele Bakterien werden nach dem besten Modell 3 Stunden nach Anlegen der Kultur vorhanden sein? Und nach 10 Stunden? Sind diese Vorhersagen zuverlässig?
```{r}
#| label: Loesung-D1e
# Vorhersage
exp(predict(e, list(Stunden=c(3, 10))))
```
Nach 3 Stunden können wir `r ceiling(exp(predict(e, list(Stunden=c(3)))))` Bakterien erwarten, nach 10 Stunden `r ceiling(exp(predict(e, list(Stunden=c(10)))))`. 
:::


::: {.callout-tip}
## f) Machen Sie eine möglichst zuverlässige Vorhersage über die Zeit, die benötigt wird, um 100 Bakterien in der Kultur zu haben.
```{r}
#| label: Loesung-D1f
# neues Modell
df$BakterienLog <- log(df$Bakterien)
fit <- lm(BakterienLog ~ Stunden, data=df)
a <- exp(fit$coefficients[1])
b <- fit$coefficients[2]
# Vorhersage für 100 Bakterien
(log(100) - log(a)) / b
``` 
Nach ca `r round((log(100) - log(a)) / b  ,1)` Stunden sind 100 Bakterien zu erwarten.

:::





## Lösung zur Aufgabe [-@sec-D02] {#sec-LD02}

::: {.callout-tip}
## a) Laden Sie den Datensatz `diet` in Ihre R-Session.

```{r}
#| label: Loesung-D2a
#| include: false
# lade Datensatz
load("data/diet.RData")
```

```{r}
#| label: Loesung-D2asetup2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/diet.RData"))
```


:::



::: {.callout-tip}
## b) Erstellen Sie eine Punktwolke. Welche Art von Modell erklärt auf Grundlage der Punktwolke den Gewichtsverlust pro Diättag besser?

```{r}
#| label: Loesung-D2b
#| layout-ncol: 2
#| warning: false
# plot()
plot(diet$days, diet$weight.loss)
# ggplot()
ggplot(diet, aes(x=days, y=weight.loss)) +
  geom_point()
```


:::



::: {.callout-tip}
## c) Berechnen Sie das Regressionsmodell, welches den Gewichtsverlust mit der Anzahl an Diättagen am besten (im Vergleich zu anderen) erklären kann. Wird das Modell zuverlässige Vorhersagen machen?

```{r}
#| label: Loesung-D2c
# Vergleiche Bestimmheitsmaße verschiedener Modelle

# quadratisches Modell
q <- lm(weight.loss ~ days + I(days^2), data=diet)

# exponentielles Modell
e <- lm (log(weight.loss) ~ days, data=diet)

# logarithmisches Modell
l <- lm(weight.loss ~ log(days), data=diet)

# sigmoidales Modell
s <- lm(log(weight.loss) ~ I(1/days), data=diet)

result <- data.frame(Modell = c("quadratisch", "exponentiell",
                                "logarithmisch", "sigmoidal"),
                     R.square = c(summary(q)$r.square,
                                 summary(e)$r.square,
                                 summary(l)$r.square,
                                 summary(s)$r.square))
# Anzeigen
result[order(result$R.square, decreasing = TRUE),]
```
Das sigmoidale Modell kann die Daten am besten erklären, da in diesem Modell das Bestimmtheitsmaß am größten ist.

:::


::: {.callout-tip}
## d) Plotten Sie Ihr Modell.

```{r}
#| label: Loesung-D2d
#| layout-ncol: 2
# sigmoidales Modell
s <- lm(log(weight.loss) ~ I(1/days), data=diet)

# vorhersage vorbereiten
tage <- seq(min(diet$days), max(diet$days))
# alle "tage" vorhersagen
vorhersage <- predict(s, list(days=tage))
vorhersage[-1]=exp(vorhersage[-1])

# plot()
plot(diet$days, diet$weight.loss)
lines(tage, vorhersage, col="purple")

# ggplot()
# in Datenframe für ggplot speichern
helper <- data.frame(tage, vorhersage)

ggplot(diet, aes(x=days, y=weight.loss)) + 
  geom_point(color="#FF9999", size=3) +
	# Legend
	scale_linetype("Regression model") +
	# Sigmoidal model
	geom_line(data=helper, aes(x=tage, y=vorhersage, linetype="Sigmoidal"))
```


Auch die Vorhersagewerte für die Idealkurve können mittels `compare.lm()` und dem Parameter `predict=TRUE` erzeugt werden.
```{r}
#| label: Loesung-D2d2
help <- jgsbook::compare.lm(diet$weight.loss, diet$days, 
                            predict=TRUE)

# anschauen                            
head(help)
```

```{r}
#| label: Loesung-D2d3
#| layout-ncol: 2
# plot()
plot(diet$days, diet$weight.loss)
lines(help$pred.x, help$sigm, col="purple")

# ggplot()
ggplot(diet, aes(x=days, y=weight.loss)) + 
  geom_point(color="#FF9999", size=3) +
	# Legend
	scale_linetype("Regression model") +
	# Sigmoidal model
	geom_line(data=help, aes(x=pred.x, y=sigm, linetype="Sigmoidal"))
```


:::



::: {.callout-tip}
## e) Berechnen Sie das Regressionsmodell, das den Gewichtsverlust anhand der Tage der Diät für die Gruppe der Personen, die sich nicht regelmäßig körperlich betätigen, am besten erklärt.

```{r}
#| label: Loesung-D2e
# Subset bilden
df1 <- subset(diet, exercise=="no")

# Vergleiche Bestimmheitsmaße verschiedener Modelle

# quadratisches Modell
q1 <- lm(weight.loss ~ days + I(days^2), data=df1)

# exponentielles Modell
e1 <- lm (log(weight.loss) ~ days, data=df1)

# logarithmisches Modell
l1 <- lm(weight.loss ~ log(days), data=df1)

# sigmoidales Modell
s1 <- lm(log(weight.loss) ~ I(1/days), data=df1)

result1 <- data.frame(Modell = c("quadratisch", "exponentiell",
                                 "logarithmisch", "sigmoidal"),
                     R.square = c(summary(q1)$r.square,
                                  summary(e1)$r.square,
                                  summary(l1)$r.square,
                                  summary(s1)$r.square))
result1[order(result1$R.square, decreasing = TRUE),]

# oder mittels compare.lm()
jgsbook::compare.lm(df1$weight.loss, df1$days)
```
Das sigmoidale Modell liefert wieder die beste Erklärung der Daten.
:::


::: {.callout-tip}
## f) Wiederholen Sie die Analyse für die Gruppe, die sich regelmäßig körperlich betätigt.

```{r}
#| label: Loesung-D2f
# Subset bilden
df2 <- subset(diet, exercise=="yes")

# Vergleiche Bestimmheitsmaße verschiedener Modelle

# quadratisches Modell
q2 <- lm(weight.loss ~ days + I(days^2), data=df2)

# exponentielles Modell
e2 <- lm (log(weight.loss) ~ days, data=df2)

# logarithmisches Modell
l2 <- lm(weight.loss ~ log(days), data=df2)

# sigmoidales Modell
s2 <- lm(log(weight.loss) ~ I(1/days), data=df2)

result2 <- data.frame(Modell = c("quadratisch", "exponentiell",
                                 "logarithmisch", "sigmoidal"),
                     R.square = c(summary(q2)$r.square,
                                  summary(e2)$r.square,
                                  summary(l2)$r.square,
                                  summary(s2)$r.square))
result2[order(result1$R.square, decreasing = TRUE),]

# oder mittels compare.lm()
jgsbook::compare.lm(df2$weight.loss, df2$days)
```
Das kubische Modell liefert hier die beste Erklärung der Daten.
:::



::: {.callout-tip}
## g) Benutzen Sie die erstellen Modelle, um den Gewichtsverlust nach 30 und nach 100 Tagen Diät für Personen, die sich körperlich betätigen, und für solche, die dies nicht tun, vorherzusagen. Sind diese Vorhersagen zuverlässig?

```{r}
#| label: Loesung-D2g
# Vorhersage Kein Sport
exp(predict(s1, list(days=c(30,100))))

# Vorhersage Sport
exp(predict(s2, list(days=c(30,100))))
```
:::





## Lösung zur Aufgabe [-@sec-D03] {#sec-LD03}

```{r}
#| label: Loesung-D3setupa
df <- data.frame(Stunden = c(2:8),
                 Konzentration = c(25, 36, 48, 64, 86, 114, 168))
```


::: {.callout-tip}
## a) Benutzen Sie ein exponentielles Modell, um die Konzentration nach 10 Stunden vorherzusagen. Ist die Vorhersage zuverlässig?

```{r}
#| label: Loesung-D3a
# exponentielles Modell
fit <- lm(log(Konzentration) ~ Stunden, data=df)
summary(fit)

# Vorhersage 10 Stunden
exp(predict(fit, list(Stunden=10)))
```

Nach 10 Stunden beträgt die Konzentration 298,94 mg/dl. 

Das Bestimmtheitsmaß R^2^ des Modells ist mit 0,9979 sehr groß. Die Daten werden sehr gut durch das Modell erklärt.

:::

::: {.callout-tip}
## b) Benutzen Sie ein logarithmisches Modell um zu bestimmen, nach wie vielen Stunden eine Konzentration von 100 mg/dl erreicht sein wird.

```{r}
#| label: Loesung-D3b
# exponentielles Modell
fit <- lm(log(Konzentration) ~ Stunden, data=df)

# coefficienten
a <- fit$coefficient[1]
b <- fit$coefficient[2]

# Vorhersage 100 mg/dl
( log(100) - a ) / b

```

Nach 6,436209 Stunden sind 100 mg/dl erreicht. 

:::






## Lösung zur Aufgabe [-@sec-E01] {#sec-LE01}

::: {.callout-tip}
## a) Lassen Sie in R  eine beliebige Poker-Spielkarte ziehen.

```{r}
#| label: Loesung-E1a
# lade Kartenspiele
load(url("https://www.produnis.de/R/data/cards.RData"))

# ziehe Karte
sample(poker, 1)

# alternativ kann das 'probs'-Paket verwendet werden
karten <- probs::cards(makespace=TRUE)
probs::sim(karten, ntrials=1)
```

:::

::: {.callout-tip}
## b) Lassen Sie in R 2 Münzen werfen.
```{r}
#| label: Loesung-E1bSetup
#| include: false
set.seed(1904)
```


```{r}
#| label: Loesung-E1b
# lade Datensatz
coin <- c("Kopf", "Zahl")

# wirf 2 Münzen
sample(coin, 2, replace=TRUE)

# alternativ kann das 'probs'-Paket verwendet werden
coin <- probs::tosscoin(2, makespace=TRUE)
probs::sim(coin, ntrials=1)
```

:::



::: {.callout-tip}
## c) Lassen Sie in R 2 Würfel werfen.

```{r}
#| label: Loesung-E1c
# lade Datensatz
würfel <- c(1:6)

# wirf 2 Münzen
sample(würfel, 2, replace=TRUE)

# alternativ kann das 'probs'-Paket verwendet werden
würfel <- probs::rolldie(2, makespace=TRUE)
probs::sim(würfel, ntrials=1)
```

:::









## Lösung zur Aufgabe [-@sec-E02] {#sec-LE02}

::: {.callout-tip}
## a) Wiederholen Sie die Zufallsexperimente und lassen Sie R $10$ mal, $100$ mal $1.000$ mal und $1.000.000$ mal zwei Münzen werfen. Erstellen Sie je eine relative Häufigkeitstabelle der Ergebnisse. Wie sind die Tabellen zu bewerten?

```{r}
#| label: Loesung-E2a
# erzeuge Wahrscheinlichkeitsraum
münzen <- probs::tosscoin(2, makespace=TRUE)

# werfe 10mal 2 Münzen
versuch <- probs::sim(münzen, ntrials=10)
# berechne Wahrscheinlichkeitsverteilung
probs::empirical(versuch)

# werfe 100mal 2 Münzen
versuch <- probs::sim(münzen, ntrials=100)
# berechne Wahrscheinlichkeitsverteilung
probs::empirical(versuch)

# werfe 1.000mal 2 Münzen
versuch <- probs::sim(münzen, ntrials=1000)
# berechne Wahrscheinlichkeitsverteilung
probs::empirical(versuch)

# werfe 1.000.000mal 2 Münzen
versuch <- probs::sim(münzen, ntrials=1000000)
# berechne Wahrscheinlichkeitsverteilung
probs::empirical(versuch)
```
Mit zunehmender Wiederholung nähern sich die Wahrscheinlichkeitsverteilungen den relativen Häufigkeiten an.
:::


::: {.callout-tip}
## b) Welche theoretischen Wahrscheinlichkeiten haben die möglichen Wurfergebnisse? Stimmen diese mit den beobachteten Ergebnissen überein?
Je häufiger das Zufallsexperiment wiederholt wird, desto mehr nähern sich die beobachteten Wahrscheinlichkeiten den theoretischen Wahrscheinlichkeiten an.
:::







## Lösung zur Aufgabe [-@sec-E03] {#sec-LE03}

::: {.callout-tip}
##  a) Ziehen Sie zufällig 3 Boxen, ohne zurücklegen.

```{r}
#| label: Loesung-E3a
boxen <- c("A", "A", "A", "B", "B", "C")

# ziehe 3 Boxen ohne Zurücklegen
sample(boxen, 3, replace=FALSE)

```
:::

::: {.callout-tip}
##   Ziehen Sie zufällig 3 Boxen, diesmal mit zurücklegen.

```{r}
#| label: Loesung-E3b
boxen <- c("A", "A", "A", "B", "B", "C")

# ziehe 3 Boxen ohne Zurücklegen
sample(boxen, 3, replace=TRUE)

```
:::






## Lösung zur Aufgabe [-@sec-E04] {#sec-LE04}

::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit den Variablen `Windpocken`, `Masern`, `Röteln` und `Häufigkeit` und übertragen Sie die Daten.

```{r}
#| label: Loesung-E4a
df <- tribble(
  ~Windpocken, ~Masern, ~Röteln, ~Häufigkeit,
  "No",        "No",    "No",    2654,
  "No",        "No",    "Yes",   1436,
  "No",        "Yes",   "No",    1682,
  "No",        "Yes",   "Yes",   668,
  "Yes",       "No",    "No",    1747,
  "Yes",       "No",    "Yes",   476,
  "Yes",       "Yes",   "No",    876,
  "Yes",       "Yes",   "Yes",   265
)

```
:::


::: {.callout-tip}
## b) Erstellen Sie den Wahrscheinlichkeitsraum der Lebenszeitprävalenz.

```{r}
#| label: Loesung-E4b
# Wahrscheinlichkeitsraum
wr <- probs::probspace(df[,-4], probs=df$Häufigkeit/sum(df$Häufigkeit))
wr
# Erstelle daraus die marginale Verteilung
probs::marginal(wr)
```
:::


::: {.callout-tip}
## c) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Windpocken hatte?

```{r}
#| label: Loesung-E4c
# Wahrscheinlichkeitsraum
wr <- probs::probspace(df[,-4], probs=df$Häufigkeit/sum(df$Häufigkeit))
# berechne Wahrscheinlichkeit
probs::Prob(wr, event=Windpocken=="Yes")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr, event=Windpocken=="Yes")*100 ,2)`\%.
:::


::: {.callout-tip}
## d) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Windpocken oder Masern hatte?

```{r}
#| label: Loesung-E4d
# berechne Wahrscheinlichkeit
probs::Prob(wr, event=Windpocken=="Yes" | Röteln=="Yes")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr, event=Windpocken=="Yes" | Röteln=="Yes")*100 ,2)`\%.
:::


::: {.callout-tip}
## e) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person Masern und Röteln hatte?

```{r}
#| label: Loesung-E4e
# berechne Wahrscheinlichkeit
probs::Prob(wr, event=Masern=="Yes" & Röteln=="Yes")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr, event=Masern=="Yes" & Röteln=="Yes")*100 ,2)`\%.
:::


::: {.callout-tip}
## f) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person, die bereits an Masern erkrankte, nun an Windpocken erkrankt?

```{r}
#| label: Loesung-E4f
# berechne Wahrscheinlichkeit
probs::Prob(wr, event=Windpocken=="Yes", given= Masern=="Yes")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr, event=Windpocken=="Yes", given= Masern=="Yes")*100 ,2)`\%.
:::



::: {.callout-tip}
## g) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig gezogene Person, die keine Masern und keine Röteln hatte, an Windpocken erkrankt?

```{r}
#| label: Loesung-E4g
# berechne Wahrscheinlichkeit
probs::Prob(wr, event=Masern=="No" & Röteln=="No", 
                given= Windpocken=="Yes")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr, event=Masern=="No" & Röteln=="No", given= Windpocken=="Yes")*100 ,2)`\%.
:::







## Lösung zur Aufgabe [-@sec-E05] {#sec-LE05}

::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit den Variablen `Schwanger`, `Testergebnis` und `Häufigkeit`.

```{r}
#| label: Loesung-E5a
df <- tribble(
  ~Schwanger, ~Test, ~Häufigkeit,
    "Nein", "-",   3876,
    "Nein", "+",  47,
    "Ja", "-",  12,
    "Ja", "+", 131
)

```
:::


::: {.callout-tip}
## b) Erstellen Sie den Wahrscheinlichkeitsraum.

```{r}
#| label: Loesung-E5b
# Wahrscheinlichkeitsraum
wr <- probs::probspace(df[,-3], probs=df$Häufigkeit/sum(df$Häufigkeit))
wr
# Erstelle daraus die marginale Verteilung
probs::marginal(wr)
   
```
:::


::: {.callout-tip}
## c) Berechnen Sie die Prävalenz der Schwangerschaften.

```{r}
#| label: Loesung-E5c
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Schwanger=="Ja")
   
```
Die Prävalenz liegt bei `r round(probs::Prob(wr, event=Schwanger=="Ja") *100,2)`\%.
:::


::: {.callout-tip}
## d) Wie groß ist die Wahrscheinlichkeit, ein positives Testergebnis zu ziehen?

```{r}
#| label: Loesung-E5d
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Test=="+")
   
```
Die Wahrscheinlichkeit liegt bei `r round(probs::Prob(wr, event=Test=="+") *100,2)`\%.
:::

::: {.callout-tip}
## e) Bestimmen Sie die Sensitivität des Tests

```{r}
#| label: Loesung-E5e
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Test=="+", given= Schwanger=="Ja")
   
```
Die Sensitivität liegt bei `r round(probs::Prob(wr, event=Test=="+", given= Schwanger=="Ja") *100,2)`\%.
:::




::: {.callout-tip}
## f) Bestimmen Sie die Spezifität des Tests

```{r}
#| label: Loesung-E5f
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Test=="-", given= Schwanger=="Nein")
   
```
Die Spezifität liegt bei `r round(probs::Prob(wr, event=Test=="-", given= Schwanger=="Nein") *100,2)`\%.

:::


::: {.callout-tip}
## g) Bestimmen Sie den positiv prädiktiven Wert des Tests

```{r}
#| label: Loesung-E5g
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Schwanger=="Ja", given=Test=="+")
   
```
Der positiv prädiktive Wert liegt bei `r round(probs::Prob(wr, event=Schwanger=="Ja", given=Test=="+") *100,2)`\%.

:::


::: {.callout-tip}
## h) Bestimmen Sie den negativ prädiktiven Wert des Tests

```{r}
#| label: Loesung-E5h
# Wahrscheinlichkeitsraum
probs::Prob(wr, event=Schwanger=="Nein", given=Test=="-")
   
```
Der negative prädiktive Wert liegt bei `r round(probs::Prob(wr, event=Schwanger=="Nein", given=Test=="-") *100,2)`\%.

:::




::: {.callout-caution appearance="simple"}
Alternativ kann auch die Funktion `sens.spec()` aus dem Paket `jgsbook` verwendet werden:
```{r}
#| label: Loesung-E5Zusatz
jgsbook::sens.spec(rp=131, fp=12, rn=3876, fn=47)
```

:::






## Lösung zur Aufgabe [-@sec-E06] {#sec-LE06}

::: {.callout-tip}
## Erstelle den Ereignisraum des Zufallsexperiments, das aus dem Werfen einer Münze, dem Werfen eines Würfels und dem Ziehen einer Karte aus einem französischen Kartenspiel besteht.

```{r}
#| label: Loesung-E6a
würfel <- 1:6
münze <- c("Kopf", "Zahl")
bild <- c(7:10 ,"B", "D", "K", "A")
farbe <- c("Kreuz", "Pik", "Karo", "Herz")

Ereignisraum <- expand.grid(Münze=münze, Bild=bild, 
                            Farbe=farbe, Würfel=würfel)
head(Ereignisraum)
```
:::







## Lösung zur Aufgabe [-@sec-E07] {#sec-LE07}

```{r}
#| label: Loesung-E7setup
df <- tribble(
  ~Impfung, ~Grippe, ~Häufigkeit,
   "Nein",   "Nein",   418,
   "Nein",    "Ja",    312,
   "Ja",     "Nein",   233,
   "Ja",     "Ja",   37)

```

::: {.callout-tip}
## a) Erzeugen Sie den Wahrscheinlichkeitsraum 

```{r}
#| label: Loesung-E7a
wr <- probs::probspace(df[,-3],probs=df$Häufigkeit/sum(df$Häufigkeit))
wr
# Erstelle daraus die marginale Verteilung
probs::marginal(wr)
```
:::

::: {.callout-tip}
## b) Wie groß ist die Wahrscheinlichkeit, dass eine zufällig ausgewählte Person geimpft ist?

```{r}
#| label: Loesung-E7b
probs::Prob(wr,event=Impfung=="Ja")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr,event=Impfung=="Ja")*100,2)`\%.
:::


::: {.callout-tip}
## c) Wie hoch ist die Prävalenz der Grippe?

```{r}
#| label: Loesung-E7c
probs::Prob(wr,event=Grippe=="Ja")
```
Die Prävalenz beträgt `r round(probs::Prob(wr,event=Grippe=="Ja")*100,2)`\%.
:::


::: {.callout-tip}
## d) Wie groß ist die Wahrscheinlichkeit, dass geimpfte Personen an Grippe erkranken? Ist die Impfung effektiv?

```{r}
#| label: Loesung-E7d
probs::Prob(wr,event=Grippe=="Ja", given=Impfung=="Ja")
```
Die Wahrscheinlichkeit beträgt `r round(probs::Prob(wr,event=Grippe=="Ja", given=Impfung=="Ja")*100,2)`\%.
:::







## Lösung zur Aufgabe [-@sec-E08] {#sec-LE08}

```{r}
#| label: Loesung-E8setup
df <- tribble(
  ~Ebola, ~Test, ~Häufigkeit,
   "Nein",   "+",   28,
   "Nein",    "-",    97465,
   "Ja",     "+",   147,
   "Ja",     "-",   65)


```

::: {.callout-tip}
## a) Erzeugen Sie den Wahrscheinlichkeitsraum 

```{r}
#| label: Loesung-E8a
wr <- probs::probspace(df[,-3],probs=df$Häufigkeit/sum(df$Häufigkeit))
wr
# Erstelle daraus die marginale Verteilung
probs::marginal(wr)
```
:::


::: {.callout-tip}
## b) Berechnen Sie die Prävalenz von Ebola in der Bevölkerung.

```{r}
#| label: Loesung-E8b
probs::Prob(wr,event=Ebola=="Ja")
```
Die Prävalenz beträgt `r round(probs::Prob(wr,event=Ebola=="Ja")*100,2)`\%.
:::


::: {.callout-tip}
## c) Wie hoch ist die Wahrscheinlichkeit, ein negatives Testergebnis zu erhalten?

```{r}
#| label: Loesung-E8c
probs::Prob(wr,event=Test=="-")
```
Die Prävalenz beträgt `r round(probs::Prob(wr,event=Test=="-")*100,2)`\%.
:::

::: {.callout-tip}
## d) Berechnen Sie die Sensitivität und Spezifität des Tests.

```{r}
#| label: Loesung-E8d
# entweder 
# Sensitivität
probs::Prob(wr,event=Test=="+", given=Ebola=="Ja")
# Spezifität
probs::Prob(wr,event=Test=="-", given=Ebola=="Nein")

# oder
jgsbook::sens.spec(fp=28, rn=97465, rp=147, fn=65)
```
:::



::: {.callout-tip}
## e) Kann der Test besser Erkrankte erkennen, oder Gesunde?

```{r}
#| label: Loesung-E8e
jgsbook::sens.spec(fp=28, rn=97465, rp=147, fn=65)
```
Er kann besser Gesunde erkennen.
:::





::: {.callout-tip}
## f) Wenn eine Person einen positiven Test erhält, wie hoch ist dann die Wahrscheinlichkeit, dass er tatsächlich krank ist?

```{r}
#| label: Loesung-E8f
# positiv prädiktiv
probs::Prob(wr,event=Ebola=="Ja", given=Test=="+")
```
Die Wahrscheinlichkeit liegt bei `r round(probs::Prob(wr,event=Ebola=="Ja", given=Test=="+") *100,2)`\%.
:::



::: {.callout-tip}
## g) Wenn eine Person einen negativen Test erhält, wie hoch ist dann die Wahrscheinlichkeit, dass er tatsächlich gesund ist?

```{r}
#| label: Loesung-E8g
# negativ prädiktiv
probs::Prob(wr,event=Ebola=="Nein", given=Test=="-")
```
Die Wahrscheinlichkeit liegt bei `r round(probs::Prob(wr,event=Ebola=="Nein", given=Test=="-") *100,2)`\%.

:::









## Lösung zur Aufgabe [-@sec-F01] {#sec-LF01}

::: {.callout-tip}
## a) Berechnen Sie die Wahrscheinlichkeitsverteilung von `X`

```{r}
#| label: Loesung-F1a
# mögliche Ausprägungen von x
x <- 0:10
# Wahrscheinlichkeiten berechnen
w <- dbinom(x, size = 10, prob = 0.50)

data.frame(Kopf=x, Wahrscheinlichkeit = w)

```
:::


::: {.callout-tip}
## b) Plotten Sie die Wahrscheinlichkeitsfunktion von `X` 

```{r}
#| label: Loesung-F1b
#| layout-ncol: 2
# mögliche Ausprägungen von x
x <- 0:10
df = data.frame(x, y=dbinom(x, size = 10, prob = 0.50))

# plot()
plot(df$x, df$y)

# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point()
```
:::



::: {.callout-tip}
## c) Plotten Sie die Dichteverteilung

```{r}
#| label: Loesung-F1c
#| layout-ncol: 2
# mögliche Ausprägungen von x
x <- 0:10
df = data.frame(x, y=pbinom(x, size = 10, prob = 0.50))

# plot()
plot(df$x, df$y)

# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point()
```
:::







::: {.callout-tip}
## d) Berechnen Sie die Wahrscheinlichkeit, 7 mal `Kopf` zu werfen.

```{r}
#| label: Loesung-F1d
dbinom(7, size = 10, prob = 0.50)
```
:::


::: {.callout-tip}
## e) Berchnen Sie die Wahrscheinlichkeit, weniger als als 4 mal `Kopf` zu werfen.

```{r}
#| label: Loesung-F1e
pbinom(4, size = 10, prob = 0.50, lower.tail=TRUE)
```
:::


::: {.callout-tip}
## f) Berchnen Sie die Wahrscheinlichkeit, mehr als als 5 mal `Kopf` zu werfen.

```{r}
#| label: Loesung-F1f
pbinom(5, size = 10, prob = 0.50, lower.tail=FALSE)
```
:::

::: {.callout-tip}
## g) Berechnen Sie die Wahrscheinlichkeit, 2 bis 8 mal `Kopf` zu werfen.

```{r}
#| label: Loesung-F1g
# weniger als 2mal
w2 <- pbinom(1, size = 10, prob = 0.5)
# weniger als 8mal
w8 <- pbinom(8, size = 10, prob = 0.5)

# Wahrscheinlichkeit 2 bis 8 Köpfe zu werfen
w8 - w2

```
:::





## Lösung zur Aufgabe [-@sec-F02] {#sec-LF02}

::: {.callout-tip}
## a) Plotten Sie die Wahrscheinlichkeitsfunktion von `X`

```{r}
#| label: Loesung-F2a
#| layout-ncol: 2
#  x-Achse
x = 0:16
# Poisson-Werte
df = data.frame(x, y=dpois(x, lambda = 6))

# plot()
plot(df$x, df$y)

# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point()
```
:::



::: {.callout-tip}
## b) Plotten Sie die Verteilungsfunktion von `X`

```{r}
#| label: Loesung-F2b
#| layout-ncol: 2
#  x-Achse
x = 0:16
# Poisson-Werte
df = data.frame(x, y=ppois(x, lambda = 6))

# plot()
plot(df$x, df$y)

# ggplot()
ggplot(df, aes(x=x, y=y)) +
  geom_point()
```
:::



::: {.callout-tip}
## c) Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag (nur) 1 Geburt stattfindet? 

```{r}
#| label: Loesung-F2c
dpois(1, lambda = 6)
```
:::



::: {.callout-tip}
## d) Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag weniger als 6 Geburten stattfinden?

```{r}
#| label: Loesung-F2d
ppois(5, lambda = 6, lower.tail=TRUE)
```
:::

::: {.callout-tip}
## e)  Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag  4 oder mehr Geburten stattfinden?

```{r}
#| label: Loesung-F2e
ppois(3, lambda = 6, lower.tail=FALSE)
```
:::


::: {.callout-tip}
## f)  Wie groß ist die Wahrscheinlicheit, dass an einem zufälligen Tag  4 bis 8 Geburten stattfinden?

```{r}
#| label: Loesung-F2f
# entweder
sum(dpois(4:8, lambda=6))

# oder
ppois(8, lambda=6) - ppois(3, lambda=6)
```
:::


::: {.callout-tip}
## g)  Wie groß ist die Wahrscheinlicheit, dass in einer Woche zwischen 30 und 40 Geburten stattfinden?

```{r}
#| label: Loesung-F2g
# lambda für eine Woche = 7* 6 = 42
ppois(40, lambda=42) - ppois(29, lambda=42)

```
:::










## Lösung zur Aufgabe [-@sec-F03] {#sec-LF03}

::: {.callout-tip}
## a) berechnen Sie die Wahrscheinlichkeitsverteilung des binomialen Modells $B(30, 0.1)$.

```{r}
#| label: Loesung-F3a
dbinom(c(0,1,2,3,4,5,6,7,8,9,10), size = 30, prob = 0.1)
```
:::


::: {.callout-tip}
## b) berechnen Sie die Wahrscheinlichkeitsverteilung des Poissonmodells $P(3)$ und vergleichen Sie es mit dem binomialen Modell $B(30, 0.1)$.

```{r}
#| label: Loesung-F3b
result <- data.frame(binomial= dbinom(c(0,1,2,3,4,5,6,7,8,9,10), 
                                      size = 30, prob = 0.1),
                     poisson = dpois(c(0,1,2,3,4,5,6,7,8,9,10), 
                                     lambda = 3))
head(result)
```
:::



::: {.callout-tip}
## c) berechnen Sie die Wahrscheinlichkeitsverteilung des binomialen Modells $B(100, 0.3)$ und vergleichen Sie es es mit dem Modell $P(3)$. Sind diese Modelle ähnlicher als die vorherigen?

```{r}
#| label: Loesung-F3c
result <- data.frame(binomial= dbinom(c(0,1,2,3,4,5,6,7,8,9,10), 
                                      size = 100, prob = 0.3),
                     poisson = dpois(c(0,1,2,3,4,5,6,7,8,9,10), 
                                     lambda = 3))
head(result)                     
```
:::



::: {.callout-tip}
## d) Plotten Sie die Wahrscheinlichkeitsfunktionen der vorherigen Modelle. Erhöhen Sie die Anzahl der Wiederholungen und verringern Sie die Erfolgswahrscheinlichkeit im Binomialmodell und beobachten Sie, wie sich die Wahrscheinlichkeiten des Binomialmodells und des Poissonmodells annähern.

```{r}
#| label: Loesung-F3d
#| layout-ncol: 2
# um nicht immer wieder den selben Plot-Befehl aufzurufen
# erstellen wir eine Hilfsfunktion
#---------------------------------------------------
myplot <- function(n, p){
  # vorberechnen
  mu <- p*n
  sd <- sqrt(n*p*(1-p))
  # plotten
  plot( seq(0,n), dpois( seq(0,n), mu ), type="h", 
       xlim=c(-1,n+1), xlab="x", ylab="Probability", 
       ylim=range(0,dpois( seq(0,n), mu), dbinom(seq(0,n),n,p)))
  points( seq(0,n), dpois( seq(0,n), mu ), pch=16, col="blue")
  points( seq(0,n), dbinom( seq(0,n), n, p), type="h")
  abline(h=0)
  points( seq(0,n), dbinom( seq(0,n), n, p), pch=18, col="red" )
  title( paste("Mean", "=", round(mu,3), "Std.Dev.", "=", round(sd,3)))
  legend("topright", c("Binomial", "Poisson"), 
         col = c("red","blue"), pch = c(18,16))   }
#---------------------------------------------------

# plots vergleichen
myplot(30, 0.1)  
myplot(50, 0.1)  
myplot(80, 0.1)  
myplot(100, 0.1)  
myplot(100, 0.05)  
myplot(100, 0.03)  
```
:::







## Lösung zur Aufgabe [-@sec-F04] {#sec-LF04}

::: {.callout-tip}
## Wie groß ist die Wahrscheinlichkeit, beim Werfen von 100 Münzen zwischen 40 und 60 Mal `Kopf` zu erhalten (beide Werte eingeschlossen)?

```{r}
#| label: Loesung-F4a
sum(dbinom(40:60, size = 100, prob = 0.5))
```
:::




## Lösung zur Aufgabe [-@sec-F05] {#sec-LF05}

::: {.callout-tip}
## a) wie groß ist die Wahrscheinlichkeit, dass die Hälfte der Patienten geheilt wird?

```{r}
#| label: Loesung-F5a
# n=6 Patienten
# p =0.85
# k=3 (die Hälfte von 6)
dbinom(3, size = 6, prob = 0.85)
```
:::

::: {.callout-tip}
## b) wie groß ist die Wahrscheinlichkeit, dass mindestens 4 Patienten geheilt werden?

```{r}
#| label: Loesung-F5b

pbinom(3, size = 6, prob = 0.85, lower.tail = FALSE)
```
:::


::: {.callout-tip}
## c) plotten Sie die Wahrscheinlichkeitsfunktion für die Anzahl geheilter Patienten.

```{r}
#| label: Loesung-F5c
#| layout-ncol: 2
df <- data.frame(x=0:6,
                 y=dbinom(0:6, size = 6, prob = 0.85))

# plot()
plot(df$x, df$y, type="h", lwd=2, col="blue",
     xlab = "Anzahl geheilter Patienten",
     ylab = "Wahrscheinlichkeit",
     main = "Wahrscheinlichkeitsfunktion der Anzahl geheilter Patienten")

# ggplot
ggplot(df, aes(x=x, y=0, xend=x, yend=y)) +
  geom_segment(col="blue", lwd=3) +
  xlab("Anzahl geheilter Patienten") +
  ylab("Wahrscheinlichkeit") 
```
:::





## Lösung zur Aufgabe [-@sec-F06] {#sec-LF06}

::: {.callout-tip}
## Die Wahrscheinlichkeit einer starken Impfreaktion beträgt $0,001$. Wenn 2.000 Personen geimpft werden, wie hoch ist die Wahrscheinlichkeit für starke Reaktionen? 

```{r}
#| label: Loesung-F6a
# n=2000 Patienten
# p =0.001
# k=1
pbinom(1, size = 2000, prob = 0.001, lower.tail=FALSE)
```
:::




## Lösung zur Aufgabe [-@sec-F07] {#sec-LF07}

::: {.callout-tip}
## a) Wie hoch ist die Wahrscheinlichkeit, dass weniger als 4 Anrufe in 2 Sekunden eintreffen?

```{r}
#| label: Loesung-F7a
# 120 Anrufe pro Minute sind
# 2 Anrufe pro Sekunde
# lambda für 2 Sekunden ist also 4
ppois(3, lambda=4, lower.tail=TRUE)
```
:::


::: {.callout-tip}
## b) Wie hoch ist die Wahrscheinlichkeit, dass mindestens 3 Anrufe in 3 Sekunden eintreffen?

```{r}
#| label: Loesung-F7b

ppois(2, lambda=6, lower.tail=FALSE)
```
:::





\newpage

## Lösung zur Aufgabe [-@sec-G01] {#sec-LG01}

::: {.callout-tip}
## a) Plotten Sie die Dichtefunktion der Wartezeit.

```{r}
#| label: Loesung-G1a
#| layout-ncol: 2
# x-Werte
x <- seq(-1, 16, by=0.1)
# Dichtefunktion der Uniformverteilung für alle x
y <- dunif(x, min=0, max=15)
# Datenframe
df <- data.frame(x, y)

# plot()
plot(x,y, type="l", col="navyblue")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="navyblue")
```
:::



::: {.callout-tip}
## b) Plotten Sie die Verteilungsfunktion der Wartezeit.

```{r}
#| label: Loesung-G1b
#| layout-ncol: 2
# x-Werte
x <- seq(-1, 16, by=0.1)
# Verteiluingsfunktion der Uniformverteilung für alle x
y <- punif(x, min=0, max=15)
# Datenframe
df <- data.frame(x, y)

# plot()
plot(x,y, type="l", col="aquamarine3")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="aquamarine3")
```
:::



::: {.callout-tip}
## c) Berechnen Sie die Wahrscheinlichkeit, weniger als 5 Minuten auf den Bus zu warten.

```{r}
#| label: Loesung-G1c
punif(5, min = 0, max = 15, lower.tail=TRUE)
```
:::


::: {.callout-tip}
## d) Berechnen Sie die Wahrscheinlichkeit, länger als 12 Minuten auf den Bus zu warten.

```{r}
#| label: Loesung-G1d
punif(12, min = 0, max = 15, lower.tail=FALSE)
```
Die Wahrscheinlichkeit beträgt 20\%.
:::




::: {.callout-tip}
## e) Berechnen Sie die Wahrscheinlichkeit, zwischen 5 und 10 Minuten auf den Bus zu warten.

```{r}
#| label: Loesung-G1e
punif(10, min = 0, max = 15) - punif(5, min = 0, max = 15) 

```
Die Wahrscheinlichkeit beträgt 33,33\%.
:::



::: {.callout-tip}
## f) Bei welcher Zeit zwischen 0 und 15 Minuten muss die Hälft der Personen kürzer auf den Bus warten als die angegebene Zeit?

```{r}
#| label: Loesung-G1f
qunif(0.5, min = 0, max = 15, lower.tail=TRUE)
```
50\% der Personen muss weniger als 7,5 Minuten auf den Bus warten.
:::



::: {.callout-tip}
## g) Bei welcher Zeit zwischen 0 und 15 Minuten müssen 10\% der Personen länger auf den Bus warten als die angegebene Zeit?

```{r}
#| label: Loesung-G1g
qunif(0.1, min = 0, max = 15, lower.tail=FALSE)
```
10\% der Personen müssen länger als 13,5 Minuten auf den Bus warten.
:::




## Lösung zur Aufgabe [-@sec-G02] {#sec-LG02}
::: {.callout-tip}
## a) Plotten Sie die Dichtefunktion von $Z$.

```{r}
#| label: Loesung-G2a
#| layout-ncol: 2
x <- seq(-3, 3, 0.01)
y <- dnorm(x, mean = 0, sd = 1)

df = data.frame(x = x, y = y)

# plot()
plot(x,y, type="l", col="cornsilk4")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="cornsilk4")
```
:::



::: {.callout-tip}
## b) Wie beeinflussen Mittelwert und Standardabweichung die Form der Gausschen Glockenkurve?

```{r}
#| label: Loesung-G2b
# erzeuge neue Werte von -3 bis 6
x <- seq(-3,6, by=0.005)

# Alles zusammen plotten
plot(x,dnorm(x,mean=2,s=0.5), col="blue", type="l", xlab="x", 
     ylab="f(x)",main="Normalverteilungen")
lines(x,dnorm(x,mean=0,s=1), col="black")
lines(x,dnorm(x,mean=2,s=2), col="darkorchid")
text(0,.45,"N(0;1)")
text(2.8, 0.6, "N(2;0.5)", col="blue")
text(5, 0.1, "N(2;2)", col="darkorchid")
```
Der MIttelwert verschiebt die Kurve, die Standardabweichung verformt sie. Je größer die Standardabweichung, desto flacher und breiter ist die Kurve.
:::



::: {.callout-tip}
## c) Plotten Sie die Verteilungsfunktion von $Z$.

```{r}
#| label: Loesung-G2c
#| layout-ncol: 2
# erzeuge neue Werte von -3 bis 3
x <- seq(-3, 3, 0.01)
y <- pnorm(x, mean=0, sd=1)
df = data.frame(x, y)

# plot()
plot(x,y, type="l", col="dodgerblue1")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="dodgerblue1")
```
:::



::: {.callout-tip}
## d) Berechnen Sie die Wahrscheinlichkeit $P(Z < -1)$.

```{r}
#| label: Loesung-G2d
pnorm(-1, mean=0, sd=1, lower.tail=TRUE)

```
:::

::: {.callout-tip}
## e) Berechnen Sie die Wahrscheinlichkeit $P(Z > 1)$.

```{r}
#| label: Loesung-G2e
pnorm(1, mean=0, sd=1, lower.tail=FALSE)

```
:::

::: {.callout-tip}
## f) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus der Standardabweichung und dem Mittelwert plus der Standardabweichung liegt, d. h. $P(-1 \leq Z \leq 1)$.

```{r}
#| label: Loesung-G2f
pnorm(1, mean=0, sd=1) - pnorm(-1, mean=0, sd=1)
```
:::


::: {.callout-tip}
## g) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus zwei Standardabweichungen und dem Mittelwert plus zwei Standardabweichungen liegt, d. h. $P(-2 \leq Z \leq 2)$.

```{r}
#| label: Loesung-G2g
pnorm(2, mean=0, sd=1) - pnorm(-2, mean=0, sd=1)
```
:::

::: {.callout-tip}
## h) Berechnen Sie die Wahrscheinlichkeit, dass $Z$ zwischen dem Mittelwert minus drei Standardabweichungen und dem Mittelwert plus drei Standardabweichungen liegt, d. h. $P(-3 \leq Z \leq 3)$.

```{r}
#| label: Loesung-G2h
pnorm(3, mean=0, sd=1) - pnorm(-3, mean=0, sd=1)
```
:::



::: {.callout-tip}
## i) Berechnen Sie die Quartile.

```{r}
#| label: Loesung-G2i
qnorm(c(0.25, 0.5, 0.75), mean=0, sd=1)
```
:::

::: {.callout-tip}
## j) Bei welchem $Z$-Wert liegen 95\% der Fläche unterhalb des Wertes?

```{r}
#| label: Loesung-G2j
qnorm(0.95, mean=0, sd=1, lower.tail=TRUE)
```
:::


::: {.callout-tip}
## k) Bei welchem $Z$-Wert liegen 2,5\% der Fläche oberhalb des Wertes?

```{r}
#| label: Loesung-G2k
qnorm(0.025, mean=0, sd=1, lower.tail=FALSE)
```
:::


\newpage



## Lösung zur Aufgabe [-@sec-G03] {#sec-LG03}
::: {.callout-tip}
## a) Plotten Sie die Dichtefunktion dieser Verteilung.

```{r}
#| label: Loesung-G3a
#| layout-ncol: 2
x <- seq(0, 19.86, 0.01)
y <- dchisq(x, df=6)

df = data.frame(x = x, y = y)

# plot()
plot(x,y, type="l", col="forestgreen")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="forestgreen")
```
:::


::: {.callout-tip}
## b) Wie groß ist die Wahrscheinlichkeit für $P(X<6)$?

```{r}
#| label: Loesung-G3b
pchisq(6, df=6, lower.tail=TRUE)
```
:::


::: {.callout-tip}
## c) Berechnen Sie das fünfte Perzentil der Verteilung.

```{r}
#| label: Loesung-G3c
qchisq(0.05, df=6)
```
:::


::: {.callout-tip}
## d) Bei welchem Wert liegen 10\% der Fläche oberhalb des Wertes?

```{r}
#| label: Loesung-G3d
qchisq(0.1, df=6, lower.tail=FALSE)
```
:::













## Lösung zur Aufgabe [-@sec-G04] {#sec-LG04}
::: {.callout-tip}
## a) Plotten Sie die Dichtefunktion von $X$ und vergleichen Sie diese mit der Dichtefunktion der Standardnormalverteilung.

```{r}
#| label: Loesung-G4a
#| layout-ncol: 2
x <- seq(-3.5, 3.5, 0.01)
y <- dt(x, df=8)
y2 <- dnorm(x)
df = data.frame(x=x, y=y, y2=y2)

# plot()
plot(x,y, type="l", col="firebrick4")
lines(x,y2, lty=3)

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="firebrick4") +
  geom_line(aes(x=x, y=y2), lty=3)
```
:::




::: {.callout-tip}
## b) Berechnen Sie das 8te Perzentil von $X$.

```{r}
#| label: Loesung-G4b
qt(0.08, df=8)

```
:::


::: {.callout-tip}
## c) Bei welchem Wert von $X$ liegen 5\% aller Fälle oberhalb dieses Wertes?

```{r}
#| label: Loesung-G4c
qt(0.05, df=8, lower.tail = FALSE)

```
:::










## Lösung zur Aufgabe [-@sec-G05] {#sec-LG05}
::: {.callout-tip}
## a) Plotten Sie die Dichtefunktion von $X$.

```{r}
#| label: Loesung-G5a
#| layout-ncol: 2
x <- seq(0, 3.75, 0.01)
y <- df(x, df1 = 10, df2 = 20)

df = data.frame(x=x, y=y)

# plot()
plot(x,y, type="l", col="indianred2")

# ggplot()
ggplot(df, aes(x=x, y=y)) + 
  geom_line(col="indianred2")
```
:::



::: {.callout-tip}
## b) Berechnen Sie Wahrscheinlichkeit $P(X>1)$.

```{r}
#| label: Loesung-G5b
pf(1, df1=10, df2=20, lower.tail=FALSE)
```
:::


::: {.callout-tip}
## c) Berechnen Sie den Interquartilsabstand.

```{r}
#| label: Loesung-G5c
qf(c(0.75), df1=10, df2=20)  - qf(0.25, df1=10, df2=20)
```
:::










## Lösung zur Aufgabe [-@sec-G06] {#sec-LG06}
::: {.callout-tip}
## a) Berechnen Sie die Wahrscheinlichkeit, dass ein zufällig ausgewählter Diabetiker einen Glukosespiegel von weniger als 120 mg/100 ml hat.

```{r}
#| label: Loesung-G6a
pnorm(120, mean=106, sd=8)
```
:::


::: {.callout-tip}
## b) Wie viel Prozent der Personen haben einen Glukosespiegel zwischen 90 und 120 mg/100 ml?

```{r}
#| label: Loesung-G6b 
pnorm(120, mean=106, sd=8) - pnorm(90, mean=106, sd=8)
```
Etwa `r round((pnorm(120, mean=106, sd=8) - pnorm(90, mean=106, sd=8))*100,2)`\% der Personen.
:::


::: {.callout-tip}
## c) Berechnen und interpretieren Sie das erste Quartil des Glukosespiegels.

```{r}
#| label: Loesung-G6c
qnorm(0.25, mean=106, sd=8)
```
:::





## Lösung zur Aufgabe [-@sec-G07] {#sec-LG07}
::: {.callout-tip}
## a) Wie viele von ihnen haben einen Cholesterinspiegel zwischen 210 und 240 mg/dl?

```{r}
#| label: Loesung-G7a
# Anteile berechnen
pnorm(240, mean=220, sd=30) - pnorm(210, mean=220, sd=30)
```
Etwa `r round((pnorm(240, mean=220, sd=30) - pnorm(210, mean=220, sd=30))*100,2)`\% der Personen.
:::



::: {.callout-tip}
## b) Wenn ein Cholesterinspiegel von mehr als 250 mg/dl eine Thrombose auslösen kann, wie viele von ihnen sind thrombosegefährdet?

```{r}
#| label: Loesung-G7b
pnorm(250, mean=220, sd=30, lower.tail=FALSE)

```
Etwa `r round(pnorm(250, mean=220, sd=30, lower.tail=FALSE)*100,2)`\% der Personen.
:::


::: {.callout-tip}
## c) Welcher Cholesterinwert wird von mindestens 20% der Männer erreicht?

```{r}
#| label: Loesung-G7c
# Anteile berechnen
qnorm(0.2, mean=220, sd=30)
```
:::

















## Lösung zur Aufgabe [-@sec-H01] {#sec-LH01}
::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Konzentration`.

```{r}
#| label: Loesung-H1a
Konzentration <- c(17.6, 19.2, 21.3, 15.1, 17.6, 18.9, 16.2, 18.3, 19.0, 16.4)

```

:::


::: {.callout-tip}
## b) Berechnen Sie das Konfidenzintervall für die mittlere Konzentration bei einem Konfidenzniveau von 95\% (Signifikanzlevel $\alpha = 0,05$).

```{r}
#| label: Loesung-H1b
d <-t.test(Konzentration, mu=0, conf.level=0.95)
d

# nur Konfidenzintervall ausgeben
as.numeric(d$conf.int)
```

:::


::: {.callout-tip}
## c) Berechnen Sie das Konfidenzintervall für die mittlere Konzentration bei einem Konfidenzniveau von 99\% (Signifikanzlevel $\alpha = 0,01$).

```{r}
#| label: Loesung-H1c
d <-t.test(Konzentration, mu=0, conf.level=0.99)
d

# nur Konfidenzintervall ausgeben
as.numeric(d$conf.int)
```

:::



::: {.callout-tip}
## d) Wenn wir die Genauigkeit des Intervalls als den Kehrwert seiner Breite definieren, wie ändert sich die Genauigkeit eines Intervalls, wenn wir das Konfidenzniveau erhöhen?

Mit höherem Konfidenzniveau sinkt die Genauigkeit der Aussagen. 
:::

::: {.callout-tip}
## e) Welche Stichprobengröße wird benötigt, um den mittleren Konzentrationswert mit einem Fehler von $\pm 0.5$mg/mm$^{3}$ und einem Konfidenzniveau von 95\% Sicherheit zu bestimmen?

```{r}
#| label: Loesung-H1e
# Berechnung der Standardabweichung der Stichprobe
sigma <- sd(Konzentration)

# Gegebene Werte
# z-Wert für 95% Konfidenzniveau
z <- 1.96  

# Fehlermarge
E <- 0.5  

# Berechnung der Stichprobengröße
n <- (z * sigma / E)^2

# Aufrunden auf die nächste ganze Zahl
ceiling(n)  

```
:::

::: {.callout-tip}
## f) Wenn die Konzentration des Wirkstoffs mindestens 16 mg/mm$^{3}$ betragen muss, um wirksam zu sein, ist dann unsere Medikamentencharge wirksam?

```{r}
#| label: Loesung-H1f
t.test(Konzentration, mu = 16, alternative = "greater")
```

Der Test ist signifikant. Wir können also sagen, dass unserer Medikamentencharge wirksam ist.
:::











## Lösung zur Aufgabe [-@sec-H02] {#sec-LH02}
::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Hof` und `Fett`.

```{r}
#| label: Loesung-H2a
# Daten übertragen
Hof1 <- data.frame(Fett = c(0.34, 0.34,
          0.32, 0.35,
          0.33, 0.33,
          0.32, 0.32,
          0.33, 0.30,
          0.31, 0.32))
Hof1$Hof <- "Hof 1"     

Hof2 <- data.frame(Fett = c(0.28, 0.29,
          0.30, 0.32,
          0.32, 0.31,
          0.29, 0.29,
          0.31, 0.32,
          0.29, 0.31,
          0.33, 0.32,
          0.32, 0.33))
Hof2$Hof <- "Hof 2"     

milch <- rbind(Hof1, Hof2)
milch$Hof <- factor(milch$Hof)
```

:::


::: {.callout-tip}
## b) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt.

```{r}
#| label: Loesung-H2b
t.test(milch$Fett, conf.level=0.95)
```

:::


::: {.callout-tip}
## c) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt, getrennt nach Höfen.

```{r}
#| label: Loesung-H2c
t.test(Hof1$Fett, conf.level=0.95)
t.test(Hof2$Fett, conf.level=0.95)
```

:::



::: {.callout-tip}
## d) Plotten Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettgehalt, getrennt nach Höfen..

```{r}
#| label: Loesung-H2d
# Vorbereitung
h1 <- t.test(Hof1$Fett, conf.level=0.95)
h2 <- t.test(Hof2$Fett, conf.level=0.95)

# Als Datenframe für ggplot zusammenbauen
df <- data.frame(unten = c(h1$conf.int[1], h2$conf.int[1]),
                 oben  = c(h1$conf.int[2], h2$conf.int[2]),
                 mitte = c(h1$estimate, h2$estimate ),
                 Hof = c("Hof 1", "Hof 2"))

# ggplot
ggplot(df, aes(x=Hof, color=Hof)) +
  geom_point(aes(y=mitte)) +
  geom_segment(aes(xend=Hof, y=unten, yend=oben))
```

:::


::: {.callout-tip}
## e) Lässt sich aus den Konfidenzintervallen ein signifikanter Untschied zwischen den Höfen feststellen?

```{r}
df
```

Die beiden Konfidenzintervalle überschneiden sich nicht. Das heisst, es kann ein signifikanter Unterschied abgeleitet werden.

:::





## Lösung zur Aufgabe [-@sec-H03] {#sec-LH03}
::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Antwort`.

```{r}
#| label: Loesung-H3a
# Daten übertragen
Antwort <- c("nein",  "ja",  "nein",  "nein",  "nein",  "ja",  "nein",  
             "ja", "ja",  "ja",  "ja",  "nein",  "ja",  "nein", "ja",  
             "nein",  "nein", "nein",  "ja",  "ja",  "ja",  "nein",  
             "nein",  "ja",  "nein",  "nein", "ja",  "ja",  "nein",  
             "nein",  "ja",  "nein",  "ja", "nein")
```

:::


::: {.callout-tip}
## b) Berechnen Sie das Konfidenzintervall für den Anteil an Studierenden, welche die Bibliothek wöchentlich nutzen mit einem Signifikanzlevel von $\alpha=0,01$.

```{r}
#| label: Loesung-H3b
freq <- table(Antwort)
bib <- prop.test(freq[["ja"]], sum(freq), 
                 alternative="two.sided", 
                 p=0.5, conf.level=0.99)
bib
```

:::

::: {.callout-tip}
## c) Wie präzise ist das Intervall?

```{r}
#| label: Loesung-H3c
bib$conf.int[2] - bib$conf.int[1]
```
Das Intervall ist sehr breit und daher unpräzise.
:::


::: {.callout-tip}
## d) Welcher Stichprobenumfang ist erforderlich, um eine Schätzung des Anteils der Studenten zu erhalten, die die Bibliothek mindestens einmal pro Woche nutzen, mit einem Fehler von $\pm1$\% und einem Konfidenzniveau von 95\%?

```{r}
#| label: Loesung-H3d
# gemessene Proportionen
prop <- bib$estimate

# Z-Wert für 95% Konfidenz
z <- 1.96

# Fehlerspanne +-1%
e <- 0.01

# Fallzahl berechnen
n <- (z^2 * prop * (1 - prop)) / (e^2)

```
Es werden `r ceiling(n)` Probanden benötigt.
:::








## Lösung zur Aufgabe [-@sec-H04] {#sec-LH04}
::: {.callout-tip}
## a) Berechnen Sie das 95\%-Konfidenzintervall für den Anteil an geimpften Probanden in der Grundgesamtheit.

```{r}
#| label: Loesung-H4a
# Daten übertragen
prop.test(154, 200, p=0.5, conf.level=0.95)
```

:::


::: {.callout-tip}
## b) Wenn das Gesundheitsministerium das Ziel verfolgt, dass mindestens 70\% der Menschen über 65 mit Atemwegserkrankungen geimpft sind, können wir dann sagen, dass das Ministerium das Ziel erreicht hat?

```{r}
#| label: Loesung-H4b
# Daten übertragen
prop.test(154, 200, p=0.5, conf.level=0.95)$conf.int[1]
```
Da die untere Grenze des Konfidenzintervalls größer als 0,7 ist, können wir bestätigen, dass das Ministerium sein Ziel erreicht hat.
:::


\newpage


## Lösung zur Aufgabe [-@sec-H05] {#sec-LH05}
::: {.callout-tip}
## a) Berechnen Sie die Konfidenzintervalle für den Mittelwert mit den Signifikanzniveaus $0.1$, $0.05$ und $0.01$.

```{r}
#| label: Loesung-H5a
# Daten übertragen
cholesterin <- c(196, 212, 188, 206, 203, 210, 201, 198)

t.test(cholesterin, conf.level=0.90)
t.test(cholesterin, conf.level=0.95)
t.test(cholesterin, conf.level=0.99)

```


:::

::: {.callout-tip}
## b) Kann man schließen, dass der Mittelwert des Cholesterinspiegels der Bevölkerung unter 210 mg/dl liegt?

```{r}
#| label: Loesung-H5b
# Daten übertragen
as.numeric(t.test(cholesterin, conf.level=0.90)$conf.int)
as.numeric(t.test(cholesterin, conf.level=0.95)$conf.int)
as.numeric(t.test(cholesterin, conf.level=0.99)$conf.int)

```

Die obere Grenze des 99\%-Konfidenzintervall ist größer als 210. Wird dies berücksichtigt, lässt dich die Aussage nicht bestätigen.
:::



\newpage


## Lösung zur Aufgabe [-@sec-H06] {#sec-LH06}
::: {.callout-tip}
## a) Berechnen Sie für jede Therapie das 95\% Konfidenzintervall für den Anteil an Personen, die geheilt wurden. 

```{r}
#| label: Loesung-H6a
# Daten übertragen
a <- c(rep("geheilt", 18), rep("nicht", 7))
b <- c(rep("geheilt", 21), rep("nicht", 14))

freqA <- table(a)
freqB <- table(b)
A <- prop.test(freqA[["geheilt"]], sum(freqA), 
                 alternative="two.sided", 
                 p=0.5, conf.level=0.95)
B <- prop.test(freqB[["geheilt"]], sum(freqB), 
                 alternative="two.sided", 
                 p=0.5, conf.level=0.95)
# Konfidenzintervalle
A$conf.int[2] - A$conf.int[1]
B$conf.int[2] - B$conf.int[1]

```
Das Konfidenzintervall von Gruppe B ist schmaler, und damit auch präziser.

:::





## Lösung zur Aufgabe [-@sec-H07] {#sec-LH07}

```{r}
#| label: Loesung-H8setup
#| include: false
# lade Datensatz
load("data/neonates.RData")
```

```{r}
#| label: Loesung-H8setup2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/neonates.RData"))
```


::: {.callout-tip}
## a) Berechnen Sie das 99\% Konfidenzintervall für den Mittelwert des Gewichts der Neugeborenen.

```{r}
#| label: Loesung-H8a
# t-Test
d <- t.test(neonates$weight, conf.level = 0.99)

# Konfidenzgrenzen
as.numeric(d$conf.int)
```

:::



::: {.callout-tip}
## b) Berechnen Sie die Konfidenzintervalle für den APGAR-Score nach 1 Minute und für den APGAR-Score nach 5 Minuten und vergleiche sie beide Intervalle. Gibt es auf Grundlage der Konfidenzintervalle einen signifikanten Unterschied zwischen den Mittelwerten der beiden Scores?

```{r}
#| label: Loesung-H8b
# t-Test
a1 <- t.test(neonates$apgar1, conf.level = 0.99)
a5 <- t.test(neonates$apgar5, conf.level = 0.99)

# Konfidenzgrenzen
as.numeric(a1$conf.int)
as.numeric(a5$conf.int)
```
Die Konfidenzgrenzen schneiden sich nicht. Das bedeutet, wir können von einem signifikanten Unterschied ausgehen.
:::




::: {.callout-tip}
## c) Berechnen Sie die Konfidenzintervalle für den Prozentsatz der Neugeborenen mit einem Gewicht von $\leq 2,5$ kg für Raucher- und Nichtrauchermütter und vergleichen Sie die Intervalle.

```{r}
#| label: Loesung-H8c
# geringes Gewicht kategorisieren
neonates$GG <- "normal"
neonates$GG[neonates$weight<2.50001] <- "low"

# Subsets bilden
k1 <- subset(neonates, smoke=="Yes")
k2 <- subset(neonates, smoke=="No")
# Häufigkeitstabelle
freq1 <- table(k1$GG)
freq2 <- table(k2$GG)

# Proportion Test
m1 <- prop.test(freq1[["low"]], sum(freq1), 
                 alternative="two.sided", 
                 p=0.5, conf.level=0.95)

m2 <- prop.test(freq2[["low"]], sum(freq2), 
                 alternative="two.sided", 
                 p=0.5, conf.level=0.95)

# Konfidenzgrenzen anzeigen
as.numeric(m1$conf.int)
as.numeric(m2$conf.int)
```
Die Konfidenzgrenzen schneiden sich nicht. Das bedeutet, wir können von einem signifikanten Unterschied ausgehen.
:::























## Lösung zur Aufgabe [-@sec-I01] {#sec-LI01}

::: {.callout-tip}
## a) Erstellen Sie ein Datenframe mit den Variablen `vorher` und `nachher` und übertragen Sie die Daten.

```{r}
#| label: Loesung-I1a
df <- data.frame(
  vorher = c(147, 163, 121, 205, 132, 190, 176, 147),
  nachher = c(150, 171, 132, 208, 141, 184, 182, 145)
)

  
```

:::


::: {.callout-tip}
## b) Berechnen Sie den Mittelwert der monatlichen Umsätze vor und nach der Kampagne. Sind die Mittelwerte unterschiedlich? Hat die Kampagne den Absatz des Arzneimittels erhöht?

```{r}
#| label: Loesung-I1b
mean(df$vorher)
mean(df$nachher)
  
```
Der Mittelwert ist nach der Kampagne höher.
:::

::: {.callout-tip}
## c) Berechnen Sie die Konfidenzintervalle für den durchschnittlichen Unterschied mit $\alpha = 0,05$ und $\alpha = 0,01$.

```{r}
#| label: Loesung-I1c
# t-Tests durchführen
a5 <- t.test (df$vorher, df$nachher, paired=TRUE, conf.level=0.95)  
a1 <- t.test (df$vorher, df$nachher, paired=TRUE, conf.level=0.99)  

# nur Konfidenzintervalle anzeigen
as.numeric(a5$conf.int)
as.numeric(a1$conf.int)
```
Beide Intervalle "reißen" die $0$. Das bedeutet, dass der wahre Unterschied auch `0` sein könnte.
:::



::: {.callout-tip}
## d) Können wir dieselbe Schlussfolgerung ziehen, wenn wir die Verkäufe nach der Kampagne der beiden letzten Apotheken ändern und $190$ statt $182$ und $165$ statt $145$ angeben? Was passiert mit den Konfidenzintervallen?

```{r}
#| label: Loesung-I1d
# Daten neu eingeben
df <- data.frame(
  vorher = c(147, 163, 121, 205, 132, 190, 176, 147),
  nachher = c(150, 171, 132, 208, 141, 184, 190, 165)
)
# t-Tests durchführen
a5 <- t.test (df$vorher, df$nachher, paired=TRUE, conf.level=0.95)  
a1 <- t.test (df$vorher, df$nachher, paired=TRUE, conf.level=0.99)  

# nur Konfidenzintervalle anzeigen
as.numeric(a5$conf.int)
as.numeric(a1$conf.int)
```
Das 95\%-Intervall lässt einen Unterschied vermuten. Das 99\%-Intervall hingegen enthält immer noch die `0`.
:::





\newpage



## Lösung zur Aufgabe [-@sec-I02] {#sec-LI02}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Hof1` und `Hof2`.

```{r}
#| label: Loesung-I2a
# Daten übertragen
Hof1 <- data.frame(Fett = c(0.34, 0.34,
          0.32, 0.35,
          0.33, 0.33,
          0.32, 0.32,
          0.33, 0.30,
          0.31, 0.32))
Hof1$Hof <- "Hof 1"     

Hof2 <- data.frame(Fett = c(0.28, 0.29,
          0.30, 0.32,
          0.32, 0.31,
          0.29, 0.29,
          0.31, 0.32,
          0.29, 0.31,
          0.33, 0.32,
          0.32, 0.33))
Hof2$Hof <- "Hof 2"     

milch <- rbind(Hof1, Hof2)
milch$Hof <- factor(milch$Hof)
  
```

:::




::: {.callout-tip}
## b) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Fettunterschied in der Milch von `Hof1` und `Hof2`.

```{r}
#| label: Loesung-I2b
# Daten übertragen
# zuvor auf gleiche Varainz prüfen
var.test(Hof1$Fett, Hof2$Fett)$p.value
  
```
Der Test ist nicht signifikant, die Varianz ist in beiden Höfen gleich.

```{r}
#| label: Loesung-I2b2
# t.Test
d <- t.test(Fett ~ Hof, data=milch, var.equal=TRUE)
# Konfidenzintervall anzeigen
as.numeric(d$conf.int)
```

:::




::: {.callout-tip}
## c) Kann man daraus schließen, dass der Unterschied zwischen den Milchfettmittelwerten der Betriebe signifikant ist? Welcher Betrieb hat Milch mit mehr Fett? Wie viel mehr Fett hat die Milch von `Hof1` als die Milch von `Hof2`?

```{r}
#| label: Loesung-I2c
d <- t.test(Fett ~ Hof, data=milch, var.equal=TRUE)  
d

# Unterschied
d$estimate[1] - d$estimate[2]
```
Hof1 hat `r d$estimate[1] - d$estimate[2]`  mehr Fett in der Milch als Hof2. Da das Intervall die 0 nicht mit einschließt, können wir von einem Signifikanten Unterschied ausgehen.
:::








## Lösung zur Aufgabe [-@sec-I03] {#sec-LI03}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Antwort` und `Geschlecht`.

```{r}
#| label: Loesung-I3a
# Daten übertragen
df <- data.frame(
  Antwort = c("nein", "ja", "nein", "nein", "nein", "ja", "nein", 
              "ja", "ja", "ja", "ja", "nein", "ja", "nein", "ja", 
              "nein", "nein",  "nein", "ja", "ja", "ja", "nein", 
              "nein", "ja", "nein", "nein", "ja", "ja", "nein", 
              "nein", "ja", "nein", "ja", "nein"),
  Geschlecht = c("m", "w", "w", "m", "m", "m", "w", "w", "w", "w", 
                 "m", "m", "w", "m", "w", "m", "m", "w", "m", "w", 
                 "w", "w", "m", "w", "m", "m", "w", "w", "m", "m", 
                 "w", "w", "w", "m")
)

```

:::


::: {.callout-tip}
## b) Berechnen Sie das Konfidenzintervall für den Unterschied zwischen den Anteilen der Frauen und Männern, die die Bibliothek mindestens einmal pro Woche nutzen.

```{r}
#| label: Loesung-I3b
freq <- table(df)
prop.test(c(freq[["ja","m"]], freq[["ja","w"]]), 
          c(sum(freq[,"m"]), sum(freq[,"w"])), 
          alternative="two.sided", conf.level=0.95)
```
Das Konfidenzintervall schließt die 0 nicht mit ein. Wir können von einem signifikanten Unterschied ausgehen.
:::











## Lösung zur Aufgabe [-@sec-I04] {#sec-LI04}

```{r}
#| label: Loesung-I4aSetup
df <- data.frame(course = c(rep("bestanden", 55), rep("durchgefallen", 25),
                            rep("bestanden", 32), rep("durchgefallen", 58)),
                 time = c(rep("morgens", 80), rep("abends", 90))
                 
                 )
```


::: {.callout-tip}
## Gibt es signifikante Unterschiede zwischen den Prozentsätzen der Studierenden, die am Vormittag und am Nachmittag bestanden haben? Kann man daraus schließen, dass der Stundenplan die Ursache für diese Unterschiede ist?


```{r}
#| label: Loesung-I4a
freq <- table(df)
prop.test(c(freq[["bestanden","morgens"]], freq[["bestanden","abends"]]), 
          c(sum(freq[,"morgens"]), sum(freq[,"abends"])), 
          alternative="two.sided", conf.level=0.95)
```
Das Konfidenzintervall enthält nicht die 0. Wir können also von einem signifikanten Unterschied ausgehen.
:::







## Lösung zur Aufgabe [-@sec-I05] {#sec-LI05}

```{r}
#| label: Loesung-I5aSetup
df <- data.frame(vorher = c(182, 232, 191, 200, 148, 249, 276, 213, 241, 280, 262),
                 nachher = c(198, 210, 194, 220, 138, 220, 219, 161, 210, 213, 226)
                 )
```


::: {.callout-tip}
## a) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Unterschied der Cholesterinwerte vor und nach den körperlichen Übungen.


```{r}
#| label: Loesung-I5a
t.test(df$vorher, df$nachher, paired=TRUE, conf.level=0.95)

```
:::



::: {.callout-tip}
## b) Berechnen Sie das 99\%-Konfidenzintervall für den durchschnittlichen Unterschied der Cholesterinwerte vor und nach den körperlichen Übungen

```{r}
#| label: Loesung-I5b
t.test(df$vorher, df$nachher, paired=TRUE, conf.level=0.99)

```
:::



::: {.callout-tip}
## c) Auf Grundlage der zuvor berechneten Intervalle, welchen Schluss bezüglich des Einflusses von körperlichen Aktivitäten auf den Cholesterinspiegel können Sie ziehen?

```{r}
#| label: Loesung-I5c
d <- t.test(df$vorher, df$nachher, paired=TRUE, conf.level=0.99)
as.numeric(d$conf.int)
```
Das 99\% Intervall enthält die 0. Auf diesem Niveau können wir den Unterschied nicht bestätigen.
:::







## Lösung zur Aufgabe [-@sec-I06] {#sec-LI06}

```{r}
#| label: Loesung-I6aSetup
df <- data.frame(satisf = c(rep("zufrieden", 140), rep("unzufrieden", 60),
                            rep("zufrieden", 180), rep("unzufrieden", 120)),
                 haus = c(rep("Haus 1", 200), rep("Haus 2", 300))
                 )
```


::: {.callout-tip}
## a) Berechnen Sie das 95\%-Konfidenzintervall für den Anteilsunterschied an zufriedenen Patienten in beiden Häusern.


```{r}
#| label: Loesung-I6a
freq <- table(df)
prop.test(c(freq[["zufrieden","Haus 1"]], freq[["zufrieden","Haus 2"]]), 
          c(sum(freq[,"Haus 1"]), sum(freq[,"Haus 2"])), 
          alternative="two.sided", conf.level=0.95)
```
:::



::: {.callout-tip}
## b) Wenn $\alpha = 0,01$ ist, können dann Rückschlüsse gezogen werden, ob der Unterschied der Anteile zufriedener Patienten signifikant ist?


```{r}
#| label: Loesung-I6b
prop.test(c(freq[["zufrieden","Haus 1"]], freq[["zufrieden","Haus 2"]]), 
          c(sum(freq[,"Haus 1"]), sum(freq[,"Haus 2"])), 
          alternative="two.sided", conf.level=0.99)
```
Wenn $\alpha = 0,01$ verwendet wird, enthält das Intervall die 0. Auf diesem Niveau können wir keinen signifikanten Unterschied zeigen.
:::





## Lösung zur Aufgabe [-@sec-I07] {#sec-LI07}

```{r}
#| label: Loesung-I7setup
#| include: false
# lade Datensatz
load("data/neonates.RData")
```

```{r}
#| label: Loesung-I7setup2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/neonates.RData"))
```


::: {.callout-tip}
## a) Berechnen Sie das 95\%-Konfidenzintervall für den durchscnnittlichen Unterschied des Geburtsgewichts zwischen Kindern von Raucherinnen und Nichtraucherinnen. Wie groß ist der durchschnittliche Gewichtsunterschied?

```{r}
#| label: Loesung-I7a
# subsets
k1 <- subset(neonates, smoke=="Yes")
k2 <- subset(neonates, smoke=="No")

# t-Test
d <- t.test(k1$weight, k2$weight, conf.level = 0.95)

# Konfidenzgrenzen
as.numeric(d$conf.int)

# Unterschied
d$estimate[2] - d$estimate[1]
```
Der Unterschied beträg `r round((d$estimate[2] - d$estimate[1]),2)`kg.
:::




::: {.callout-tip}
## b) Berücksichtigen Sie nur die Daten der Mütter, die *während* der Schwangerschaft nicht geraucht haben. Berechnen Sie das 95\%-Konfidenzintervall für den durchscnnittlichen Unterschied des Geburtsgewichts zwischen Kindern von Müttern, die *vor* der Schwangerschaft geraucht haben, und den Nichtraucherinnen.

```{r}
#| label: Loesung-I7b
# subsets
k  <- subset(neonates, smoke=="No")
k1 <- subset(k, smoke.before=="Yes")
k2 <- subset(k, smoke.before=="No")

# t-Test
d <- t.test(k1$weight, k2$weight, conf.level = 0.95)

# Konfidenzgrenzen
as.numeric(d$conf.int)

# Unterschied
d$estimate[2] - d$estimate[1]
```
Das Konfidenzintervall enthält die 0, das heisst, wir können nicht von einem signifikanten Unterschied ausgehen.
:::



::: {.callout-tip}
## c) Berechnen Sie das 95\%-Konfidenzintervall für den durchschnittlichen Unterschied von APGAR-1-Werten und APGAR-5-Werten. Wie entwickeln sich Neugeborene in den ersten 5 Minuten nach der Geburt?

```{r}
#| label: Loesung-I7c
# t-Test
d <- t.test(neonates$apgar1, neonates$apgar5, conf.level = 0.95)

# Konfidenzgrenzen
as.numeric(d$conf.int)

# Unterschied
d$estimate[2] - d$estimate[1]
```
Nach 5 Minuten haben die Neugeborenen einen im Schnitt 0,58 Punkte höheren APGAR-Wert.
:::



::: {.callout-tip}
## d) Wenn Neugeborene mit einem APGAR-1-Wert $\leq3$ in einem kritischen Zustand sind, berechnen Sie das 90\%-Konfidenzintervall für den Unterschied der Anteile von Neugeborenen in kritischem Zustand zwischen Müttern, die *während* der Schwangerschaft geraucht haben und den Nichtraucherinnen.

```{r}
#| label: Loesung-I7d
# neue Variable "kritisch"
neonates$kritisch <- "normal"
# nur solche mit APGAR<4 sind kritisch
neonates$kritisch[neonates$apgar1<4] <- "kritisch" 

freq <- table(neonates$kritisch, neonates$smoke)

d <- prop.test(c(freq[["kritisch","No"]], freq[["kritisch","Yes"]]), 
               c(sum(freq[,"No"]), sum(freq[,"Yes"])), 
               alternative="two.sided", conf.level=0.90)



# Konfidenzgrenzen
as.numeric(d$conf.int)

# Unterschied
d$estimate[2] - d$estimate[1]
```
Bei Raucherinnen sind durchschnittlich 15\% mehr Neugeborene im kritischen Zustand zu finden als bei Nichtraucherinnen.
:::



::: {.callout-tip}
## e) Hat das Alter der Mutter einen signifikanten Einfluss auf den Anteil an Neugeborenen in kritischem Zustand?

```{r}
#| label: Loesung-I7e
# neue Variable "kritisch"
neonates$kritisch <- "normal"
# nur solche mit APGAR<4 sind kritisch
neonates$kritisch[neonates$apgar1<4] <- "kritisch" 

freq <- table(neonates$kritisch, neonates$age)

d <- prop.test(c(freq[["kritisch","greater than 20"]], 
                 freq[["kritisch","less than 20"]]), 
               c(sum(freq[,"greater than 20"]), 
                 sum(freq[,"less than 20"])), 
               alternative="two.sided", conf.level=0.95)



# Konfidenzgrenzen
as.numeric(d$conf.int)

# Unterschied
d$estimate[2] - d$estimate[1]
```
Das 95\% Intervall enthält die 0. Wir können keinen signifikanten Unterschied feststellen.
:::













## Lösung zur Aufgabe [-@sec-J01] {#sec-LJ01}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit der Variable `Konzentration`.

```{r}
#| label: Loesung-J1a
Konzentration <- c(17.6, 19.2, 21.3, 15.1, 17.6, 18.9, 16.2, 18.3, 19.0, 16.4)
```
:::


::: {.callout-tip}
## b) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 18$ versus $H_{1}: \mu \neq 18$ mit einem Signifikanzniveau von $\alpha=0,05$.

```{r}
#| label: Loesung-J1b
t.test (Konzentration, alternative="two.sided", mu=18, conf.level=0.95)
```
Das Ergebnis ist nicht signifikant.
:::


::: {.callout-tip}
## c) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 19,5$ versus $H_{1}: \mu \neq 19,5$ mit den Signifikanzniveaus von $\alpha=0,05$ und $0,01$. Wie beeinflusst das Signifikanzniveau das Testergebnis?

```{r}
#| label: Loesung-J1c
t.test (Konzentration, alternative="two.sided", mu=19.5, conf.level=0.95)
t.test (Konzentration, alternative="two.sided", mu=19.5, conf.level=0.99)
```
Da der p-Wert bei $0,02341$  liegt, ist das Ergebnis für $\alpha = 0,05$ signifikant, für $\alpha = 0,01$ jedoch nicht.
:::



::: {.callout-tip}
## d) Testen Sie die zweiseitige Hypothese $H_{0}: \mu = 17$ versus $H_{1}: \mu \neq 17$ mit einem Signifikanzniveau von $\alpha=0,05$. Testen Sie ebenfalls die Hypothesen $H_{0}: \mu = 17$ versus $H_{1}: \mu > 17$ mit $\alpha=0,05$. Was ist der Unterschied zwischen den $p$-Werten des zweiseitigen und des einseitigen Tests?

```{r}
#| label: Loesung-J1d
t.test (Konzentration, alternative="two.sided", mu=17, conf.level=0.95)
t.test (Konzentration, alternative="greater", mu=17, conf.level=0.95)
```
Der p-Wert ist beim einseitigen Test kleiner. Beide Werte sind jedoch größer als $0,05$.
:::



::: {.callout-tip}
## e) Wenn der Hersteller angibt, die Konzentration des Wirkstoffs erhöht zu haben (im Vergleich zu früheren Chargen, bei denen der Mittelwert der Konzentration 17 mg/mm$^{3}$ war), können wir ihm glauben?

```{r}
#| label: Loesung-J1e
t.test (Konzentration, alternative="greater", mu=17, conf.level=0.95)
```
Der p-Wert ist nicht signifikant. Wir können dem Hersteller also nicht glauben.
:::



::: {.callout-tip}
## f) Welche Fallzahl würde benötigt, um einen Konzentrationsanstieg von 0,5 mg/mm$^{3}$ zu erkennen (mit $\alpha=0,05$ und einer Power von $1-\beta=0,8$)?

```{r}
#| label: Loesung-J1f
# Power-t-test
power.t.test(delta=0.5, sd=sd(Konzentration), 
             sig.level=0.05, power=0.8, type = "one.sample")

```
Es wird eine Fallzahl von 103 benötigt.
:::





## Lösung zur Aufgabe [-@sec-J02] {#sec-LJ02}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit der Variable `bib`.

```{r}
#| label: Loesung-J2a
# Daten übertragen
bib <- c("nein",  "ja",  "nein",  "nein",  "nein",  "ja",  "nein",  
         "ja", "ja",  "ja",  "ja",  "nein",  "ja",  "nein", "ja",  
         "nein",  "nein", "nein",  "ja",  "ja",  "ja",  "nein",  
         "nein",  "ja",  "nein",  "nein", "ja",  "ja",  "nein",  
         "nein",  "ja",  "nein",  "ja", "nein")
```
:::


::: {.callout-tip}
## b) Testen Sie die Hypothese, dass der Anteil an Studierenden, die wöchentlich die Bibliothek nutzen, größer als 40% ist.

```{r}
#| label: Loesung-J2b
freq <- table(bib)
# testen
prop.test(freq[["ja"]], sum(freq), alternative="greater", p=0.4, conf.level=0.95)
```
Der Test ist nicht signifikant.
:::





## Lösung zur Aufgabe [-@sec-J03] {#sec-LJ03}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Alter` und `Population`.

```{r}
#| label: Loesung-J3a
# Daten übertragen
df <- data.frame(Alter = c(9.5, 10.5, 9.0, 9.8, 10.0, 13.0, 
                           10.0, 13.5, 10.0, 9.8, 12.5, 9.5, 
                           13.5, 13.8, 12.0, 13.8, 12.5, 9.5, 
                           12.0, 13.5, 12.0, 12.0),
                 Population = c(rep("A", 10), rep("B", 12)))
```
:::

::: {.callout-tip}
## b) Testen Sie die Hypothese, dass das durchschnittliche Alter in den Populationen unterschiedlich ist, mit $\alpha = 0,05$.

```{r}
#| label: Loesung-J3b
# teste, ob Varianzhomogenität vorliegt
var.test(Alter ~ Population, data=df)$p.value

# liegt vor
t.test(Alter ~ Population, data=df, var.equal=TRUE)
```
Das Ergebnis ist signifikant, p ist kleiner als 0,05. Es liegt also ein Unterschied vor.
:::







## Lösung zur Aufgabe [-@sec-J04] {#sec-LJ04}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `vorher` und `nachher`.

```{r}
#| label: Loesung-J4a
# Daten übertragen
df <- data.frame(vorher = c(60.6, 12.0, 56.0, 75.2, 12.5, 29.7, 
                            57.2, 62.7, 28.7, 66.0, 25.2, 40.1),
                 nachher = c(47.5, 13.3, 33.0, 55.2, 21.9, 27.9, 
                             54.3, 13.9, 8.90, 46.1, 29.8, 36.2))
```
:::



::: {.callout-tip}
## b) Testen Sie, ob sich die Bronchialretention nach dem Rauchstopp verringert.

```{r}
#| label: Loesung-J4b
# Daten übertragen
t.test (df$vorher, df$nachher, alternative="greater", paired=TRUE, conf.level=0.95)
```
Das Ergebnis ist signifikant, p ist kleiner als 0,05. Es liegt also ein Unterschied vor, die Retention hat sich verringert.
:::





## Lösung zur Aufgabe [-@sec-J05] {#sec-LJ05}

::: {.callout-tip}
## Gibt es signifikante Unterschiede zwischen den Prozentsätzen der Studiereden, die am Vormittag und am Nachmittag bestanden haben? Kann man daraus schließen, dass der Stundenplan die Ursache für diese Unterschiede ist? 

```{r}
#| label: Loesung-J5a
# Daten übertragen
df <- data.frame(course = c(rep("bestanden", 55), rep("durchgefallen", 25),
                            rep("bestanden", 32), rep("durchgefallen", 58)),
                 time = c(rep("morgens", 80), rep("abends", 90))
                 
                 )

freq <- table(df)
prop.test(c(freq[["bestanden","morgens"]], freq[["bestanden","abends"]]), 
          c(sum(freq[,"morgens"]), sum(freq[,"abends"])), 
          alternative="two.sided", conf.level=0.95)                 
```
Das Ergebnis ist signifikant, p ist kleiner als 0,05. Es liegt also ein Unterschied zwischen morgens und abends vor.
:::





## Lösung zur Aufgabe [-@sec-J06] {#sec-LJ06}


```{r}
#| label: Loesung-J6setup
#| include: false
# lade Datensatz
load("data/pulse.RData")
```

```{r}
#| label: Loesung-J6setup2
#| eval: false
# lade Datensatz
load(url("https://www.produnis.de/R/data/pulse.RData"))
```


::: {.callout-tip}
## a) Testen Sie, ob der Ruhepuls weniger als 75 Schläge pro Minute beträgt.

```{r}
#| label: Loesung-J6a
t.test(pulse$pulse1, mu=75, alternative = "less")

```
Das Ergebnis ist signifikant.
:::


::: {.callout-tip}
## b) Welcher Stichprobenumfang ist erforderlich, um einen Anstieg des Ruhepulses um 2 Schläge pro Minute mit einem Signifikanzniveau von 0,05 und einer Power von 0,9 festzustellen? 

```{r}
#| label: Loesung-J6b
power.t.test(delta=2, sd=sd(pulse$pulse1), 
             sig.level=0.05, power=0.9)

```
Es werden 638 Probanden benötigt.
:::



::: {.callout-tip}
## c) Testen Sie, ob der Puls nach dem Laufen größer als 85 Schläge pro Minute ist.

```{r}
#| label: Loesung-J6c
t.test(pulse$pulse2, mu=85, alternative="greater")
```
Das Ergebnis ist nicht signifikant
:::



::: {.callout-tip}
## d) Eine Person hat eine leichte Tachykardie, wenn der Ruhepuls größer als 90 Schläge pro Minute ist. Prüfen Sie, ob der Prozentsatz der Personen mit leichter Tachykardie größer als 5\% ist.

```{r}
#| label: Loesung-J6d
#| warning: false
pulse$tachy <- "nein"
pulse$tachy[pulse$pulse1 > 90] <- "ja"

freq <- table(pulse$tachy)
prop.test(freq[["ja"]], sum(freq), alternative="greater", 
          p=0.05, conf.level=0.95)
```
Das Ergebnis ist nicht signifikant.
:::




::: {.callout-tip}
## e) Kann man mit 95\%iger Sicherheit schließen, dass Bewegung den Puls erhöht? Und bei einem Signifikanzniveau von $\alpha =0,01$? 

```{r}
#| label: Loesung-J6e
#| warning: false
# test ob pulse1 kleiner ist als pulse2
t.test(pulse$pulse1, pulse$pulse2, alternative="less", conf.level = 0.95)
t.test(pulse$pulse1, pulse$pulse2, alternative="less", conf.level = 0.99)
```
Das Ergebnis ist in beiden Fällen signifikant. Bewegung erhöht also den Puls.
:::



::: {.callout-tip}
## f) Gibt es einen Unterschied zwischen den durchschnittlichen Pulsschlägen nach dem Gehen und dem Laufen?

```{r}
#| label: Loesung-J6f
#| warning: false
# test ob pulse1 kleiner ist als pulse2
t.test(pulse2 ~ type, data=pulse, conf.level = 0.95)
```
Es gibt einen signifikanten Unterschied.
:::


::: {.callout-tip}
## g) Gibt es einen Unterschied zwischen den Mittelwerten des Ruhepulses von Männern und Frauen? Und nach dem Laufen? 

```{r}
#| label: Loesung-J6g
#| warning: false
# test ob pulse1 kleiner ist als pulse2
t.test(pulse1 ~ sex, data=pulse, conf.level = 0.95)
t.test(pulse2 ~ sex, data=pulse, conf.level = 0.95)

```
Für beide Pulse gibt es signifikante Unterschiede zwischen Männern und Frauen.
:::








## Lösung zur Aufgabe [-@sec-K01] {#sec-LK01}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Therapie` und `Aknereduktion`.

```{r}
#| label: Loesung-K1a
A <- c(48.6, 50.8, 49.4, 47.1, 50.1, 52.5, 49.8, 49, 50.6, 46.7)
B <- c(68, 71.9, 67, 71.5, 70.1, 69.9, 64.5, 68.9, 68, 67.8, 68.3, 68.9)
C <- c(67.5, 61.4, 62.5, 67.4, 64.2, 65.4, 62.5, 63.2, 63.9, 61.2, 64.8, 60.5, 62.3)

df <- data.frame(Therapie = c(rep("A", length(A)),
                              rep("B", length(B)),
                              rep("C", length(C))),
                 Aknereduktion = c(A,B,C)
)

```
:::

::: {.callout-tip}
## b) Plotten Sie die Aknereduktion für jede Therapie. Sind Unterschiede erkennbar?

```{r}
#| label: Loesung-K1b
#| layout-ncol: 2
# plot()
boxplot(Aknereduktion ~ Therapie, data=df)

# ggplot()
ggplot(df, aes(x=Therapie, y=Aknereduktion)) +
  geom_boxplot(aes(fill=Therapie))
```
Therapie A unterscheidet sich deutlich von B und C.
:::



::: {.callout-tip}
## c) Führen Sie eine ANOVA durch. Gibt es signifikante Unterschiede zwischen den Therapien?

```{r}
#| label: Loesung-K1c
fit <- aov(Aknereduktion ~ Therapie, data=df)
summary(fit)
```
Es gibt Unterschiede. Schauen wir genauer hin.
```{r}
#| label: Loesung-K1c2
pairwise.t.test(df$Aknereduktion, df$Therapie, p.adjust="bonferroni")
```
Alle Gruppen unterscheiden sich jeweils voneinander.
:::


::: {.callout-tip}
## d) Berechnen Sie die Konfidenzintervalle für die paarweisen Unterschiede zwischen den drei Behandlungen. Bei welchen Behandlungen gibt es signifikante Unterschiede?

```{r}
#| label: Loesung-K1d
ab <- t.test(A,B)
ac <- t.test(A,C)
cb <- t.test(C,B)

# Konfidenzintervalle
as.numeric(ab$conf.int)
as.numeric(ac$conf.int)
as.numeric(cb$conf.int)
```
Keines der Intervalle schließt die 0 ein. Alle Therapien unterscheiden sich jeweils voneinander.
:::


::: {.callout-tip}
## e) Plotten Sie diese Konfidenzintervalle.

```{r}
#| label: Loesung-K1e
# Als Datenframe für ggplot zusammenbauen
plotdf <- data.frame(unten = c(ab$conf.int[1], ac$conf.int[1], cb$conf.int[1]),
                 oben  = c(ab$conf.int[2], ac$conf.int[2], cb$conf.int[2]),
                 mitte = c(ab$estimate[1]-ab$estimate[2], 
                           ac$estimate[1]-ac$estimate[2], 
                           cb$estimate[1]-cb$estimate[2] ),
                 Therapie = c("A", "B", "C"))

# ggplot
ggplot(plotdf, aes(x=Therapie, color=Therapie)) +
  geom_point(aes(y=mitte)) +
  geom_segment(aes(xend=Therapie, y=unten, yend=oben))

```
Keines der Intervalle schließt die 0 ein. Alle Therapien unterscheiden sich jeweils voneinander.
:::




\newpage

## Lösung zur Aufgabe [-@sec-K02] {#sec-LK02}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Schule` und `Punkte`.

```{r}
#| label: Loesung-K2a
# Erstellen des tibbles mit tribble()
df <- tribble(
  ~A,   ~B,   ~C,   ~D,   ~E,
  5.5,  6.1,  4.9,  3.2,  6.7,
  5.2,  7.2,  5.5,  3.3,  5.8,
  5.9,  5.5,  6.1,  5.5,  5.4,
  7.1,  6.7,  6.1,  5.7,  5.5,
  6.2,  7.6,  6.2,  6.0,  4.9,
  5.9,  5.9,  6.4,  6.1,  6.2,
  5.3,  8.1,  6.9,  4.7,  6.1,
  6.2,  8.3,  4.5,  5.1,  7.0
) %>% # und pivot_longer
  pivot_longer(A:E, names_to="Schule", values_to="Punkte")
```
:::

::: {.callout-tip}
## b) Plotten Sie die durchschnittlich erreichten Punkte pro Schule. Sind Unterschiede erkennbar?

```{r}
#| label: Loesung-K2b
#| layout-ncol: 2
# plot()
boxplot(Punkte ~ Schule, data=df)

# ggplot()
ggplot(df, aes(x=Schule, fill=Schule, y=Punkte)) +
  geom_boxplot() +
  # whiskers
  stat_boxplot(geom="errorbar")
```
:::

::: {.callout-tip}
## c) Führen Sie eine ANOVA durch. Gibt es signifikante Unterschiede zwischen den Schulen?

```{r}
#| label: Loesung-K2c
fit <- aov(Punkte ~ Schule, data=df)
summary(fit)
```
:::

::: {.callout-tip}
## d) In welcher Schule sind die sportlichen Leistungen am besten?

```{r}
#| label: Loesung-K2d
pairwise.t.test(df$Punkte, df$Schule, p.adjust="bonferroni")

```
Es gibt einen Unterschied zwischen Schule B und Schule D. In Schule B sind die Leistungen besser als in Schule D. Die Leistungen in B sind aber nicht "die besten", da kein Unterschied zu den anderen Schulen gezeigt werden kann. Die Mittelwerte sind in B aber höher.
:::


\newpage


## Lösung zur Aufgabe [-@sec-K03] {#sec-LK03}

::: {.callout-tip}
## Gibt es laut den Daten signifikante Unterschiede zwischen den vier Gruppen?

```{r}
#| label: Loesung-K3a
# Erstellen des tibbles mit tribble()
df <- tribble(
  ~Kontrolle,  ~AnginaP,  ~Arrhytmia,  ~Herzinfarkt,
          83,  81,  75,  61,
          61,  65,  68,  75,
          80,  77,  80,  78,
          63,  87,  80,  80,
          67,  95,  74,  68,
          89,  89,  78,  65,
          71,  103, 69,  68,
          73,  89,  72,  69,
          70,  78,  76,  70,
          66,  83,  75,  79,
          57,  91,  69,  61
) %>% # und pivot_longer
  pivot_longer(1:4, names_to="Gruppe", values_to="Puls")

# ANOVa
fit <- aov(Puls ~ Gruppe, data=df)
summary(fit)

# paarweise
pairwise.t.test(df$Puls, df$Gruppe, p.adjust="bonferroni")
```
Patienten mit Angina Pectoris unterscheiden sich von allen anderen Patientengruppen.

:::






## Lösung zur Aufgabe [-@sec-K04] {#sec-LK04}

::: {.callout-tip}
## Gibt es laut den Daten signifikante Unterschiede zwischen den drei Gruppen?

```{r}
#| label: Loesung-K4a
# Erstellen des tibbles mit tribble()
df <- tribble(
  ~Low, ~Medium, ~High,
  36,    43,     45,
  33,    38,     39,
  35,    41,     33,
  39,    34,     39,
  41,    28,     33,
  41,    44,     26,
  44,    30,     39,
  45,    31,     29
) %>% # und pivot_longer
  pivot_longer(1:3, names_to="Konzentration", values_to="Atemfrequenz")

# ANOVa
fit <- aov(Atemfrequenz ~ Konzentration, data=df)
summary(fit)

# paarweise
pairwise.t.test(df$Atemfrequenz, df$Konzentration, p.adjust="bonferroni")
```

Es kann kein signifikanter Unterschied festgestellt werden.
:::













## Lösung zur Aufgabe [-@sec-AL01] {#sec-LL01}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Geschwuer` und `Blutgruppe`.

```{r}
#| label: Loesung-L1a
df <- data.frame(Geschwuer=c(rep("Geschwür", 1655),
                             rep("gesund", 10000)), 
                 Blutgruppe=c(rep("0", 911), rep("A", 579),
                              rep("B", 124), rep("AB", 41),
                              rep("0", 4578), rep("A", 4219),
                              rep("B", 890), rep("AB", 313))
)

```
:::


::: {.callout-tip}
## b) Führen Sie einen Chiquadrattest auf die Hypothese durch, dass die Geschwüre von der Blutgruppe abhängig sind.

```{r}
#| label: Loesung-L1b
chisq.test(df$Geschwuer, df$Blutgruppe)   
```
Es gibt unterschiede, p ist kleiner als 0,05.
:::

::: {.callout-tip}
## c)  Gibt es in Anbetracht der Ergebnisse des Vergleichs einen Zusammenhang zwischen dem Magengeschwür und der Blutgruppe? Können wir behaupten, dass der Anteil der Ulkuspatienten je nach Blutgruppe unterschiedlich ist?

```{r}
#| label: Loesung-L1c
reporttools::pairwise.fisher.test(df$Geschwuer, df$Blutgruppe, 
                                  p.adjust.method = "bonferroni")
```
Blutgruppe 0 unterscheidet sich von allen anderen. 
:::






## Lösung zur Aufgabe [-@sec-AL02] {#sec-LL02}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Region` und `Blutgruppe`.

```{r}
#| label: Loesung-L2a
df <- data.frame(
          Blutgruppe=c(rep("A", 185), rep("B", 55),
                      rep("0", 223), rep("AB", 15)), 
          Region=c(rep("Eskdale", 33), rep("Annadale", 54), rep("Nithsdale", 98), 
                   rep("Eskdale", 6), rep("Annadale", 14), rep("Nithsdale", 35),
                   rep("Eskdale", 56), rep("Annadale", 52), rep("Nithsdale", 115),
                   rep("Eskdale", 5), rep("Annadale", 5), rep("Nithsdale", 5))
)
```
:::


::: {.callout-tip}
## b) Führen Sie einen Chiquadrattest auf die Hypothese durch, dass die Blutgruppe von der Region abhängig sind.

```{r}
#| label: Loesung-L2b
chisq.test(df$Blutgruppe, df$Region)   
```
Der Test ist nicht signifikant.
:::



::: {.callout-tip}
## c)  Gibt es in Anbetracht der Ergebnisse einen Zusammenhang zwischen der Blutgruppe und der Region? Können wir behaupten, dass die Region keinen Einfluss auf die Blutgruppe hat?

```{r}
#| label: Loesung-L2c
reporttools::pairwise.fisher.test(df$Blutgruppe, df$Region, 
                                  p.adjust.method = "bonferroni")
```
Es sind keine Unterschiede zu finden.
:::





## Lösung zur Aufgabe [-@sec-AL03] {#sec-LL03}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `Rauchen` und `Geschlecht`.

```{r}
#| label: Loesung-L3a
df <- data.frame(
          Geschlecht=c(rep("m", 9), rep("w", 17)), 
          Rauchen=c(rep("ja", 2), rep("nein", 7),
                    rep("ja", 6), rep("nein", 11))
)
```
:::


::: {.callout-tip}
## b) Führen Sie einen Chi-Quadrat-Test durch, um festzustellen, ob das Rauchen mit dem Geschlecht zusammenhängt.

```{r}
#| label: Loesung-L3b
chisq.test(df$Rauchen, df$Geschlecht) 

# kleines sample, besser exakten Fisher Test
fisher.test(df$Rauchen, df$Geschlecht)
```
:::



::: {.callout-tip}
## c) Ist die Verteilung der Raucher bei beiden Geschlechtern gleich?

```{r}
#| label: Loesung-L3c
# kleines sample, besser exakten Fisher Test
fisher.test(df$Rauchen, df$Geschlecht)
```
Beide Tests sind nicht signifikant, es besteht kein Unterschied in den Gruppen.
:::








## Lösung zur Aufgabe [-@sec-AL04] {#sec-LL04}

::: {.callout-tip}
## a) Übertragen Sie die Daten in ein Datenframe mit den Variablen `drug1` und `drug2`.

```{r}
#| label: Loesung-L4a
df <- data.frame(
      drug1 = c( "Ja", "Ja", "Ja", "Ja", "Ja", "Nein", "Ja", "Nein", 
                 "Ja", "Ja", "Ja", "Nein", "Ja", "Nein", "Ja", "Ja", 
                 "Ja", "Nein", "Ja", "Ja"),
      drug2 = c("Nein", "Nein", "Ja", "Nein", "Ja", "Ja", "Nein", "Nein", 
                "Nein", "Nein", "Ja", "Nein", "Ja", "Nein", "Nein", "Ja", 
                "Nein", "Ja", "Nein", "Nein")
)
```
:::


::: {.callout-tip}
## b) Führen Sie einen McNemar-Test durch, um festzustellen, ob die Linderung mit dem Medikament zusammenhängt.

```{r}
#| label: Loesung-L4b
mcnemar.test(df$drug1, df$drug2)
```
Das Ergebnis ist signifikant. Es gibt einen Unterschied.
:::


::: {.callout-tip}
## c) Können wir nach dem Ergebnis des Tests behaupten, dass die Linderung der Migräne vom Medikament abhängt? Wenn ja, welches Medikament bewirkt eine signifikant höhere Linderung?

```{r}
#| label: Loesung-L4c
prop.table(table(df$drug1))
prop.table(table(df$drug2))
```
Medikament `drug1` wirkt besser.
:::



## Lösung zur Aufgabe [-@sec-AL05] {#sec-LL05}

::: {.callout-tip}
##  Ist ein komatöser Zustand bei der Ankunft im Krankenhaus ein Risikofaktor zu versterben?

```{r}
#| label: Loesung-L5a
df <- data.frame(
      Ergebnis = c(rep("überlebt", 521), rep("verstorben", 207)),
      Komatös = c(rep("nein", 484), rep("ja", 37),
                  rep("nein", 118), rep("ja", 89)
  )
)

chisq.test(df$Ergebnis, df$Komatös)  
```
Ja, es gibt einen Unterschied zwischen komatösen und nicht-komatösen Patienten.
:::








## Lösung zur Aufgabe [-@sec-AL06] {#sec-LL06}

::: {.callout-tip}
##  Ist die Wirksamkeit der beiden Behandlungen die gleiche?

```{r}
#| label: Loesung-L6a
df <- data.frame(
      Therapie = c(rep("A", 32), rep("B", 28)),
      Wirkung = c(rep("Sehr gut", 10), rep("gut", 14), rep("schlecht", 8),
                  rep("Sehr gut", 12), rep("gut", 10), rep("schlecht", 6)
  )
)

chisq.test(df$Wirkung, df$Therapie)
```
Es kann kein signifikanter Unterschied gezeigt werden.
:::



## Lösung zur Aufgabe [-@sec-AL07] {#sec-LL07}

::: {.callout-tip}
##  Können wir dann behaupten, dass Frauen in diesem Fach erfolgreicher sind als Männer?

```{r}
#| label: Loesung-L7a
df <- data.frame(
      Geschlecht = c(rep("m", 10), rep("w", 10)),
      bestanden = c(rep("ja", 2), rep("nein", 8),
                    rep("ja", 4), rep("nein", 6)
  )
)

table(df)
chisq.test(df$bestanden, df$Geschlecht)
```
Es kann kein signifikanter Unterschied gezeigt werden.
:::



## Lösung zur Aufgabe [-@sec-AL08] {#sec-LL08}

::: {.callout-tip}
##  Können wir bestätigen, dass es unterschiedliche Meinungen über Hans und Erna gibt?

```{r}
#| label: Loesung-L8a
df <- data.frame(
      Erna = c(rep("ja", 85), rep("nein", 65)),
      Hans = c(rep("ja", 37), rep("nein", 48),
               rep("ja", 44), rep("nein", 21)
  )
)

table(df)
chisq.test(df$Erna, df$Hans)
```
Es gibt einen Signifikanten Unterschied zwischen den Dozenten.

```{r}
#| label: Loesung-L8a2
prop.table(table(df$Erna))
prop.table(table(df$Hans))

```
Die Studierenden mögen Erna ein bisschen mehr als Hans.
:::




















\newpage


# Literatur {-}

::: {#refs}
:::

\vfill

# Credits {-}

Prof. Dr. Jörg große Schlarmann

Hochschule Niederrhein, Krefeld

[joerg.grosseschlarmann@hs-niederrhein.de](mailto:joerg.grosseschlarmann@hs-niederrhein.de)

<https://www.produnis.de/R>

<https://github.com/produnis/angewandte_uebungen_in_R>